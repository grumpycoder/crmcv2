!function(){angular.module("app",["app.directives","ui.bootstrap","ui.slider","smart-table"])}();
!function(){function n(n){var e=this;e.$onInit=function(){console.log("censor edit init"),e.resolve&&(e.id=e.resolve.id),e.id&&n.get("api/censor/"+e.id).then(function(n){e.censor=n.data}).catch(function(n){console.log("err",n.message)})},e.cancel=function(){e.dismiss()},e.save=function(){return console.log("save censor",e.censor),n.post("api/censor",e.censor).then(function(n){angular.extend(e.censor,n.data),e.modalInstance.close(e.censor)}).catch(function(n){console.error("something went wrong",n.message)})}}var e=angular.module("app");e.component("censorEdit",{bindings:{item:"<",resolve:"<",close:"&",dismiss:"&",modalInstance:"<"},templateUrl:"app/censors/censor-edit.component.html",controller:["$http",n]})}();
!function(){function n(n,e){var o,t=this,s=10;t.searchModel={page:1,pageSize:s},t.$onInit=function(){console.log("censor list init")},t.create=function(){e.open({component:"censorEdit",bindings:{modalInstance:"<"},resolve:{},size:"md"}).result.then(function(n){t.censors.unshift(n)},function(n){})},t.edit=function(n){e.open({component:"censorEdit",bindings:{modalInstance:"<"},resolve:{id:n.id},size:"md"}).result.then(function(e){angular.extend(n,e)},function(n){})},t.delete=function(e){n.delete("api/censor/"+e.id).then(function(n){var o=t.censors.indexOf(e);t.censors.splice(o,1)})},t.search=function(e){o=e,n.get("api/censor",{params:t.searchModel}).then(function(n){t.censors=n.data.results,t.searchModel=n.data,delete t.searchModel.results})},t.paged=function(){t.search(o)}}var e=angular.module("app");e.component("censorList",{templateUrl:"app/censors/censor-list.component.html",controller:["$http","$uibModal",n]})}();
!function(){function n(n){var o=this,t=$.connection.nameNotificationHub;o.$onInit=function(){console.log("configuration setting init"),$.connection.hub.start().done(function(){console.log("hub connection started")}),n.get("api/configuration").then(function(n){o.configuration=n.data})},o.cancel=function(){o.dismiss()},o.save=function(){return n.post("api/configuration",o.configuration).then(function(n){angular.extend(o.configuration,n.data)}).catch(function(n){console.error("something went wrong",n.message)}).finally(function(){t.server.configurationChange(o.configuration).then(function(n){console.log("configuration sent to hub")})})}}var o=angular.module("app");o.component("configurationSetting",{templateUrl:"app/configuration/configuration-setting.component.html",controller:["$http",n]})}();
!function(){angular.module("app.directives",[])}();
!function(){var e=angular.module("app.directives");e.directive("stSubmitSearch",["stConfig","$timeout","$parse",function(e,t,r){return{require:"^stTable",link:function(e,t,r,n){return t.bind("click",function(){var e=n;e.pipe()})}}}]),e.directive("clearKey",function(){return{restrict:"EA",require:"ngModel",link:function(e,t,r,n){t.on("keydown",function(t){27===t.which&&(n.$setViewValue(null),n.$render(),e.$apply())})}}}),e.directive("stResetSearch",function(){return{restrict:"EA",require:["^stTable","^ngModel"],link:function(e,t,r,n){return t.bind("click",function(){var t=n[1],r=n[0];return e.$apply(function(){angular.forEach(t.$viewValue,function(e,r){"page"===r.toLowerCase()&&(t.$viewValue[r]=1),Array.isArray(e)||_.includes(r.toLowerCase(),"page")||(t.$viewValue[r]=null)});var e=r.tableState();return e.search.predicateObject={},e.pagination.start=0,r.pipe()})})}}}),e.directive("stClearKey",function(){return{restrict:"EA",require:["^stTable","^ngModel"],link:function(e,t,r,n){t.on("keydown",function(r){var i=n[1],a=n[0];return 13===r.which?a.pipe():27===r.which?void 0!==t.context.attributes["st-search"]?e.$apply(function(){var e=t.context.attributes["st-search"].value,r=a.tableState();return r.search.predicateObject[e]="",a.pipe()}):e.$apply(function(){i.$setViewValue(null),i.$render()}):void 0})}}})}();
!function(){angular.module("app").filter("percentage",["$filter",function(n){return function(e,r){return n("number")(100*e,r)+"%"}}])}();
!function(){function e(e){var n=this;n.$onInit=function(){console.log("user edit init",n),n.resolve&&(n.user=n.resolve.user)},n.cancel=function(){n.dismiss()},n.save=function(){return console.log("save user",n.user),e.post("api/user/update",n.user).then(function(e){angular.extend(n.user,e.data),n.modalInstance.close(n.user)}).catch(function(e){console.error("something went wrong",e.message)})}}var n=angular.module("app");n.component("userEdit",{bindings:{item:"<",resolve:"<",close:"&",dismiss:"&",modalInstance:"<"},templateUrl:"app/users/user-edit.component.html",controller:["$http",e]})}();
!function(){function n(n,e){var t=this;t.$onInit=function(){console.log("user list init"),n.get("api/user").then(function(n){t.users=n.data,console.log("users",t.users)})},t.create=function(){e.open({component:"userEdit",bindings:{modalInstance:"<"},resolve:{},size:"md"}).result.then(function(n){t.users.unshift(n)},function(n){})},t.edit=function(n){console.log("user",n),e.open({component:"userEdit",bindings:{modalInstance:"<"},resolve:{user:n},size:"md"}).result.then(function(e){angular.extend(n,e)},function(n){})},t.delete=function(e){n.delete("api/user/"+e.id).then(function(n){var o=t.censors.indexOf(e);t.censors.splice(o,1)})}}var e=angular.module("app");e.component("userList",{templateUrl:"app/users/user-list.component.html",controller:["$http","$uibModal",n]})}();
!function(){function i(i){var t=this;t.$onInit=function(){console.log("visitor edit init"),t.title="New Visitor",t.resolve&&(t.id=t.resolve.id),t.id&&i.get("api/visitor/"+t.id).then(function(i){t.visitor=i.data,t.title=t.visitor.firstname+" "+t.visitor.lastname}).catch(function(i){console.log("err",i.message)})},t.cancel=function(){t.dismiss()},t.save=function(){return console.log("save visitor",t.visitor),i.post("api/visitor",t.visitor).then(function(i){angular.extend(t.visitor,i.data),t.modalInstance.close(t.visitor)}).catch(function(i){console.error("something went wrong",i.message)})}}var t=angular.module("app");t.component("visitorEdit",{bindings:{item:"<",resolve:"<",close:"&",dismiss:"&",modalInstance:"<"},templateUrl:"app/visitors/visitor-edit.component.html",controller:["$http",i]})}();
!function(){function e(e,t){var i,n=this,o=10;n.searchModel={page:1,pageSize:o},n.$onInit=function(){console.log("init visitor list"),n.title="Visitors"},n.create=function(){t.open({component:"visitorEdit",bindings:{modalInstance:"<"},resolve:{},size:"md"}).result.then(function(e){n.visitors.unshift(e)},function(e){})},n.edit=function(e){t.open({component:"visitorEdit",bindings:{modalInstance:"<"},resolve:{id:e.id},size:"md"}).result.then(function(t){angular.extend(e,t)},function(e){})},n.delete=function(t){e.delete("api/visitor/"+t.id).then(function(e){var i=n.visitors.indexOf(t);n.visitors.splice(i,1)})},n.search=function(t){i=t,n.searchModel.fuzzyMatchRange=n.fuzzyMatchRange,n.searchModel.daysOld=n.days,"undefined"!=typeof t.sort.predicate&&(n.searchModel.orderBy=t.sort.predicate,n.searchModel.orderDirection=t.sort.reverse?"desc":"asc"),e.get("api/visitor",{params:n.searchModel}).then(function(e){n.visitors=e.data.results,n.searchModel=e.data,delete n.searchModel.results})},n.paged=function(){n.search(i)}}var t=angular.module("app");t.component("visitorList",{templateUrl:"app/visitors/visitor-list.component.html",controller:["$http","$uibModal",e]})}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJjZW5zb3JzL2NlbnNvci1lZGl0LmNvbXBvbmVudC5qcyIsImNlbnNvcnMvY2Vuc29yLWxpc3QuY29tcG9uZW50LmpzIiwiY29uZmlndXJhdGlvbi9jb25maWd1cmF0aW9uLXNldHRpbmcuY29tcG9uZW50LmpzIiwiZGlyZWN0aXZlcy9kaXJlY3RpdmVzLm1vZHVsZXMuanMiLCJkaXJlY3RpdmVzL3N0VGFibGUuZGlyZWN0aXZlLmpzIiwiZmlsdGVycy9maWx0ZXJzLmpzIiwidXNlcnMvdXNlci1lZGl0LmNvbXBvbmVudC5qcyIsInVzZXJzL3VzZXItbGlzdC5jb21wb25lbnQuanMiLCJ2aXNpdG9ycy92aXNpdG9yLWVkaXQuY29tcG9uZW50LmpzIiwidmlzaXRvcnMvdmlzaXRvci1saXN0LmNvbXBvbmVudC5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29udHJvbGxlciIsIiRodHRwIiwiJGN0cmwiLCJ0aGlzIiwiJG9uSW5pdCIsImNvbnNvbGUiLCJsb2ciLCJyZXNvbHZlIiwiaWQiLCJnZXQiLCJ0aGVuIiwiciIsImNlbnNvciIsImRhdGEiLCJjYXRjaCIsImVyciIsIm1lc3NhZ2UiLCJjYW5jZWwiLCJkaXNtaXNzIiwic2F2ZSIsInBvc3QiLCJleHRlbmQiLCJtb2RhbEluc3RhbmNlIiwiY2xvc2UiLCJlcnJvciIsImNvbXBvbmVudCIsImJpbmRpbmdzIiwiaXRlbSIsInRlbXBsYXRlVXJsIiwiJG1vZGFsIiwidGFibGVTdGF0ZVJlZiIsInBhZ2VTaXplRGVmYXVsdCIsInNlYXJjaE1vZGVsIiwicGFnZSIsInBhZ2VTaXplIiwiY3JlYXRlIiwib3BlbiIsInNpemUiLCJyZXN1bHQiLCJjZW5zb3JzIiwidW5zaGlmdCIsInJlYXNvbiIsImVkaXQiLCJjIiwiZGVsZXRlIiwiaWR4IiwiaW5kZXhPZiIsInNwbGljZSIsInNlYXJjaCIsInRhYmxlU3RhdGUiLCJwYXJhbXMiLCJyZXN1bHRzIiwicGFnZWQiLCJodWIiLCIkIiwiY29ubmVjdGlvbiIsIm5hbWVOb3RpZmljYXRpb25IdWIiLCJzdGFydCIsImRvbmUiLCJjb25maWd1cmF0aW9uIiwiZmluYWxseSIsInNlcnZlciIsImNvbmZpZ3VyYXRpb25DaGFuZ2UiLCJkaXJlY3RpdmUiLCJzdENvbmZpZyIsIiR0aW1lb3V0IiwiJHBhcnNlIiwicmVxdWlyZSIsImxpbmsiLCJzY29wZSIsImVsZW1lbnQiLCJhdHRyIiwiY3RybCIsImJpbmQiLCJ0YWJsZUN0cmwiLCJwaXBlIiwicmVzdHJpY3QiLCJlbCIsImF0dHJzIiwib24iLCJldmVudCIsIndoaWNoIiwiJHNldFZpZXdWYWx1ZSIsIiRyZW5kZXIiLCIkYXBwbHkiLCJjdHJscyIsIm1vZGVsIiwiZm9yRWFjaCIsIiR2aWV3VmFsdWUiLCJ2YWx1ZSIsImtleSIsInRvTG93ZXJDYXNlIiwiQXJyYXkiLCJpc0FycmF5IiwiXyIsImluY2x1ZGVzIiwicHJlZGljYXRlT2JqZWN0IiwicGFnaW5hdGlvbiIsIm5nTW9kZWwiLCJ1bmRlZmluZWQiLCJjb250ZXh0IiwiYXR0cmlidXRlcyIsImZpZWxkTmFtZSIsImZpbHRlciIsIiRmaWx0ZXIiLCJpbnB1dCIsImRlY2ltYWxzIiwidXNlciIsInVzZXJzIiwidSIsInRpdGxlIiwidmlzaXRvciIsImZpcnN0bmFtZSIsImxhc3RuYW1lIiwidmlzaXRvcnMiLCJ2IiwiZnV6enlNYXRjaFJhbmdlIiwiZGF5c09sZCIsImRheXMiLCJzb3J0Iiwib3JkZXJCeSIsInByZWRpY2F0ZSIsIm9yZGVyRGlyZWN0aW9uIiwicmV2ZXJzZSJdLCJtYXBwaW5ncyI6IkNBQ0EsV0FDaUJBLFFBQVFDLE9BQU8sT0FBUSxpQkFBa0IsZUFBZ0IsWUFBYTtDQ0R2RixXQUdJLFFBQVNDLEdBQVdDLEdBQ2hCLEdBQUlDLEdBQVFDLElBRVpELEdBQU1FLFFBQVUsV0FDWkMsUUFBUUMsSUFBSSxvQkFFUkosRUFBTUssVUFDTkwsRUFBTU0sR0FBS04sRUFBTUssUUFBUUMsSUFFekJOLEVBQU1NLElBQ05Q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LEVBQVdzRSxLQUFLSSxRQUFVLE9BQVMsT0FHMUUxSCxFQUFNUSxJQUFJLGVBQWlCeUMsT0FBUWhELEVBQU04QixjQUFldEIsS0FBSyxTQUFVQyxHQUNuRVQsRUFBTWdILFNBQVd2RyxFQUFFRSxLQUFLc0MsUUFDeEJqRCxFQUFNOEIsWUFBY3JCLEVBQUVFLFdBQ2ZYLEdBQU04QixZQUFZbUIsV0FJakNqRCxFQUFNa0QsTUFBUSxXQUNWbEQsRUFBTThDLE9BQU9sQixJQXpFckIsR0FBSS9CLEdBQVNELFFBQVFDLE9BQU8sTUE4RTVCQSxHQUFPMEIsVUFBVSxlQUVURyxZQUFhLDJDQUNiNUIsWUFBYSxRQUFTLFlBQWFBIiwiZmlsZSI6ImFwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvL2FwcC5tb2R1bGUuanNcclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbJ2FwcC5kaXJlY3RpdmVzJywgJ3VpLmJvb3RzdHJhcCcsICd1aS5zbGlkZXInLCAnc21hcnQtdGFibGUnXSk7XHJcbiAgICB9XHJcbikoKTsiLCIvL2NlbnNvci1lZGl0LmNvbXBvbmVudC5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnKTtcclxuXHJcbiAgICBmdW5jdGlvbiBjb250cm9sbGVyKCRodHRwKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ2NlbnNvciBlZGl0IGluaXQnKTtcclxuXHJcbiAgICAgICAgICAgIGlmICgkY3RybC5yZXNvbHZlKSB7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5pZCA9ICRjdHJsLnJlc29sdmUuaWQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgaWYgKCRjdHJsLmlkKSB7XHJcbiAgICAgICAgICAgICAgICAkaHR0cC5nZXQoJ2FwaS9jZW5zb3IvJyArICRjdHJsLmlkKS50aGVuKGZ1bmN0aW9uIChyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgJGN0cmwuY2Vuc29yID0gci5kYXRhO1xyXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnInLCBlcnIubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJGN0cmwuZGlzbWlzcygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuc2F2ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3NhdmUgY2Vuc29yJywgJGN0cmwuY2Vuc29yKTtcclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJ2FwaS9jZW5zb3InLCAkY3RybC5jZW5zb3IpLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKCRjdHJsLmNlbnNvciwgci5kYXRhKTtcclxuICAgICAgICAgICAgICAgICRjdHJsLm1vZGFsSW5zdGFuY2UuY2xvc2UoJGN0cmwuY2Vuc29yKTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignc29tZXRoaW5nIHdlbnQgd3JvbmcnLCBlcnIubWVzc2FnZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW9kdWxlLmNvbXBvbmVudCgnY2Vuc29yRWRpdCcsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiaW5kaW5nczoge1xyXG4gICAgICAgICAgICAgICAgaXRlbTogJzwnLFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZTogJzwnLFxyXG4gICAgICAgICAgICAgICAgY2xvc2U6ICcmJyxcclxuICAgICAgICAgICAgICAgIGRpc21pc3M6ICcmJyxcclxuICAgICAgICAgICAgICAgIG1vZGFsSW5zdGFuY2U6ICc8J1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9jZW5zb3JzL2NlbnNvci1lZGl0LmNvbXBvbmVudC5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogWyckaHR0cCcsIGNvbnRyb2xsZXJdXHJcbiAgICAgICAgfSk7XHJcbn1cclxuKSgpOyIsIi8vY2Vuc29yLWxpc3QuY29tcG9uZW50LmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoJGh0dHAsICRtb2RhbCkge1xyXG4gICAgICAgIHZhciAkY3RybCA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHBhZ2VTaXplRGVmYXVsdCA9IDEwO1xyXG4gICAgICAgIHZhciB0YWJsZVN0YXRlUmVmO1xyXG5cclxuICAgICAgICAkY3RybC5zZWFyY2hNb2RlbCA9IHtcclxuICAgICAgICAgICAgcGFnZTogMSxcclxuICAgICAgICAgICAgcGFnZVNpemU6IHBhZ2VTaXplRGVmYXVsdFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRjdHJsLiRvbkluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjZW5zb3IgbGlzdCBpbml0Jyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5jcmVhdGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRtb2RhbC5vcGVuKHtcclxuICAgICAgICAgICAgICAgIGNvbXBvbmVudDogJ2NlbnNvckVkaXQnLFxyXG4gICAgICAgICAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgICAgICAgICBtb2RhbEluc3RhbmNlOiBcIjxcIlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBzaXplOiAnbWQnXHJcbiAgICAgICAgICAgIH0pLnJlc3VsdC50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICRjdHJsLmNlbnNvcnMudW5zaGlmdChyZXN1bHQpO1xyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuZWRpdCA9IGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgICAgICRtb2RhbC5vcGVuKHtcclxuICAgICAgICAgICAgICAgIGNvbXBvbmVudDogJ2NlbnNvckVkaXQnLFxyXG4gICAgICAgICAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgICAgICAgICBtb2RhbEluc3RhbmNlOiBcIjxcIlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBpZDogYy5pZFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHNpemU6ICdtZCdcclxuICAgICAgICAgICAgfSkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgYW5ndWxhci5leHRlbmQoYywgcmVzdWx0KTtcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmRlbGV0ZSA9IGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgICAgICRodHRwLmRlbGV0ZSgnYXBpL2NlbnNvci8nICsgYy5pZCkudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGlkeCA9ICRjdHJsLmNlbnNvcnMuaW5kZXhPZihjKTtcclxuICAgICAgICAgICAgICAgICRjdHJsLmNlbnNvcnMuc3BsaWNlKGlkeCwgMSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuc2VhcmNoID0gZnVuY3Rpb24gKHRhYmxlU3RhdGUpIHtcclxuICAgICAgICAgICAgdGFibGVTdGF0ZVJlZiA9IHRhYmxlU3RhdGU7XHJcbiAgICAgICAgICAgICRodHRwLmdldCgnYXBpL2NlbnNvcicsIHsgcGFyYW1zOiAkY3RybC5zZWFyY2hNb2RlbCB9KS50aGVuKGZ1bmN0aW9uIChyKSB7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5jZW5zb3JzID0gci5kYXRhLnJlc3VsdHM7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5zZWFyY2hNb2RlbCA9IHIuZGF0YTtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZSAkY3RybC5zZWFyY2hNb2RlbC5yZXN1bHRzO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLnBhZ2VkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkY3RybC5zZWFyY2godGFibGVTdGF0ZVJlZik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ2NlbnNvckxpc3QnLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvY2Vuc29ycy9jZW5zb3ItbGlzdC5jb21wb25lbnQuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJGh0dHAnLCAnJHVpYk1vZGFsJywgY29udHJvbGxlcl1cclxuICAgICAgICB9KTtcclxufVxyXG4pKCk7IiwiLy9jb25maWd1cmF0aW9uLXNldHRpbmcuY29tcG9uZW50LmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoJGh0dHApIHtcclxuICAgICAgICB2YXIgJGN0cmwgPSB0aGlzO1xyXG4gICAgICAgIHZhciBodWIgPSAkLmNvbm5lY3Rpb24ubmFtZU5vdGlmaWNhdGlvbkh1YjtcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ2NvbmZpZ3VyYXRpb24gc2V0dGluZyBpbml0Jyk7XHJcbiAgICAgICAgICAgICQuY29ubmVjdGlvbi5odWIuc3RhcnQoKS5kb25lKGZ1bmN0aW9uKCl7IGNvbnNvbGUubG9nKCdodWIgY29ubmVjdGlvbiBzdGFydGVkJyk7IH0pO1xyXG4gICAgICAgICAgICAkaHR0cC5nZXQoJ2FwaS9jb25maWd1cmF0aW9uJykudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuY29uZmlndXJhdGlvbiA9IHIuZGF0YTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRjdHJsLmRpc21pc3MoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLnNhdmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCdhcGkvY29uZmlndXJhdGlvbicsICRjdHJsLmNvbmZpZ3VyYXRpb24pLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKCRjdHJsLmNvbmZpZ3VyYXRpb24sIHIuZGF0YSk7XHJcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ3NvbWV0aGluZyB3ZW50IHdyb25nJywgZXJyLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICB9KS5maW5hbGx5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIGh1Yi5zZXJ2ZXIuY29uZmlndXJhdGlvbkNoYW5nZSgkY3RybC5jb25maWd1cmF0aW9uKS50aGVuKGZ1bmN0aW9uIChyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2NvbmZpZ3VyYXRpb24gc2VudCB0byBodWInKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcblxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBtb2R1bGUuY29tcG9uZW50KCdjb25maWd1cmF0aW9uU2V0dGluZycsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9jb25maWd1cmF0aW9uL2NvbmZpZ3VyYXRpb24tc2V0dGluZy5jb21wb25lbnQuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJGh0dHAnLCBjb250cm9sbGVyXVxyXG4gICAgICAgIH0pO1xyXG59XHJcbikoKTsiLCIvL2RpcmVjdGl2ZXMubW9kdWxlcy5qc1xyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwLmRpcmVjdGl2ZXMnLCBbXSk7IFxyXG59KSgpOyIsIi8vc3RUYWJsZS5kaXJlY3RpdmUuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcC5kaXJlY3RpdmVzJyk7XHJcblxyXG4gICAgbW9kdWxlLmRpcmVjdGl2ZSgnc3RTdWJtaXRTZWFyY2gnLCBbJ3N0Q29uZmlnJywgJyR0aW1lb3V0JywgJyRwYXJzZScsIGZ1bmN0aW9uIChzdENvbmZpZywgJHRpbWVvdXQsICRwYXJzZSkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJlcXVpcmU6ICdec3RUYWJsZScsXHJcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQuYmluZCgnY2xpY2snLFxyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhYmxlQ3RybCA9IGN0cmw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5waXBlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH1dKTtcclxuXHJcbiAgICBtb2R1bGUuZGlyZWN0aXZlKFwiY2xlYXJLZXlcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRUEnLFxyXG4gICAgICAgICAgICByZXF1aXJlOiAnbmdNb2RlbCcsXHJcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWwsIGF0dHJzLCBjdHJsKSB7XHJcbiAgICAgICAgICAgICAgICBlbC5vbigna2V5ZG93bicsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChldmVudC53aGljaCAhPT0gMjcpIHsgcmV0dXJuOyB9IC8vIGNoZWNrIGtleSBob3cgeW91IHdhbnRcclxuICAgICAgICAgICAgICAgICAgICBjdHJsLiRzZXRWaWV3VmFsdWUobnVsbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3RybC4kcmVuZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9KTtcclxuXHJcblxyXG4gICAgbW9kdWxlLmRpcmVjdGl2ZShcInN0UmVzZXRTZWFyY2hcIixcclxuICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN0cmljdDogJ0VBJyxcclxuICAgICAgICAgICAgICAgICAgICByZXF1aXJlOiBbJ15zdFRhYmxlJywgJ15uZ01vZGVsJ10sXHJcbiAgICAgICAgICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRycywgY3RybHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQuYmluZCgnY2xpY2snLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtb2RlbCA9IGN0cmxzWzFdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdHJsID0gY3RybHNbMF07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2gobW9kZWwuJHZpZXdWYWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICh2YWx1ZSwga2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGtleS50b0xvd2VyQ2FzZSgpID09PSAncGFnZScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWwuJHZpZXdWYWx1ZVtrZXldID0gMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpIHx8IF8uaW5jbHVkZXMoa2V5LnRvTG93ZXJDYXNlKCksICdwYWdlJykpIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC4kdmlld1ZhbHVlW2tleV0gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YWJsZVN0YXRlID0gY3RybC50YWJsZVN0YXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlU3RhdGUuc2VhcmNoLnByZWRpY2F0ZU9iamVjdCA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZVN0YXRlLnBhZ2luYXRpb24uc3RhcnQgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3RybC5waXBlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICBtb2R1bGUuZGlyZWN0aXZlKFwic3RDbGVhcktleVwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFQScsXHJcbiAgICAgICAgICAgIHJlcXVpcmU6IFsnXnN0VGFibGUnLCAnXm5nTW9kZWwnXSxcclxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRycywgY3RybHMpIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQub24oJ2tleWRvd24nLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbmdNb2RlbCA9IGN0cmxzWzFdO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjdHJsID0gY3RybHNbMF07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChldmVudC53aGljaCA9PT0gMTMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGN0cmwucGlwZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQud2hpY2ggPT09IDI3KSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC5jb250ZXh0LmF0dHJpYnV0ZXNbJ3N0LXNlYXJjaCddICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaWVsZE5hbWUgPSBlbGVtZW50LmNvbnRleHQuYXR0cmlidXRlc1snc3Qtc2VhcmNoJ10udmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhYmxlU3RhdGUgPSBjdHJsLnRhYmxlU3RhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZVN0YXRlLnNlYXJjaC5wcmVkaWNhdGVPYmplY3RbZmllbGROYW1lXSA9ICcnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjdHJsLnBpcGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5nTW9kZWwuJHNldFZpZXdWYWx1ZShudWxsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZ01vZGVsLiRyZW5kZXIoKTsgLy8gd2lsbCB1cGRhdGUgdGhlIGlucHV0IHZhbHVlIGFzIHdlbGxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH0pO1xyXG5cclxufVxyXG4pKCk7IiwiLy9maWx0ZXJzLmpzXHJcbihmdW5jdGlvbigpIHtcclxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5maWx0ZXIoJ3BlcmNlbnRhZ2UnLCBbJyRmaWx0ZXInLCBmdW5jdGlvbiAoJGZpbHRlcikge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoaW5wdXQsIGRlY2ltYWxzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkZmlsdGVyKCdudW1iZXInKShpbnB1dCAqIDEwMCwgZGVjaW1hbHMpICsgJyUnO1xyXG4gICAgICAgIH07XHJcbiAgICB9XSk7XHJcbiAgICB9XHJcbikoKTsiLCIvL3VzZXItZWRpdC5jb21wb25lbnQuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7XHJcblxyXG4gICAgZnVuY3Rpb24gY29udHJvbGxlcigkaHR0cCkge1xyXG4gICAgICAgIHZhciAkY3RybCA9IHRoaXM7XHJcblxyXG4gICAgICAgICRjdHJsLiRvbkluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCd1c2VyIGVkaXQgaW5pdCcsICRjdHJsKTtcclxuICAgICAgICAgICAgaWYgKCRjdHJsLnJlc29sdmUpIHtcclxuICAgICAgICAgICAgICAgICRjdHJsLnVzZXIgPSAkY3RybC5yZXNvbHZlLnVzZXI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJGN0cmwuZGlzbWlzcygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuc2F2ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3NhdmUgdXNlcicsICRjdHJsLnVzZXIpO1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnYXBpL3VzZXIvdXBkYXRlJywgJGN0cmwudXNlcikudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgYW5ndWxhci5leHRlbmQoJGN0cmwudXNlciwgci5kYXRhKTtcclxuICAgICAgICAgICAgICAgICRjdHJsLm1vZGFsSW5zdGFuY2UuY2xvc2UoJGN0cmwudXNlcik7XHJcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ3NvbWV0aGluZyB3ZW50IHdyb25nJywgZXJyLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ3VzZXJFZGl0JyxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJpbmRpbmdzOiB7XHJcbiAgICAgICAgICAgICAgICBpdGVtOiAnPCcsXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiAnPCcsXHJcbiAgICAgICAgICAgICAgICBjbG9zZTogJyYnLFxyXG4gICAgICAgICAgICAgICAgZGlzbWlzczogJyYnLFxyXG4gICAgICAgICAgICAgICAgbW9kYWxJbnN0YW5jZTogJzwnXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL3VzZXJzL3VzZXItZWRpdC5jb21wb25lbnQuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJGh0dHAnLCBjb250cm9sbGVyXVxyXG4gICAgICAgIH0pO1xyXG5cclxufVxyXG4pKCk7IiwiLy91c2VyLWxpc3QuY29tcG9uZW50LmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoJGh0dHAsICRtb2RhbCkge1xyXG4gICAgICAgIHZhciAkY3RybCA9IHRoaXM7XHJcblxyXG4gICAgICAgICRjdHJsLiRvbkluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCd1c2VyIGxpc3QgaW5pdCcpO1xyXG4gICAgICAgICAgICAkaHR0cC5nZXQoJ2FwaS91c2VyJykudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwudXNlcnMgPSByLmRhdGE7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygndXNlcnMnLCAkY3RybC51c2Vycyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuY3JlYXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkbW9kYWwub3Blbih7XHJcbiAgICAgICAgICAgICAgICBjb21wb25lbnQ6ICd1c2VyRWRpdCcsXHJcbiAgICAgICAgICAgICAgICBiaW5kaW5nczoge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGFsSW5zdGFuY2U6IFwiPFwiXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHNpemU6ICdtZCdcclxuICAgICAgICAgICAgfSkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwudXNlcnMudW5zaGlmdChyZXN1bHQpO1xyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuZWRpdCA9IGZ1bmN0aW9uICh1KSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCd1c2VyJywgdSk7XHJcbiAgICAgICAgICAgICRtb2RhbC5vcGVuKHtcclxuICAgICAgICAgICAgICAgIGNvbXBvbmVudDogJ3VzZXJFZGl0JyxcclxuICAgICAgICAgICAgICAgIGJpbmRpbmdzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kYWxJbnN0YW5jZTogXCI8XCJcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdXNlcjogdVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHNpemU6ICdtZCdcclxuICAgICAgICAgICAgfSkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgYW5ndWxhci5leHRlbmQodSwgcmVzdWx0KTtcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmRlbGV0ZSA9IGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgICAgICRodHRwLmRlbGV0ZSgnYXBpL3VzZXIvJyArIGMuaWQpLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBpZHggPSAkY3RybC5jZW5zb3JzLmluZGV4T2YoYyk7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5jZW5zb3JzLnNwbGljZShpZHgsIDEpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ3VzZXJMaXN0JyxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL3VzZXJzL3VzZXItbGlzdC5jb21wb25lbnQuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJGh0dHAnLCAnJHVpYk1vZGFsJywgY29udHJvbGxlcl1cclxuICAgICAgICB9KTtcclxuXHJcbn1cclxuKSgpOyIsIi8vdmlzaXRvci1lZGl0LmNvbXBvbmVudC5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnKTtcclxuXHJcbiAgICBmdW5jdGlvbiBjb250cm9sbGVyKCRodHRwKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3Zpc2l0b3IgZWRpdCBpbml0Jyk7XHJcblxyXG4gICAgICAgICAgICAkY3RybC50aXRsZSA9ICdOZXcgVmlzaXRvcic7XHJcblxyXG4gICAgICAgICAgICBpZiAoJGN0cmwucmVzb2x2ZSkge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuaWQgPSAkY3RybC5yZXNvbHZlLmlkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICgkY3RybC5pZCkge1xyXG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KCdhcGkvdmlzaXRvci8nICsgJGN0cmwuaWQpLnRoZW4oZnVuY3Rpb24ocikge1xyXG4gICAgICAgICAgICAgICAgICAgICRjdHJsLnZpc2l0b3IgPSByLmRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgJGN0cmwudGl0bGUgPSAoJGN0cmwudmlzaXRvci5maXJzdG5hbWUgKyAnICcgKyAkY3RybC52aXNpdG9yLmxhc3RuYW1lKTtcclxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnInLCBlcnIubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJGN0cmwuZGlzbWlzcygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuc2F2ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3NhdmUgdmlzaXRvcicsICRjdHJsLnZpc2l0b3IpO1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnYXBpL3Zpc2l0b3InLCAkY3RybC52aXNpdG9yKS50aGVuKGZ1bmN0aW9uIChyKSB7XHJcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmV4dGVuZCgkY3RybC52aXNpdG9yLCByLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwubW9kYWxJbnN0YW5jZS5jbG9zZSgkY3RybC52aXNpdG9yKTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignc29tZXRoaW5nIHdlbnQgd3JvbmcnLCBlcnIubWVzc2FnZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ3Zpc2l0b3JFZGl0JyxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJpbmRpbmdzOiB7XHJcbiAgICAgICAgICAgICAgICBpdGVtOiAnPCcsXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiAnPCcsXHJcbiAgICAgICAgICAgICAgICBjbG9zZTogJyYnLFxyXG4gICAgICAgICAgICAgICAgZGlzbWlzczogJyYnLFxyXG4gICAgICAgICAgICAgICAgbW9kYWxJbnN0YW5jZTogJzwnXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL3Zpc2l0b3JzL3Zpc2l0b3ItZWRpdC5jb21wb25lbnQuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJGh0dHAnLCBjb250cm9sbGVyXVxyXG4gICAgICAgIH0pO1xyXG59XHJcbikoKTsiLCIvL3Zpc2l0b3ItbGlzdC5jb21wb25lbnQuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7XHJcblxyXG4gICAgZnVuY3Rpb24gY29udHJvbGxlcigkaHR0cCwgJG1vZGFsKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpczsgXHJcbiAgICAgICAgdmFyIHBhZ2VTaXplRGVmYXVsdCA9IDEwO1xyXG4gICAgICAgIHZhciB0YWJsZVN0YXRlUmVmO1xyXG5cclxuICAgICAgICAkY3RybC5zZWFyY2hNb2RlbCA9IHtcclxuICAgICAgICAgICAgcGFnZTogMSxcclxuICAgICAgICAgICAgcGFnZVNpemU6IHBhZ2VTaXplRGVmYXVsdFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRjdHJsLiRvbkluaXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ2luaXQgdmlzaXRvciBsaXN0Jyk7XHJcbiAgICAgICAgICAgICRjdHJsLnRpdGxlID0gJ1Zpc2l0b3JzJztcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmNyZWF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJG1vZGFsLm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50OiAndmlzaXRvckVkaXQnLFxyXG4gICAgICAgICAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgICAgICAgICBtb2RhbEluc3RhbmNlOiBcIjxcIlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBzaXplOiAnbWQnXHJcbiAgICAgICAgICAgIH0pLnJlc3VsdC50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgICRjdHJsLnZpc2l0b3JzLnVuc2hpZnQocmVzdWx0KTtcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmVkaXQgPSBmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgICAgICRtb2RhbC5vcGVuKHtcclxuICAgICAgICAgICAgICAgIGNvbXBvbmVudDogJ3Zpc2l0b3JFZGl0JyxcclxuICAgICAgICAgICAgICAgIGJpbmRpbmdzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kYWxJbnN0YW5jZTogXCI8XCJcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWQ6IHYuaWRcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBzaXplOiAnbWQnXHJcbiAgICAgICAgICAgIH0pLnJlc3VsdC50aGVuKGZ1bmN0aW9uIChyZXN1bHQpIHtcclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKHYsIHJlc3VsdCk7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5kZWxldGUgPSBmdW5jdGlvbih2KSB7XHJcbiAgICAgICAgICAgICRodHRwLmRlbGV0ZSgnYXBpL3Zpc2l0b3IvJyArIHYuaWQpLnRoZW4oZnVuY3Rpb24ocikge1xyXG4gICAgICAgICAgICAgICAgdmFyIGlkeCA9ICRjdHJsLnZpc2l0b3JzLmluZGV4T2Yodik7XHJcbiAgICAgICAgICAgICAgICAkY3RybC52aXNpdG9ycy5zcGxpY2UoaWR4LCAxKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5zZWFyY2ggPSBmdW5jdGlvbiAodGFibGVTdGF0ZSkge1xyXG4gICAgICAgICAgICB0YWJsZVN0YXRlUmVmID0gdGFibGVTdGF0ZTtcclxuICAgICAgICAgICAgJGN0cmwuc2VhcmNoTW9kZWwuZnV6enlNYXRjaFJhbmdlID0gJGN0cmwuZnV6enlNYXRjaFJhbmdlOyBcclxuICAgICAgICAgICAgJGN0cmwuc2VhcmNoTW9kZWwuZGF5c09sZCA9ICRjdHJsLmRheXM7XHJcblxyXG4gICAgICAgICAgICBpZiAodHlwZW9mICh0YWJsZVN0YXRlLnNvcnQucHJlZGljYXRlKSAhPT0gXCJ1bmRlZmluZWRcIikge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuc2VhcmNoTW9kZWwub3JkZXJCeSA9IHRhYmxlU3RhdGUuc29ydC5wcmVkaWNhdGU7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5zZWFyY2hNb2RlbC5vcmRlckRpcmVjdGlvbiA9IHRhYmxlU3RhdGUuc29ydC5yZXZlcnNlID8gJ2Rlc2MnIDogJ2FzYyc7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICRodHRwLmdldCgnYXBpL3Zpc2l0b3InLCB7IHBhcmFtczogJGN0cmwuc2VhcmNoTW9kZWwgfSkudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwudmlzaXRvcnMgPSByLmRhdGEucmVzdWx0cztcclxuICAgICAgICAgICAgICAgICRjdHJsLnNlYXJjaE1vZGVsID0gci5kYXRhO1xyXG4gICAgICAgICAgICAgICAgZGVsZXRlICRjdHJsLnNlYXJjaE1vZGVsLnJlc3VsdHM7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwucGFnZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRjdHJsLnNlYXJjaCh0YWJsZVN0YXRlUmVmKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ3Zpc2l0b3JMaXN0JyxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL3Zpc2l0b3JzL3Zpc2l0b3ItbGlzdC5jb21wb25lbnQuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJGh0dHAnLCAnJHVpYk1vZGFsJywgY29udHJvbGxlcl1cclxuICAgICAgICB9KTtcclxufVxyXG4pKCk7Il19
