!function(){var t=angular.module("app",["app.directives","ui.bootstrap","ui.slider","smart-table","ngTagsInput","ngAnimate","treasure-overlay-spinner","toastr"]);t.config(["toastrConfig",function(t){angular.extend(t,{positionClass:"toast-bottom-right",newestOnTop:!0,allowHtml:!1,closeButton:!1,closeHtml:"<button>&times;</button>",extendedTimeOut:1e3,iconClasses:{error:"toast-error",info:"toast-info",success:"toast-success",warning:"toast-warning"},messageClass:"toast-message",onHidden:null,onShown:null,onTap:null,progressBar:!1,tapToDismiss:!0,templates:{toast:"directives/toast/toast.html",progressbar:"directives/progressbar/progressbar.html"},timeOut:5e3,titleClass:"toast-title",toastClass:"toast"})}])}();
!function(){function n(n){var e=this;e.$onInit=function(){console.log("censor edit init"),e.resolve&&(e.id=e.resolve.id),e.id&&n.get("api/censor/"+e.id).then(function(n){e.censor=n.data}).catch(function(n){console.log("err",n.message)})},e.cancel=function(){e.dismiss()},e.save=function(){return console.log("save censor",e.censor),n.post("api/censor",e.censor).then(function(n){angular.extend(e.censor,n.data),e.modalInstance.close(e.censor)}).catch(function(n){console.error("something went wrong",n.message)})}}var e=angular.module("app");e.component("censorEdit",{bindings:{item:"<",resolve:"<",close:"&",dismiss:"&",modalInstance:"<"},templateUrl:"app/censors/censor-edit.component.html",controller:["$http",n]})}();
!function(){function e(e,n,o){var s,t=this,c=10;t.searchModel={page:1,pageSize:c},t.$onInit=function(){console.log("censor list init")},t.create=function(){n.open({component:"censorEdit",bindings:{modalInstance:"<"},resolve:{},size:"md"}).result.then(function(e){t.censors.unshift(e),o.success("Saved Censor")},function(e){})},t.edit=function(e){n.open({component:"censorEdit",bindings:{modalInstance:"<"},resolve:{id:e.id},size:"md"}).result.then(function(n){angular.extend(e,n),o.success("Updated Censor")},function(e){})},t.delete=function(n){e.delete("api/censor/"+n.id).then(function(e){var s=t.censors.indexOf(n);t.censors.splice(s,1),o.warning("Deleted censor")})},t.search=function(n){t.loading=!0,s=n,"undefined"!=typeof n.sort.predicate&&(t.searchModel.orderBy=n.sort.predicate,t.searchModel.orderDirection=n.sort.reverse?"desc":"asc"),e.get("api/censor/search",{params:t.searchModel}).then(function(e){console.log("r",e.data),t.censors=e.data.results,t.searchModel=e.data,console.log(t.censors),delete t.searchModel.results}).finally(function(){t.loading=!1})},t.paged=function(){t.search(s)}}var n=angular.module("app");n.component("censorList",{templateUrl:"app/censors/censor-list.component.html",controller:["$http","$uibModal","toastr",e]})}();
!function(){function n(n,o){var t=this,i=$.connection.nameNotificationHub;t.$onInit=function(){console.log("configuration setting init"),$.connection.hub.start().done(function(){console.log("hub connection started")}),n.get("api/configuration").then(function(n){t.configuration=n.data,o.success("Loaded configuration")})},t.cancel=function(){t.dismiss()},t.save=function(){return n.post("api/configuration",t.configuration).then(function(n){angular.extend(t.configuration,n.data),o.success("Configuration Saved")}).catch(function(n){console.error("something went wrong",n.message),o.error("Error Saving Configuration")}).finally(function(){i.server.configurationChange(t.configuration).then(function(n){console.log("configuration sent to hub")})})}}var o=angular.module("app");o.component("configurationSetting",{templateUrl:"app/configuration/configuration-setting.component.html",controller:["$http","toastr",n]})}();
!function(){function n(n){var o=this;o.$onInit=function(){console.log("dashboard init"),o.refresh()},o.refresh=function(){o.loading=!0,n.get("api/visitor/summary").then(function(n){o.summary=n.data}).catch(function(n){console.error("something went wrong",n)}).finally(function(n){o.loading=!1})}}var o=angular.module("app");o.component("dashboard",{templateUrl:"app/dashboard/dashboard.component.html",controller:["$http",n]})}();
!function(){angular.module("app.directives",[])}();
!function(){var e=angular.module("app.directives");e.directive("stSubmitSearch",["stConfig","$timeout","$parse",function(e,t,r){return{require:"^stTable",link:function(e,t,r,n){return t.bind("click",function(){var e=n;e.pipe()})}}}]),e.directive("clearKey",function(){return{restrict:"EA",require:"ngModel",link:function(e,t,r,n){t.on("keydown",function(t){27===t.which&&(n.$setViewValue(null),n.$render(),e.$apply())})}}}),e.directive("stResetSearch",function(){return{restrict:"EA",require:["^stTable","^ngModel"],link:function(e,t,r,n){return t.bind("click",function(){var t=n[1],r=n[0];return e.$apply(function(){angular.forEach(t.$viewValue,function(e,r){"page"===r.toLowerCase()&&(t.$viewValue[r]=1),Array.isArray(e)||_.includes(r.toLowerCase(),"page")||(t.$viewValue[r]=null)});var e=r.tableState();return e.search.predicateObject={},e.pagination.start=0,r.pipe()})})}}}),e.directive("stClearKey",function(){return{restrict:"EA",require:["^stTable","^ngModel"],link:function(e,t,r,n){t.on("keydown",function(r){var i=n[1],a=n[0];return 13===r.which?a.pipe():27===r.which?void 0!==t.context.attributes["st-search"]?e.$apply(function(){var e=t.context.attributes["st-search"].value,r=a.tableState();return r.search.predicateObject[e]="",a.pipe()}):e.$apply(function(){i.$setViewValue(null),i.$render()}):void 0})}}})}();
!function(){angular.module("app").filter("percentage",["$filter",function(n){return function(e,r){return n("number")(100*e,r)+"%"}}])}();
!function(){function e(e){var s=this;s.$onInit=function(){console.log("user edit init"),s.resolve&&(s.user=s.resolve.user),e.get("api/user/roles").then(function(e){s.roles=e.data})},s.cancel=function(){s.dismiss()},s.save=function(){s.user.email||(s.user.email=s.user.userName+"@splcenter.org");var n=[];return _.forEach(s.user.roles,function(e){n.push(e.name)}),0===n.length&&n.push("user"),s.user.roles=n,e.post("api/user/update",s.user).then(function(e){angular.extend(s.user,e.data),s.modalInstance.close(s.user)}).catch(function(e){console.error("something went wrong",e.message)})}}var s=angular.module("app");s.component("userEdit",{bindings:{item:"<",resolve:"<",close:"&",dismiss:"&",modalInstance:"<"},templateUrl:"app/users/user-edit.component.html",controller:["$http",e]})}();
!function(){function e(e,n,s){var t=this;t.$onInit=function(){t.title="Users",e.get("api/user").then(function(e){t.users=e.data})},t.create=function(){n.open({component:"userEdit",bindings:{modalInstance:"<"},size:"md"}).result.then(function(e){var n=e,o=[];_.forEach(e.roles,function(e){console.log("role",e),o.push(e)}),n.roles=[],console.log("result",n),n.roles=[]=o,console.log("roles",o),console.log("result",n),t.users.unshift(n),s.success("Created User")},function(e){})},t.edit=function(e){n.open({component:"userEdit",bindings:{modalInstance:"<"},resolve:{user:angular.copy(e)},size:"md"}).result.then(function(n){angular.extend(e,n),s.success("Updated User")},function(e){})},t.delete=function(n){e.delete("api/user/"+n.id).then(function(e){var o=t.users.indexOf(n);t.users.splice(o,1),s.warning("Deleted User")})}}var n=angular.module("app");n.component("userList",{templateUrl:"app/users/user-list.component.html",controller:["$http","$uibModal","toastr",e]})}();
!function(){function i(i){var t=this;t.$onInit=function(){console.log("visitor edit init"),t.title="New Visitor",t.resolve&&(t.id=t.resolve.id),t.id&&i.get("api/visitor/"+t.id).then(function(i){t.visitor=i.data,t.title=t.visitor.firstname+" "+t.visitor.lastname}).catch(function(i){console.log("err",i.message)})},t.cancel=function(){t.dismiss()},t.save=function(){return console.log("save visitor",t.visitor),i.post("api/visitor",t.visitor).then(function(i){angular.extend(t.visitor,i.data),t.modalInstance.close(t.visitor)}).catch(function(i){console.error("something went wrong",i.message)})}}var t=angular.module("app");t.component("visitorEdit",{bindings:{item:"<",resolve:"<",close:"&",dismiss:"&",modalInstance:"<"},templateUrl:"app/visitors/visitor-edit.component.html",controller:["$http",i]})}();
!function(){function e(e,t,i){var n,o=this,s=10;o.searchModel={page:1,pageSize:s},o.$onInit=function(){console.log("init visitor list"),o.title="Visitors"},o.create=function(){t.open({component:"visitorEdit",bindings:{modalInstance:"<"},resolve:{},size:"md"}).result.then(function(e){o.visitors.unshift(e),i.success("Created Visitor")},function(e){})},o.edit=function(e){t.open({component:"visitorEdit",bindings:{modalInstance:"<"},resolve:{id:e.id},size:"md"}).result.then(function(t){angular.extend(e,t),i.success("Updated Visitor")},function(e){})},o.delete=function(t){e.delete("api/visitor/"+t.id).then(function(e){var n=o.visitors.indexOf(t);o.visitors.splice(n,1),i.warning("Deleted Visitor")})},o.search=function(t){o.loading=!0,n=t,o.searchModel.fuzzyMatchRange=o.fuzzyMatchRange,o.searchModel.daysOld=o.days,"undefined"!=typeof t.sort.predicate&&(o.searchModel.orderBy=t.sort.predicate,o.searchModel.orderDirection=t.sort.reverse?"desc":"asc"),e.get("api/visitor",{params:o.searchModel}).then(function(e){o.visitors=e.data.results,o.searchModel=e.data,delete o.searchModel.results}).finally(function(){o.loading=!1})},o.paged=function(){o.search(n)}}var t=angular.module("app");t.component("visitorList",{templateUrl:"app/visitors/visitor-list.component.html",controller:["$http","$uibModal","toastr",e]})}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJjZW5zb3JzL2NlbnNvci1lZGl0LmNvbXBvbmVudC5qcyIsImNlbnNvcnMvY2Vuc29yLWxpc3QuY29tcG9uZW50LmpzIiwiY29uZmlndXJhdGlvbi9jb25maWd1cmF0aW9uLXNldHRpbmcuY29tcG9uZW50LmpzIiwiZGFzaGJvYXJkL2Rhc2hib2FyZC5jb21wb25lbnQuanMiLCJkaXJlY3RpdmVzL2RpcmVjdGl2ZXMubW9kdWxlcy5qcyIsImRpcmVjdGl2ZXMvc3RUYWJsZS5kaXJlY3RpdmUuanMiLCJmaWx0ZXJzL2ZpbHRlcnMuanMiLCJ1c2Vycy91c2VyLWVkaXQuY29tcG9uZW50LmpzIiwidXNlcnMvdXNlci1saXN0LmNvbXBvbmVudC5qcyIsInZpc2l0b3JzL3Zpc2l0b3ItZWRpdC5jb21wb25lbnQuanMiLCJ2aXNpdG9ycy92aXNpdG9yLWxpc3QuY29tcG9uZW50LmpzIl0sIm5hbWVzIjpbIm1vZHVsZSIsImFuZ3VsYXIiLCJjb25maWciLCJ0b2FzdHJDb25maWciLCJleHRlbmQiLCJwb3NpdGlvbkNsYXNzIiwibmV3ZXN0T25Ub3AiLCJhbGxvd0h0bWwiLCJjbG9zZUJ1dHRvbiIsImNsb3NlSHRtbCIsImV4dGVuZGVkVGltZU91dCIsImljb25DbGFzc2VzIiwiZXJyb3IiLCJpbmZvIiwic3VjY2VzcyIsIndhcm5pbmciLCJtZXNzYWdlQ2xhc3MiLCJvbkhpZGRlbiIsIm9uU2hvd24iLCJvblRhcCIsInByb2dyZXNzQmFyIiwidGFwVG9EaXNtaXNzIiwidGVtcGxhdGVzIiwidG9hc3QiLCJwcm9ncmVzc2JhciIsInRpbWVPdXQiLCJ0aXRsZUNsYXNzIiwidG9hc3RDbGFzcyIsImNvbnRyb2xsZXIiLCIkaHR0cCIsIiRjdHJsIiwidGhpcyIsIiRvbkluaXQiLCJjb25zb2xlIiwibG9nIiwicmVzb2x2ZSIsImlkIiwiZ2V0IiwidGhlbiIsInIiLCJjZW5zb3IiLCJkYXRhIiwiY2F0Y2giLCJlcnIiLCJtZXNzYWdlIiwiY2FuY2VsIiwiZGlzbWlzcyIsInNhdmUiLCJwb3N0IiwibW9kYWxJbnN0YW5jZSIsImNsb3NlIiwiY29tcG9uZW50IiwiYmluZGluZ3MiLCJpdGVtIiwidGVtcGxhdGVVcmwiLCIkbW9kYWwiLCJ0b2FzdHIiLCJ0YWJsZVN0YXRlUmVmIiwicGFnZVNpemVEZWZhdWx0Iiwic2VhcmNoTW9kZWwiLCJwYWdlIiwicGFnZVNpemUiLCJjcmVhdGUiLCJvcGVuIiwic2l6ZSIsInJlc3VsdCIsImNlbnNvcnMiLCJ1bnNoaWZ0IiwicmVhc29uIiwiZWRpdCIsImMiLCJkZWxldGUiLCJpZHgiLCJpbmRleE9mIiwic3BsaWNlIiwic2VhcmNoIiwidGFibGVTdGF0ZSIsImxvYWRpbmciLCJzb3J0Iiwib3JkZXJCeSIsInByZWRpY2F0ZSIsIm9yZGVyRGlyZWN0aW9uIiwicmV2ZXJzZSIsInBhcmFtcyIsInJlc3VsdHMiLCJmaW5hbGx5IiwicGFnZWQiLCJodWIiLCIkIiwiY29ubmVjdGlvbiIsIm5hbWVOb3RpZmljYXRpb25IdWIiLCJzdGFydCIsImRvbmUiLCJjb25maWd1cmF0aW9uIiwic2VydmVyIiwiY29uZmlndXJhdGlvbkNoYW5nZSIsInJlZnJlc2giLCJzdW1tYXJ5IiwiZSIsImRpcmVjdGl2ZSIsInN0Q29uZmlnIiwiJHRpbWVvdXQiLCIkcGFyc2UiLCJyZXF1aXJlIiwibGluayIsInNjb3BlIiwiZWxlbWVudCIsImF0dHIiLCJjdHJsIiwiYmluZCIsInRhYmxlQ3RybCIsInBpcGUiLCJyZXN0cmljdCIsImVsIiwiYXR0cnMiLCJvbiIsImV2ZW50Iiwid2hpY2giLCIkc2V0Vmlld1ZhbHVlIiwiJHJlbmRlciIsIiRhcHBseSIsImN0cmxzIiwibW9kZWwiLCJmb3JFYWNoIiwiJHZpZXdWYWx1ZSIsInZhbHVlIiwia2V5IiwidG9Mb3dlckNhc2UiLCJBcnJheSIsImlzQXJyYXkiLCJfIiwiaW5jbHVkZXMiLCJwcmVkaWNhdGVPYmplY3QiLCJwYWdpbmF0aW9uIiwibmdNb2RlbCIsInVuZGVmaW5lZCIsImNvbnRleHQiLCJhdHRyaWJ1dGVzIiwiZmllbGROYW1lIiwiZmlsdGVyIiwiJGZpbHRlciIsImlucHV0IiwiZGVjaW1hbHMiLCJ1c2VyIiwicm9sZXMiLCJlbWFpbCIsInVzZXJOYW1lIiwicm9sZSIsInB1c2giLCJuYW1lIiwibGVuZ3RoIiwidGl0bGUiLCJ1c2VycyIsImNvcHkiLCJ2aXNpdG9yIiwiZmlyc3RuYW1lIiwibGFzdG5hbWUiLCJ2aXNpdG9ycyIsInYiLCJmdXp6eU1hdGNoUmFuZ2UiLCJkYXlzT2xkIiwiZGF5cyJdLCJtYXBwaW5ncyI6IkNBQ0EsV0FDSSxHQUFJQSxHQUFTQyxRQUFRRCxPQUFPLE9BQ3hCLGlCQUNBLGVBQ0EsWUFDQSxjQUNBLGNBQ0EsWUFDQSwyQkFDQSxVQUdKQSxHQUFPRSxRQUFRLGVBQWdCLFNBQVVDLEdBQ3JDRixRQUFRRyxPQUFPRCxHQUNYRSxjQUFlLHFCQUNmQyxhQUFhLEVBQ2JDLFdBQVcsRUFDWEMsYUFBYSxFQUNiQyxVQUFXLDJCQUNYQyxnQkFBaUIsSUFDakJDLGFBQ0lDLE1BQU8sY0FDUEMsS0FBTSxhQUNOQyxRQUFTLGdCQUNUQyxRQUFTLGlCQUViQyxhQUFjLGdCQUNkQyxTQUFVLEtBQ1ZDLFFBQVMsS0FDVEMsTUFBTyxLQUNQQyxhQUFhLEVBQ2JDLGNBQWMsRUFDZEMsV0FDSUMsTUFBTyw4QkFDUEMsWUFBYSwyQ0FFakJDLFFBQVMsSUFDVEMsV0FBWSxjQUNaQyxXQUFZO0NDdEN4QixXQUdJLFFBQVNDLEdBQVdDLEdBQ2hCLEdBQUlDLEdBQVFDLElBRVpELEdBQU1FLFFBQVUsV0FDWkMsUUFBUUMsSUFBSSxvQkFFUkosRUFBTUssVUFDTkwsRUFBTU0sR0FBS04sRUFBTUssUUFBUUMsSUFFekJOLEVBQU1NLElBQ05QLEVBQU1RLElBQUksY0FBZ0JQLEVBQU1NLElBQUlFLEtBQUssU0FBVUMsR0FDL0NULEVBQU1VLE9BQVNELEVBQUVFLE9BQ2xCQyxNQUFNLFNBQVVDLEdBQ2ZWLFFBQVFDLElBQUksTUFBT1MsRUFBSUMsWUFNbkNkLEVBQU1lLE9BQVMsV0FD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RUFBSyxHQUMzQmhCLEVBQU96QyxRQUFRLHNCQUl2QmUsRUFBTTZDLE9BQVMsU0FBVUMsR0FDckI5QyxFQUFNK0MsU0FBVSxFQUNoQnBCLEVBQWdCbUIsRUFDaEI5QyxFQUFNNkIsWUFBWW9HLGdCQUFrQmpJLEVBQU1pSSxnQkFDMUNqSSxFQUFNNkIsWUFBWXFHLFFBQVVsSSxFQUFNbUksS0FFUyxtQkFBL0JyRixHQUFXRSxLQUFjLFlBQ2pDaEQsRUFBTTZCLFlBQVlvQixRQUFVSCxFQUFXRSxLQUFLRSxVQUM1Q2xELEVBQU02QixZQUFZc0IsZUFBaUJMLEVBQVdFLEtBQUtJLFFBQVUsT0FBUyxPQUcxRXJELEVBQU1RLElBQUksZUFBaUI4QyxPQUFRckQsRUFBTTZCLGNBQWVyQixLQUFLLFNBQVVDLEdBQ25FVCxFQUFNK0gsU0FBV3RILEVBQUVFLEtBQUsyQyxRQUN4QnRELEVBQU02QixZQUFjcEIsRUFBRUUsV0FDZlgsR0FBTTZCLFlBQVl5QixVQUMxQkMsUUFBUSxXQUNQdkQsRUFBTStDLFNBQVUsS0FJeEIvQyxFQUFNd0QsTUFBUSxXQUNWeEQsRUFBTTZDLE9BQU9sQixJQS9FckIsR0FBSXpELEdBQVNDLFFBQVFELE9BQU8sTUFvRjVCQSxHQUFPbUQsVUFBVSxlQUVURyxZQUFhLDJDQUNiMUIsWUFBYSxRQUFTLFlBQWEsU0FBVUEiLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vYXBwLm1vZHVsZS5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXHJcbiAgICAgICAgJ2FwcC5kaXJlY3RpdmVzJyxcclxuICAgICAgICAndWkuYm9vdHN0cmFwJyxcclxuICAgICAgICAndWkuc2xpZGVyJyxcclxuICAgICAgICAnc21hcnQtdGFibGUnLFxyXG4gICAgICAgICduZ1RhZ3NJbnB1dCcsXHJcbiAgICAgICAgJ25nQW5pbWF0ZScsIFxyXG4gICAgICAgICd0cmVhc3VyZS1vdmVybGF5LXNwaW5uZXInLFxyXG4gICAgICAgICd0b2FzdHInXHJcbiAgICBdKTtcclxuXHJcbiAgICBtb2R1bGUuY29uZmlnKFsndG9hc3RyQ29uZmlnJywgZnVuY3Rpb24gKHRvYXN0ckNvbmZpZykge1xyXG4gICAgICAgIGFuZ3VsYXIuZXh0ZW5kKHRvYXN0ckNvbmZpZywge1xyXG4gICAgICAgICAgICBwb3NpdGlvbkNsYXNzOiAndG9hc3QtYm90dG9tLXJpZ2h0JyxcclxuICAgICAgICAgICAgbmV3ZXN0T25Ub3A6IHRydWUsXHJcbiAgICAgICAgICAgIGFsbG93SHRtbDogZmFsc2UsXHJcbiAgICAgICAgICAgIGNsb3NlQnV0dG9uOiBmYWxzZSxcclxuICAgICAgICAgICAgY2xvc2VIdG1sOiAnPGJ1dHRvbj4mdGltZXM7PC9idXR0b24+JyxcclxuICAgICAgICAgICAgZXh0ZW5kZWRUaW1lT3V0OiAxMDAwLFxyXG4gICAgICAgICAgICBpY29uQ2xhc3Nlczoge1xyXG4gICAgICAgICAgICAgICAgZXJyb3I6ICd0b2FzdC1lcnJvcicsXHJcbiAgICAgICAgICAgICAgICBpbmZvOiAndG9hc3QtaW5mbycsXHJcbiAgICAgICAgICAgICAgICBzdWNjZXNzOiAndG9hc3Qtc3VjY2VzcycsXHJcbiAgICAgICAgICAgICAgICB3YXJuaW5nOiAndG9hc3Qtd2FybmluZydcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgbWVzc2FnZUNsYXNzOiAndG9hc3QtbWVzc2FnZScsXHJcbiAgICAgICAgICAgIG9uSGlkZGVuOiBudWxsLFxyXG4gICAgICAgICAgICBvblNob3duOiBudWxsLFxyXG4gICAgICAgICAgICBvblRhcDogbnVsbCxcclxuICAgICAgICAgICAgcHJvZ3Jlc3NCYXI6IGZhbHNlLFxyXG4gICAgICAgICAgICB0YXBUb0Rpc21pc3M6IHRydWUsXHJcbiAgICAgICAgICAgIHRlbXBsYXRlczoge1xyXG4gICAgICAgICAgICAgICAgdG9hc3Q6ICdkaXJlY3RpdmVzL3RvYXN0L3RvYXN0Lmh0bWwnLFxyXG4gICAgICAgICAgICAgICAgcHJvZ3Jlc3NiYXI6ICdkaXJlY3RpdmVzL3Byb2dyZXNzYmFyL3Byb2dyZXNzYmFyLmh0bWwnXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHRpbWVPdXQ6IDUwMDAsXHJcbiAgICAgICAgICAgIHRpdGxlQ2xhc3M6ICd0b2FzdC10aXRsZScsXHJcbiAgICAgICAgICAgIHRvYXN0Q2xhc3M6ICd0b2FzdCdcclxuICAgICAgICB9KTtcclxuICAgIH1dKTtcclxuXHJcbn1cclxuKSgpOyIsIi8vY2Vuc29yLWVkaXQuY29tcG9uZW50LmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoJGh0dHApIHtcclxuICAgICAgICB2YXIgJGN0cmwgPSB0aGlzO1xyXG5cclxuICAgICAgICAkY3RybC4kb25Jbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnY2Vuc29yIGVkaXQgaW5pdCcpO1xyXG5cclxuICAgICAgICAgICAgaWYgKCRjdHJsLnJlc29sdmUpIHtcclxuICAgICAgICAgICAgICAgICRjdHJsLmlkID0gJGN0cmwucmVzb2x2ZS5pZDtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBpZiAoJGN0cmwuaWQpIHtcclxuICAgICAgICAgICAgICAgICRodHRwLmdldCgnYXBpL2NlbnNvci8nICsgJGN0cmwuaWQpLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgICAgICAkY3RybC5jZW5zb3IgPSByLmRhdGE7XHJcbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2VycicsIGVyci5tZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkY3RybC5kaXNtaXNzKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5zYXZlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnc2F2ZSBjZW5zb3InLCAkY3RybC5jZW5zb3IpO1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnYXBpL2NlbnNvcicsICRjdHJsLmNlbnNvcikudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgYW5ndWxhci5leHRlbmQoJGN0cmwuY2Vuc29yLCByLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwubW9kYWxJbnN0YW5jZS5jbG9zZSgkY3RybC5jZW5zb3IpO1xyXG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdzb21ldGhpbmcgd2VudCB3cm9uZycsIGVyci5tZXNzYWdlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb2R1bGUuY29tcG9uZW50KCdjZW5zb3JFZGl0JyxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJpbmRpbmdzOiB7XHJcbiAgICAgICAgICAgICAgICBpdGVtOiAnPCcsXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiAnPCcsXHJcbiAgICAgICAgICAgICAgICBjbG9zZTogJyYnLFxyXG4gICAgICAgICAgICAgICAgZGlzbWlzczogJyYnLFxyXG4gICAgICAgICAgICAgICAgbW9kYWxJbnN0YW5jZTogJzwnXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL2NlbnNvcnMvY2Vuc29yLWVkaXQuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiBbJyRodHRwJywgY29udHJvbGxlcl1cclxuICAgICAgICB9KTtcclxufVxyXG4pKCk7IiwiLy9jZW5zb3ItbGlzdC5jb21wb25lbnQuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7XHJcblxyXG4gICAgZnVuY3Rpb24gY29udHJvbGxlcigkaHR0cCwgJG1vZGFsLCB0b2FzdHIpIHtcclxuICAgICAgICB2YXIgJGN0cmwgPSB0aGlzO1xyXG4gICAgICAgIHZhciBwYWdlU2l6ZURlZmF1bHQgPSAxMDtcclxuICAgICAgICB2YXIgdGFibGVTdGF0ZVJlZjtcclxuXHJcbiAgICAgICAgJGN0cmwuc2VhcmNoTW9kZWwgPSB7XHJcbiAgICAgICAgICAgIHBhZ2U6IDEsXHJcbiAgICAgICAgICAgIHBhZ2VTaXplOiBwYWdlU2l6ZURlZmF1bHRcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkY3RybC4kb25Jbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnY2Vuc29yIGxpc3QgaW5pdCcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuY3JlYXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkbW9kYWwub3Blbih7XHJcbiAgICAgICAgICAgICAgICBjb21wb25lbnQ6ICdjZW5zb3JFZGl0JyxcclxuICAgICAgICAgICAgICAgIGJpbmRpbmdzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kYWxJbnN0YW5jZTogXCI8XCJcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogJ21kJ1xyXG4gICAgICAgICAgICB9KS5yZXN1bHQudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5jZW5zb3JzLnVuc2hpZnQocmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIHRvYXN0ci5zdWNjZXNzKCdTYXZlZCBDZW5zb3InKTsgXHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5lZGl0ID0gZnVuY3Rpb24gKGMpIHtcclxuICAgICAgICAgICAgJG1vZGFsLm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50OiAnY2Vuc29yRWRpdCcsXHJcbiAgICAgICAgICAgICAgICBiaW5kaW5nczoge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGFsSW5zdGFuY2U6IFwiPFwiXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiBjLmlkXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogJ21kJ1xyXG4gICAgICAgICAgICB9KS5yZXN1bHQudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmV4dGVuZChjLCByZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgdG9hc3RyLnN1Y2Nlc3MoJ1VwZGF0ZWQgQ2Vuc29yJyk7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5kZWxldGUgPSBmdW5jdGlvbiAoYykge1xyXG4gICAgICAgICAgICAkaHR0cC5kZWxldGUoJ2FwaS9jZW5zb3IvJyArIGMuaWQpLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBpZHggPSAkY3RybC5jZW5zb3JzLmluZGV4T2YoYyk7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5jZW5zb3JzLnNwbGljZShpZHgsIDEpO1xyXG4gICAgICAgICAgICAgICAgdG9hc3RyLndhcm5pbmcoJ0RlbGV0ZWQgY2Vuc29yJyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuc2VhcmNoID0gZnVuY3Rpb24gKHRhYmxlU3RhdGUpIHtcclxuICAgICAgICAgICAgJGN0cmwubG9hZGluZyA9IHRydWU7IFxyXG4gICAgICAgICAgICB0YWJsZVN0YXRlUmVmID0gdGFibGVTdGF0ZTtcclxuICAgICAgICAgICAgaWYgKHR5cGVvZiAodGFibGVTdGF0ZS5zb3J0LnByZWRpY2F0ZSkgIT09IFwidW5kZWZpbmVkXCIpIHtcclxuICAgICAgICAgICAgICAgICRjdHJsLnNlYXJjaE1vZGVsLm9yZGVyQnkgPSB0YWJsZVN0YXRlLnNvcnQucHJlZGljYXRlO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuc2VhcmNoTW9kZWwub3JkZXJEaXJlY3Rpb24gPSB0YWJsZVN0YXRlLnNvcnQucmV2ZXJzZSA/ICdkZXNjJyA6ICdhc2MnO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICRodHRwLmdldCgnYXBpL2NlbnNvci9zZWFyY2gnLCB7IHBhcmFtczogJGN0cmwuc2VhcmNoTW9kZWwgfSkudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3InLCByLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuY2Vuc29ycyA9IHIuZGF0YS5yZXN1bHRzO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuc2VhcmNoTW9kZWwgPSByLmRhdGE7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygkY3RybC5jZW5zb3JzKTtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZSAkY3RybC5zZWFyY2hNb2RlbC5yZXN1bHRzO1xyXG4gICAgICAgICAgICB9KS5maW5hbGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwubG9hZGluZyA9IGZhbHNlOyBcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5wYWdlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJGN0cmwuc2VhcmNoKHRhYmxlU3RhdGVSZWYpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBtb2R1bGUuY29tcG9uZW50KCdjZW5zb3JMaXN0JyxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL2NlbnNvcnMvY2Vuc29yLWxpc3QuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiBbJyRodHRwJywgJyR1aWJNb2RhbCcsICd0b2FzdHInLCBjb250cm9sbGVyXVxyXG4gICAgICAgIH0pO1xyXG59XHJcbikoKTsiLCIvL2NvbmZpZ3VyYXRpb24tc2V0dGluZy5jb21wb25lbnQuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7XHJcblxyXG4gICAgZnVuY3Rpb24gY29udHJvbGxlcigkaHR0cCwgdG9hc3RyKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuICAgICAgICB2YXIgaHViID0gJC5jb25uZWN0aW9uLm5hbWVOb3RpZmljYXRpb25IdWI7XHJcblxyXG4gICAgICAgICRjdHJsLiRvbkluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjb25maWd1cmF0aW9uIHNldHRpbmcgaW5pdCcpO1xyXG4gICAgICAgICAgICAkLmNvbm5lY3Rpb24uaHViLnN0YXJ0KCkuZG9uZShmdW5jdGlvbigpeyBjb25zb2xlLmxvZygnaHViIGNvbm5lY3Rpb24gc3RhcnRlZCcpOyB9KTtcclxuICAgICAgICAgICAgJGh0dHAuZ2V0KCdhcGkvY29uZmlndXJhdGlvbicpLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgICRjdHJsLmNvbmZpZ3VyYXRpb24gPSByLmRhdGE7XHJcbiAgICAgICAgICAgICAgICB0b2FzdHIuc3VjY2VzcygnTG9hZGVkIGNvbmZpZ3VyYXRpb24nKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5jYW5jZWwgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRjdHJsLmRpc21pc3MoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLnNhdmUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5wb3N0KCdhcGkvY29uZmlndXJhdGlvbicsICRjdHJsLmNvbmZpZ3VyYXRpb24pLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKCRjdHJsLmNvbmZpZ3VyYXRpb24sIHIuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICB0b2FzdHIuc3VjY2VzcygnQ29uZmlndXJhdGlvbiBTYXZlZCcpO1xyXG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdzb21ldGhpbmcgd2VudCB3cm9uZycsIGVyci5tZXNzYWdlKTtcclxuICAgICAgICAgICAgICAgIHRvYXN0ci5lcnJvcignRXJyb3IgU2F2aW5nIENvbmZpZ3VyYXRpb24nKTtcclxuICAgICAgICAgICAgfSkuZmluYWxseShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICBodWIuc2VydmVyLmNvbmZpZ3VyYXRpb25DaGFuZ2UoJGN0cmwuY29uZmlndXJhdGlvbikudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdjb25maWd1cmF0aW9uIHNlbnQgdG8gaHViJyk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG5cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbW9kdWxlLmNvbXBvbmVudCgnY29uZmlndXJhdGlvblNldHRpbmcnLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvY29uZmlndXJhdGlvbi9jb25maWd1cmF0aW9uLXNldHRpbmcuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiBbJyRodHRwJywgJ3RvYXN0cicsIGNvbnRyb2xsZXJdXHJcbiAgICAgICAgfSk7XHJcbn1cclxuKSgpOyIsIi8vZGFzaGJvYXJkLmNvbXBvbmVudC5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnKTtcclxuXHJcbiAgICBmdW5jdGlvbiBjb250cm9sbGVyKCRodHRwKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ2Rhc2hib2FyZCBpbml0Jyk7XHJcbiAgICAgICAgICAgICRjdHJsLnJlZnJlc2goKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLnJlZnJlc2ggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRjdHJsLmxvYWRpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICAkaHR0cC5nZXQoJ2FwaS92aXNpdG9yL3N1bW1hcnknKS50aGVuKGZ1bmN0aW9uIChyKSB7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5zdW1tYXJ5ID0gci5kYXRhO1xyXG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdzb21ldGhpbmcgd2VudCB3cm9uZycsIGVycik7XHJcbiAgICAgICAgICAgIH0pLmZpbmFsbHkoZnVuY3Rpb24gKGUpIHtcclxuICAgICAgICAgICAgICAgICRjdHJsLmxvYWRpbmcgPSBmYWxzZTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ2Rhc2hib2FyZCcsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9kYXNoYm9hcmQvZGFzaGJvYXJkLmNvbXBvbmVudC5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogWyckaHR0cCcsIGNvbnRyb2xsZXJdXHJcbiAgICAgICAgfSk7XHJcblxyXG59XHJcbikoKTsiLCIvL2RpcmVjdGl2ZXMubW9kdWxlcy5qc1xyXG4oZnVuY3Rpb24oKSB7XHJcbiAgICBhbmd1bGFyLm1vZHVsZSgnYXBwLmRpcmVjdGl2ZXMnLCBbXSk7IFxyXG59KSgpOyIsIi8vc3RUYWJsZS5kaXJlY3RpdmUuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuXHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcC5kaXJlY3RpdmVzJyk7XHJcblxyXG4gICAgbW9kdWxlLmRpcmVjdGl2ZSgnc3RTdWJtaXRTZWFyY2gnLCBbJ3N0Q29uZmlnJywgJyR0aW1lb3V0JywgJyRwYXJzZScsIGZ1bmN0aW9uIChzdENvbmZpZywgJHRpbWVvdXQsICRwYXJzZSkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJlcXVpcmU6ICdec3RUYWJsZScsXHJcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0ciwgY3RybCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQuYmluZCgnY2xpY2snLFxyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhYmxlQ3RybCA9IGN0cmw7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlQ3RybC5waXBlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH1dKTtcclxuXHJcbiAgICBtb2R1bGUuZGlyZWN0aXZlKFwiY2xlYXJLZXlcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRUEnLFxyXG4gICAgICAgICAgICByZXF1aXJlOiAnbmdNb2RlbCcsXHJcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWwsIGF0dHJzLCBjdHJsKSB7XHJcbiAgICAgICAgICAgICAgICBlbC5vbigna2V5ZG93bicsIGZ1bmN0aW9uIChldmVudCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChldmVudC53aGljaCAhPT0gMjcpIHsgcmV0dXJuOyB9IC8vIGNoZWNrIGtleSBob3cgeW91IHdhbnRcclxuICAgICAgICAgICAgICAgICAgICBjdHJsLiRzZXRWaWV3VmFsdWUobnVsbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgY3RybC4kcmVuZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgc2NvcGUuJGFwcGx5KCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9KTtcclxuXHJcblxyXG4gICAgbW9kdWxlLmRpcmVjdGl2ZShcInN0UmVzZXRTZWFyY2hcIixcclxuICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICByZXN0cmljdDogJ0VBJyxcclxuICAgICAgICAgICAgICAgICAgICByZXF1aXJlOiBbJ15zdFRhYmxlJywgJ15uZ01vZGVsJ10sXHJcbiAgICAgICAgICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRycywgY3RybHMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGVsZW1lbnQuYmluZCgnY2xpY2snLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBtb2RlbCA9IGN0cmxzWzFdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjdHJsID0gY3RybHNbMF07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2gobW9kZWwuJHZpZXdWYWx1ZSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICh2YWx1ZSwga2V5KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGtleS50b0xvd2VyQ2FzZSgpID09PSAncGFnZScpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWwuJHZpZXdWYWx1ZVtrZXldID0gMTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpIHx8IF8uaW5jbHVkZXMoa2V5LnRvTG93ZXJDYXNlKCksICdwYWdlJykpIHJldHVybjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtb2RlbC4kdmlld1ZhbHVlW2tleV0gPSBudWxsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YWJsZVN0YXRlID0gY3RybC50YWJsZVN0YXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRhYmxlU3RhdGUuc2VhcmNoLnByZWRpY2F0ZU9iamVjdCA9IHt9O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZVN0YXRlLnBhZ2luYXRpb24uc3RhcnQgPSAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3RybC5waXBlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgICAgICB9KTtcclxuXHJcbiAgICBtb2R1bGUuZGlyZWN0aXZlKFwic3RDbGVhcktleVwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVzdHJpY3Q6ICdFQScsXHJcbiAgICAgICAgICAgIHJlcXVpcmU6IFsnXnN0VGFibGUnLCAnXm5nTW9kZWwnXSxcclxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRycywgY3RybHMpIHtcclxuICAgICAgICAgICAgICAgIGVsZW1lbnQub24oJ2tleWRvd24nLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgbmdNb2RlbCA9IGN0cmxzWzFdO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjdHJsID0gY3RybHNbMF07XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmIChldmVudC53aGljaCA9PT0gMTMpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGN0cmwucGlwZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQud2hpY2ggPT09IDI3KSB7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoZWxlbWVudC5jb250ZXh0LmF0dHJpYnV0ZXNbJ3N0LXNlYXJjaCddICE9PSB1bmRlZmluZWQpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBmaWVsZE5hbWUgPSBlbGVtZW50LmNvbnRleHQuYXR0cmlidXRlc1snc3Qtc2VhcmNoJ10udmFsdWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHRhYmxlU3RhdGUgPSBjdHJsLnRhYmxlU3RhdGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZVN0YXRlLnNlYXJjaC5wcmVkaWNhdGVPYmplY3RbZmllbGROYW1lXSA9ICcnO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjdHJsLnBpcGUoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBzY29wZS4kYXBwbHkoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5nTW9kZWwuJHNldFZpZXdWYWx1ZShudWxsKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZ01vZGVsLiRyZW5kZXIoKTsgLy8gd2lsbCB1cGRhdGUgdGhlIGlucHV0IHZhbHVlIGFzIHdlbGxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuICAgIH0pO1xyXG5cclxufVxyXG4pKCk7IiwiLy9maWx0ZXJzLmpzXHJcbihmdW5jdGlvbigpIHtcclxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAnKS5maWx0ZXIoJ3BlcmNlbnRhZ2UnLCBbJyRmaWx0ZXInLCBmdW5jdGlvbiAoJGZpbHRlcikge1xyXG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoaW5wdXQsIGRlY2ltYWxzKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkZmlsdGVyKCdudW1iZXInKShpbnB1dCAqIDEwMCwgZGVjaW1hbHMpICsgJyUnO1xyXG4gICAgICAgIH07XHJcbiAgICB9XSk7XHJcbiAgICB9XHJcbikoKTsiLCIvL3VzZXItZWRpdC5jb21wb25lbnQuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7XHJcblxyXG4gICAgZnVuY3Rpb24gY29udHJvbGxlcigkaHR0cCkge1xyXG4gICAgICAgIHZhciAkY3RybCA9IHRoaXM7XHJcblxyXG4gICAgICAgICRjdHJsLiRvbkluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCd1c2VyIGVkaXQgaW5pdCcpO1xyXG4gICAgICAgICAgICBpZiAoJGN0cmwucmVzb2x2ZSkge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwudXNlciA9ICRjdHJsLnJlc29sdmUudXNlcjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAkaHR0cC5nZXQoJ2FwaS91c2VyL3JvbGVzJykudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwucm9sZXMgPSByLmRhdGE7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuY2FuY2VsID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkY3RybC5kaXNtaXNzKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5zYXZlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBpZiAoISRjdHJsLnVzZXIuZW1haWwpICRjdHJsLnVzZXIuZW1haWwgPSAkY3RybC51c2VyLnVzZXJOYW1lICsgJ0BzcGxjZW50ZXIub3JnJztcclxuXHJcbiAgICAgICAgICAgIHZhciByb2xlcyA9IFtdO1xyXG4gICAgICAgICAgICBfLmZvckVhY2goJGN0cmwudXNlci5yb2xlcyxcclxuICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChyb2xlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcm9sZXMucHVzaChyb2xlLm5hbWUpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIGlmIChyb2xlcy5sZW5ndGggPT09IDApIHJvbGVzLnB1c2goJ3VzZXInKTtcclxuICAgICAgICAgICAgJGN0cmwudXNlci5yb2xlcyA9IHJvbGVzO1xyXG5cclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLnBvc3QoJ2FwaS91c2VyL3VwZGF0ZScsICRjdHJsLnVzZXIpLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZXh0ZW5kKCRjdHJsLnVzZXIsIHIuZGF0YSk7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5tb2RhbEluc3RhbmNlLmNsb3NlKCRjdHJsLnVzZXIpO1xyXG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdzb21ldGhpbmcgd2VudCB3cm9uZycsIGVyci5tZXNzYWdlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb2R1bGUuY29tcG9uZW50KCd1c2VyRWRpdCcsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiaW5kaW5nczoge1xyXG4gICAgICAgICAgICAgICAgaXRlbTogJzwnLFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZTogJzwnLFxyXG4gICAgICAgICAgICAgICAgY2xvc2U6ICcmJyxcclxuICAgICAgICAgICAgICAgIGRpc21pc3M6ICcmJyxcclxuICAgICAgICAgICAgICAgIG1vZGFsSW5zdGFuY2U6ICc8J1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC91c2Vycy91c2VyLWVkaXQuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiBbJyRodHRwJywgY29udHJvbGxlcl1cclxuICAgICAgICB9KTtcclxuXHJcbn1cclxuKSgpOyIsIi8vdXNlci1saXN0LmNvbXBvbmVudC5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnKTtcclxuXHJcbiAgICBmdW5jdGlvbiBjb250cm9sbGVyKCRodHRwLCAkbW9kYWwsIHRvYXN0cikge1xyXG4gICAgICAgIHZhciAkY3RybCA9IHRoaXM7XHJcblxyXG4gICAgICAgICRjdHJsLiRvbkluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRjdHJsLnRpdGxlID0gJ1VzZXJzJztcclxuICAgICAgICAgICAgJGh0dHAuZ2V0KCdhcGkvdXNlcicpLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgICRjdHJsLnVzZXJzID0gci5kYXRhO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmNyZWF0ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgLy9UT0RPOiByZXR1cm4gcm9sZXMgZGlzcGxheSBicm9rZW5cclxuICAgICAgICAgICAgJG1vZGFsLm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50OiAndXNlckVkaXQnLFxyXG4gICAgICAgICAgICAgICAgYmluZGluZ3M6IHsgbW9kYWxJbnN0YW5jZTogXCI8XCIgfSxcclxuICAgICAgICAgICAgICAgIHNpemU6ICdtZCdcclxuICAgICAgICAgICAgfSkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHVzZXIgPSByZXN1bHQ7IFxyXG4gICAgICAgICAgICAgICAgdmFyIHJvbGVzID0gW107XHJcbiAgICAgICAgICAgICAgICBfLmZvckVhY2gocmVzdWx0LnJvbGVzLFxyXG4gICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uIChyb2xlKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdyb2xlJywgcm9sZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvbGVzLnB1c2gocm9sZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICB1c2VyLnJvbGVzID0gW107IFxyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3Jlc3VsdCcsIHVzZXIpO1xyXG4gICAgICAgICAgICAgICAgdXNlci5yb2xlcyA9IFtdID0gcm9sZXM7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncm9sZXMnLCByb2xlcyk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncmVzdWx0JywgdXNlcik7XHJcbiAgICAgICAgICAgICAgICAkY3RybC51c2Vycy51bnNoaWZ0KHVzZXIpO1xyXG4gICAgICAgICAgICAgICAgdG9hc3RyLnN1Y2Nlc3MoJ0NyZWF0ZWQgVXNlcicpO1xyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuZWRpdCA9IGZ1bmN0aW9uIChpdGVtKSB7XHJcbiAgICAgICAgICAgICRtb2RhbC5vcGVuKHtcclxuICAgICAgICAgICAgICAgIGNvbXBvbmVudDogJ3VzZXJFZGl0JyxcclxuICAgICAgICAgICAgICAgIGJpbmRpbmdzOiB7IG1vZGFsSW5zdGFuY2U6IFwiPFwiIH0sXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7IHVzZXI6IGFuZ3VsYXIuY29weShpdGVtKSB9LFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogJ21kJ1xyXG4gICAgICAgICAgICB9KS5yZXN1bHQudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmV4dGVuZChpdGVtLCByZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgdG9hc3RyLnN1Y2Nlc3MoJ1VwZGF0ZWQgVXNlcicpO1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKHJlYXNvbikgeyB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmRlbGV0ZSA9IGZ1bmN0aW9uIChjKSB7XHJcbiAgICAgICAgICAgICRodHRwLmRlbGV0ZSgnYXBpL3VzZXIvJyArIGMuaWQpLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBpZHggPSAkY3RybC51c2Vycy5pbmRleE9mKGMpO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwudXNlcnMuc3BsaWNlKGlkeCwgMSk7XHJcbiAgICAgICAgICAgICAgICB0b2FzdHIud2FybmluZygnRGVsZXRlZCBVc2VyJyk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW9kdWxlLmNvbXBvbmVudCgndXNlckxpc3QnLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvdXNlcnMvdXNlci1saXN0LmNvbXBvbmVudC5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogWyckaHR0cCcsICckdWliTW9kYWwnLCAndG9hc3RyJywgY29udHJvbGxlcl1cclxuICAgICAgICB9KTtcclxuXHJcbn1cclxuKSgpOyIsIi8vdmlzaXRvci1lZGl0LmNvbXBvbmVudC5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnKTtcclxuXHJcbiAgICBmdW5jdGlvbiBjb250cm9sbGVyKCRodHRwKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3Zpc2l0b3IgZWRpdCBpbml0Jyk7XHJcblxyXG4gICAgICAgICAgICAkY3RybC50aXRsZSA9ICdOZXcgVmlzaXRvcic7XHJcblxyXG4gICAgICAgICAgICBpZiAoJGN0cmwucmVzb2x2ZSkge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuaWQgPSAkY3RybC5yZXNvbHZlLmlkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICgkY3RybC5pZCkge1xyXG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KCdhcGkvdmlzaXRvci8nICsgJGN0cmwuaWQpLnRoZW4oZnVuY3Rpb24ocikge1xyXG4gICAgICAgICAgICAgICAgICAgICRjdHJsLnZpc2l0b3IgPSByLmRhdGE7XHJcbiAgICAgICAgICAgICAgICAgICAgJGN0cmwudGl0bGUgPSAoJGN0cmwudmlzaXRvci5maXJzdG5hbWUgKyAnICcgKyAkY3RybC52aXNpdG9yLmxhc3RuYW1lKTtcclxuICAgICAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnInLCBlcnIubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfSBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJGN0cmwuZGlzbWlzcygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuc2F2ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3NhdmUgdmlzaXRvcicsICRjdHJsLnZpc2l0b3IpO1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnYXBpL3Zpc2l0b3InLCAkY3RybC52aXNpdG9yKS50aGVuKGZ1bmN0aW9uIChyKSB7XHJcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmV4dGVuZCgkY3RybC52aXNpdG9yLCByLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwubW9kYWxJbnN0YW5jZS5jbG9zZSgkY3RybC52aXNpdG9yKTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignc29tZXRoaW5nIHdlbnQgd3JvbmcnLCBlcnIubWVzc2FnZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ3Zpc2l0b3JFZGl0JyxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJpbmRpbmdzOiB7XHJcbiAgICAgICAgICAgICAgICBpdGVtOiAnPCcsXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiAnPCcsXHJcbiAgICAgICAgICAgICAgICBjbG9zZTogJyYnLFxyXG4gICAgICAgICAgICAgICAgZGlzbWlzczogJyYnLFxyXG4gICAgICAgICAgICAgICAgbW9kYWxJbnN0YW5jZTogJzwnXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL3Zpc2l0b3JzL3Zpc2l0b3ItZWRpdC5jb21wb25lbnQuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJGh0dHAnLCBjb250cm9sbGVyXVxyXG4gICAgICAgIH0pO1xyXG59XHJcbikoKTsiLCIvL3Zpc2l0b3ItbGlzdC5jb21wb25lbnQuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7XHJcblxyXG4gICAgZnVuY3Rpb24gY29udHJvbGxlcigkaHR0cCwgJG1vZGFsLCB0b2FzdHIpIHtcclxuICAgICAgICB2YXIgJGN0cmwgPSB0aGlzOyBcclxuICAgICAgICB2YXIgcGFnZVNpemVEZWZhdWx0ID0gMTA7XHJcbiAgICAgICAgdmFyIHRhYmxlU3RhdGVSZWY7XHJcblxyXG4gICAgICAgICRjdHJsLnNlYXJjaE1vZGVsID0ge1xyXG4gICAgICAgICAgICBwYWdlOiAxLFxyXG4gICAgICAgICAgICBwYWdlU2l6ZTogcGFnZVNpemVEZWZhdWx0XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnaW5pdCB2aXNpdG9yIGxpc3QnKTtcclxuICAgICAgICAgICAgJGN0cmwudGl0bGUgPSAnVmlzaXRvcnMnO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuY3JlYXRlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkbW9kYWwub3Blbih7XHJcbiAgICAgICAgICAgICAgICBjb21wb25lbnQ6ICd2aXNpdG9yRWRpdCcsXHJcbiAgICAgICAgICAgICAgICBiaW5kaW5nczoge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGFsSW5zdGFuY2U6IFwiPFwiXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHNpemU6ICdtZCdcclxuICAgICAgICAgICAgfSkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwudmlzaXRvcnMudW5zaGlmdChyZXN1bHQpO1xyXG4gICAgICAgICAgICAgICAgdG9hc3RyLnN1Y2Nlc3MoJ0NyZWF0ZWQgVmlzaXRvcicpO1xyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuZWRpdCA9IGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgJG1vZGFsLm9wZW4oe1xyXG4gICAgICAgICAgICAgICAgY29tcG9uZW50OiAndmlzaXRvckVkaXQnLFxyXG4gICAgICAgICAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgICAgICAgICBtb2RhbEluc3RhbmNlOiBcIjxcIlxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHJlc29sdmU6IHtcclxuICAgICAgICAgICAgICAgICAgICBpZDogdi5pZFxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIHNpemU6ICdtZCdcclxuICAgICAgICAgICAgfSkucmVzdWx0LnRoZW4oZnVuY3Rpb24gKHJlc3VsdCkge1xyXG4gICAgICAgICAgICAgICAgYW5ndWxhci5leHRlbmQodiwgcmVzdWx0KTtcclxuICAgICAgICAgICAgICAgIHRvYXN0ci5zdWNjZXNzKCdVcGRhdGVkIFZpc2l0b3InKTtcclxuICAgICAgICAgICAgfSwgZnVuY3Rpb24gKHJlYXNvbikge1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmRlbGV0ZSA9IGZ1bmN0aW9uKHYpIHtcclxuICAgICAgICAgICAgJGh0dHAuZGVsZXRlKCdhcGkvdmlzaXRvci8nICsgdi5pZCkudGhlbihmdW5jdGlvbihyKSB7XHJcbiAgICAgICAgICAgICAgICB2YXIgaWR4ID0gJGN0cmwudmlzaXRvcnMuaW5kZXhPZih2KTtcclxuICAgICAgICAgICAgICAgICRjdHJsLnZpc2l0b3JzLnNwbGljZShpZHgsIDEpO1xyXG4gICAgICAgICAgICAgICAgdG9hc3RyLndhcm5pbmcoJ0RlbGV0ZWQgVmlzaXRvcicpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLnNlYXJjaCA9IGZ1bmN0aW9uICh0YWJsZVN0YXRlKSB7XHJcbiAgICAgICAgICAgICRjdHJsLmxvYWRpbmcgPSB0cnVlOyBcclxuICAgICAgICAgICAgdGFibGVTdGF0ZVJlZiA9IHRhYmxlU3RhdGU7XHJcbiAgICAgICAgICAgICRjdHJsLnNlYXJjaE1vZGVsLmZ1enp5TWF0Y2hSYW5nZSA9ICRjdHJsLmZ1enp5TWF0Y2hSYW5nZTsgXHJcbiAgICAgICAgICAgICRjdHJsLnNlYXJjaE1vZGVsLmRheXNPbGQgPSAkY3RybC5kYXlzO1xyXG5cclxuICAgICAgICAgICAgaWYgKHR5cGVvZiAodGFibGVTdGF0ZS5zb3J0LnByZWRpY2F0ZSkgIT09IFwidW5kZWZpbmVkXCIpIHtcclxuICAgICAgICAgICAgICAgICRjdHJsLnNlYXJjaE1vZGVsLm9yZGVyQnkgPSB0YWJsZVN0YXRlLnNvcnQucHJlZGljYXRlO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuc2VhcmNoTW9kZWwub3JkZXJEaXJlY3Rpb24gPSB0YWJsZVN0YXRlLnNvcnQucmV2ZXJzZSA/ICdkZXNjJyA6ICdhc2MnO1xyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAkaHR0cC5nZXQoJ2FwaS92aXNpdG9yJywgeyBwYXJhbXM6ICRjdHJsLnNlYXJjaE1vZGVsIH0pLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgICRjdHJsLnZpc2l0b3JzID0gci5kYXRhLnJlc3VsdHM7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5zZWFyY2hNb2RlbCA9IHIuZGF0YTtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZSAkY3RybC5zZWFyY2hNb2RlbC5yZXN1bHRzO1xyXG4gICAgICAgICAgICB9KS5maW5hbGx5KGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwubG9hZGluZyA9IGZhbHNlOyBcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5wYWdlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJGN0cmwuc2VhcmNoKHRhYmxlU3RhdGVSZWYpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW9kdWxlLmNvbXBvbmVudCgndmlzaXRvckxpc3QnLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvdmlzaXRvcnMvdmlzaXRvci1saXN0LmNvbXBvbmVudC5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogWyckaHR0cCcsICckdWliTW9kYWwnLCAndG9hc3RyJywgY29udHJvbGxlcl1cclxuICAgICAgICB9KTtcclxufVxyXG4pKCk7Il19
