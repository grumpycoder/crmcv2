!function(){angular.module("app",["app.directives","ui.bootstrap","smart-table"])}();
!function(){angular.module("app.directives",[])}();
!function(){var e=angular.module("app.directives");e.directive("stSubmitSearch",["stConfig","$timeout","$parse",function(e,t,r){return{require:"^stTable",link:function(e,t,r,n){return t.bind("click",function(){console.log("search");var e=n;e.pipe()})}}}]),e.directive("clearKey",function(){return{restrict:"EA",require:"ngModel",link:function(e,t,r,n){t.on("keydown",function(t){27===t.which&&(n.$setViewValue(null),n.$render(),e.$apply())})}}}),e.directive("stResetSearch",function(){return{restrict:"EA",require:["^stTable","^ngModel"],link:function(e,t,r,n){return t.bind("click",function(){var t=n[1],r=n[0];return e.$apply(function(){angular.forEach(t.$viewValue,function(e,r){"page"===r.toLowerCase()&&(t.$viewValue[r]=1),Array.isArray(e)||_.includes(r.toLowerCase(),"page")||(t.$viewValue[r]=null)});var e=r.tableState();return e.search.predicateObject={},e.pagination.start=0,r.pipe()})})}}}),e.directive("stClearKey",function(){return{restrict:"EA",require:["^stTable","^ngModel"],link:function(e,t,r,n){t.on("keydown",function(r){var i=n[1],a=n[0];return 13===r.which?a.pipe():27===r.which?void 0!==t.context.attributes["st-search"]?e.$apply(function(){var e=t.context.attributes["st-search"].value,r=a.tableState();return r.search.predicateObject[e]="",a.pipe()}):e.$apply(function(){i.$setViewValue(null),i.$render()}):void 0})}}})}();
!function(){function i(i){var o=this;o.$onInit=function(){console.log("visitor edit init"),o.resolve&&(o.id=o.resolve.id),o.id&&i.get("api/visitor/"+o.id).then(function(i){o.visitor=i.data}).catch(function(i){console.log("err",i.message)})},o.cancel=function(){o.dismiss()},o.save=function(){return console.log("save visitor",o.visitor),i.post("api/visitor",o.visitor).then(function(i){angular.extend(o.visitor,i.data),o.modalInstance.close(o.visitor)}).catch(function(i){console.error("something went wrong",i.message)})}}var o=angular.module("app");o.component("visitorEdit",{bindings:{item:"<",resolve:"<",close:"&",dismiss:"&",modalInstance:"<"},templateUrl:"app/visitors/visitor-edit.component.html",controller:["$http",i]})}();
!function(){function i(i,t){var n,e=this,o=10;e.searchModel={page:1,pageSize:o},e.$onInit=function(){console.log("init visitor list")},e.create=function(){t.open({component:"visitorEdit",bindings:{modalInstance:"<"},resolve:{},size:"md"}).result.then(function(i){e.visitors.unshift(i)},function(i){})},e.edit=function(i){t.open({component:"visitorEdit",bindings:{modalInstance:"<"},resolve:{id:i.id},size:"md"}).result.then(function(t){angular.extend(i,t)},function(i){})},e.delete=function(t){i.delete("api/visitor/"+t.id).then(function(i){var n=e.visitors.indexOf(t);e.visitors.splice(n,1)})},e.search=function(t){n=t,i.get("api/visitor",{params:e.searchModel}).then(function(i){e.visitors=i.data.results,e.searchModel=i.data,delete e.searchModel.results})},e.paged=function(){e.search(n)}}var t=angular.module("app");t.component("visitorList",{templateUrl:"app/visitors/visitor-list.component.html",controller:["$http","$uibModal",i]})}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJkaXJlY3RpdmVzL2RpcmVjdGl2ZXMubW9kdWxlcy5qcyIsImRpcmVjdGl2ZXMvc3RUYWJsZS5kaXJlY3RpdmUuanMiLCJ2aXNpdG9ycy92aXNpdG9yLWVkaXQuY29tcG9uZW50LmpzIiwidmlzaXRvcnMvdmlzaXRvci1saXN0LmNvbXBvbmVudC5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiZGlyZWN0aXZlIiwic3RDb25maWciLCIkdGltZW91dCIsIiRwYXJzZSIsInJlcXVpcmUiLCJsaW5rIiwic2NvcGUiLCJlbGVtZW50IiwiYXR0ciIsImN0cmwiLCJiaW5kIiwiY29uc29sZSIsImxvZyIsInRhYmxlQ3RybCIsInBpcGUiLCJyZXN0cmljdCIsImVsIiwiYXR0cnMiLCJvbiIsImV2ZW50Iiwid2hpY2giLCIkc2V0Vmlld1ZhbHVlIiwiJHJlbmRlciIsIiRhcHBseSIsImN0cmxzIiwibW9kZWwiLCJmb3JFYWNoIiwiJHZpZXdWYWx1ZSIsInZhbHVlIiwia2V5IiwidG9Mb3dlckNhc2UiLCJBcnJheSIsImlzQXJyYXkiLCJfIiwiaW5jbHVkZXMiLCJ0YWJsZVN0YXRlIiwic2VhcmNoIiwicHJlZGljYXRlT2JqZWN0IiwicGFnaW5hdGlvbiIsInN0YXJ0IiwibmdNb2RlbCIsInVuZGVmaW5lZCIsImNvbnRleHQiLCJhdHRyaWJ1dGVzIiwiZmllbGROYW1lIiwiY29udHJvbGxlciIsIiRodHRwIiwiJGN0cmwiLCJ0aGlzIiwiJG9uSW5pdCIsInJlc29sdmUiLCJpZCIsImdldCIsInRoZW4iLCJyIiwidmlzaXRvciIsImRhdGEiLCJjYXRjaCIsImVyciIsIm1lc3NhZ2UiLCJjYW5jZWwiLCJkaXNtaXNzIiwic2F2ZSIsInBvc3QiLCJleHRlbmQiLCJtb2RhbEluc3RhbmNlIiwiY2xvc2UiLCJlcnJvciIsImNvbXBvbmVudCIsImJpbmRpbmdzIiwiaXRlbSIsInRlbXBsYXRlVXJsIiwiJG1vZGFsIiwidGFibGVTdGF0ZVJlZiIsInBhZ2VTaXplRGVmYXVsdCIsInNlYXJjaE1vZGVsIiwicGFnZSIsInBhZ2VTaXplIiwiY3JlYXRlIiwib3BlbiIsInNpemUiLCJyZXN1bHQiLCJ2aXNpdG9ycyIsInVuc2hpZnQiLCJyZWFzb24iLCJlZGl0IiwidiIsImRlbGV0ZSIsImlkeCIsImluZGV4T2YiLCJzcGxpY2UiLCJwYXJhbXMiLCJyZXN1bHRzIiwicGFnZWQiXSwibWFwcGluZ3MiOiJDQUNBLFdBQ2lCQSxRQUFRQyxPQUFPLE9BQVEsaUJBQWtCLGVBQWdCO0NDRDFFLFdBQ0lELFFBQVFDLE9BQU87Q0NEbkIsV0FFSSxHQUFJQSxHQUFTRCxRQUFRQyxPQUFPLGlCQUU1QkEsR0FBT0MsVUFBVSxrQkFBbUIsV0FBWSxXQUFZLFNBQVUsU0FBVUMsRUFBVUMsRUFBVUMsR0FDaEcsT0FDSUMsUUFBUyxXQUNUQyxLQUFNLFNBQVVDLEVBQU9DLEVBQVNDLEVBQU1DLEdBQ2xDLE1BQU9GLEdBQVFHLEtBQUssUUFDaEIsV0FDSUMsUUFBUUMsSUFBSSxTQUNaLElBQUlDLEdBQVlKLENBQ2hCSSxHQUFVQyxjQU85QmYsRUFBT0MsVUFBVSxXQUFZLFdBQ3pCLE9BQ0llLFNBQVUsS0FDVlgsUUFBUyxVQUNUQyxLQUFNLFNBQVVDLEVBQU9VLEVBQUlDLEVBQU9SLEdBQzlCTyxFQUFHRSxHQUFHLFVBQVcsU0FBVUMsR0FDSCxLQUFoQkEsRUFBTUMsUUFDVlgsRUFBS1ksY0FBYyxNQUNuQlosRUFBS2EsVUFDTGhCLEVBQU1pQixnQkFPdEJ4QixFQUFPQyxVQUFVLGdCQUNULFdBQ0ksT0FDSWUsU0FBVSxLQUNWWCxTQUFVLFdBQVksWUFDdEJDLEtBQU0sU0FBVUMsRUFBT0MsRUFBU1UsRUFBT08sR0FDbkMsTUFBT2pCLEdBQVFHLEtBQUssUUFDaEIsV0FDSSxHQUFJZSxHQUFRRCxFQUFNLEdBQ2RmLEVBQU9lLEVBQU0sRUFFakIsT0FBT2xCLEdBQU1pQixPQUFPLFdBQ2hCekIsUUFBUTRCLFFBQVFELEVBQU1FLFdBQ2xCLFNBQVVDLEVBQU9DLEdB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RUFBTXlDLE9BQU8sZUFBaUJELEVBQUVuQyxJQUFJRSxLQUFLLFNBQVNDLEdBQzlDLEdBQUlrQyxHQUFNekMsRUFBTW1DLFNBQVNPLFFBQVFILEVBQ2pDdkMsR0FBTW1DLFNBQVNRLE9BQU9GLEVBQUssTUFJbkN6QyxFQUFNWCxPQUFTLFNBQVVELEdBQ3JCc0MsRUFBZ0J0QyxFQUNoQlcsRUFBTU0sSUFBSSxlQUFpQnVDLE9BQVE1QyxFQUFNNEIsY0FBZXRCLEtBQUssU0FBVUMsR0FDbkVQLEVBQU1tQyxTQUFXNUIsRUFBRUUsS0FBS29DLFFBQ3hCN0MsRUFBTTRCLFlBQWNyQixFQUFFRSxXQUNmVCxHQUFNNEIsWUFBWWlCLFdBSWpDN0MsRUFBTThDLE1BQVEsV0FDVjlDLEVBQU1YLE9BQU9xQyxJQWhFckIsR0FBSTFFLEdBQVNELFFBQVFDLE9BQU8sTUFxRTVCQSxHQUFPcUUsVUFBVSxlQUVURyxZQUFhLDJDQUNiMUIsWUFBYSxRQUFTLFlBQWFBIiwiZmlsZSI6ImFwcC5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIvL2FwcC5tb2R1bGUuanNcclxuKGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbJ2FwcC5kaXJlY3RpdmVzJywgJ3VpLmJvb3RzdHJhcCcsICdzbWFydC10YWJsZSddKTtcclxuICAgIH1cclxuKSgpOyIsIi8vZGlyZWN0aXZlcy5tb2R1bGVzLmpzXHJcbihmdW5jdGlvbigpIHtcclxuICAgIGFuZ3VsYXIubW9kdWxlKCdhcHAuZGlyZWN0aXZlcycsIFtdKTsgXHJcbn0pKCk7IiwiLy9zdFRhYmxlLmRpcmVjdGl2ZS5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG5cclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwLmRpcmVjdGl2ZXMnKTtcclxuXHJcbiAgICBtb2R1bGUuZGlyZWN0aXZlKCdzdFN1Ym1pdFNlYXJjaCcsIFsnc3RDb25maWcnLCAnJHRpbWVvdXQnLCAnJHBhcnNlJywgZnVuY3Rpb24gKHN0Q29uZmlnLCAkdGltZW91dCwgJHBhcnNlKSB7XHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgcmVxdWlyZTogJ15zdFRhYmxlJyxcclxuICAgICAgICAgICAgbGluazogZnVuY3Rpb24gKHNjb3BlLCBlbGVtZW50LCBhdHRyLCBjdHJsKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZWxlbWVudC5iaW5kKCdjbGljaycsXHJcbiAgICAgICAgICAgICAgICAgICAgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnc2VhcmNoJyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YWJsZUN0cmwgPSBjdHJsO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0YWJsZUN0cmwucGlwZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9XSk7XHJcblxyXG4gICAgbW9kdWxlLmRpcmVjdGl2ZShcImNsZWFyS2V5XCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICByZXN0cmljdDogJ0VBJyxcclxuICAgICAgICAgICAgcmVxdWlyZTogJ25nTW9kZWwnLFxyXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoc2NvcGUsIGVsLCBhdHRycywgY3RybCkge1xyXG4gICAgICAgICAgICAgICAgZWwub24oJ2tleWRvd24nLCBmdW5jdGlvbiAoZXZlbnQpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQud2hpY2ggIT09IDI3KSB7IHJldHVybjsgfSAvLyBjaGVjayBrZXkgaG93IHlvdSB3YW50XHJcbiAgICAgICAgICAgICAgICAgICAgY3RybC4kc2V0Vmlld1ZhbHVlKG51bGwpO1xyXG4gICAgICAgICAgICAgICAgICAgIGN0cmwuJHJlbmRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgIHNjb3BlLiRhcHBseSgpO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG4gICAgfSk7XHJcblxyXG5cclxuICAgIG1vZHVsZS5kaXJlY3RpdmUoXCJzdFJlc2V0U2VhcmNoXCIsXHJcbiAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmVzdHJpY3Q6ICdFQScsXHJcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZTogWydec3RUYWJsZScsICdebmdNb2RlbCddLFxyXG4gICAgICAgICAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cnMsIGN0cmxzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBlbGVtZW50LmJpbmQoJ2NsaWNrJyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgbW9kZWwgPSBjdHJsc1sxXTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgY3RybCA9IGN0cmxzWzBdO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKG1vZGVsLiR2aWV3VmFsdWUsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmdW5jdGlvbiAodmFsdWUsIGtleSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChrZXkudG9Mb3dlckNhc2UoKSA9PT0gJ3BhZ2UnKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1vZGVsLiR2aWV3VmFsdWVba2V5XSA9IDE7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChBcnJheS5pc0FycmF5KHZhbHVlKSB8fCBfLmluY2x1ZGVzKGtleS50b0xvd2VyQ2FzZSgpLCAncGFnZScpKSByZXR1cm47XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbW9kZWwuJHZpZXdWYWx1ZVtrZXldID0gbnVsbDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgdGFibGVTdGF0ZSA9IGN0cmwudGFibGVTdGF0ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB0YWJsZVN0YXRlLnNlYXJjaC5wcmVkaWNhdGVPYmplY3QgPSB7fTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVTdGF0ZS5wYWdpbmF0aW9uLnN0YXJ0ID0gMDtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGN0cmwucGlwZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgbW9kdWxlLmRpcmVjdGl2ZShcInN0Q2xlYXJLZXlcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRUEnLFxyXG4gICAgICAgICAgICByZXF1aXJlOiBbJ15zdFRhYmxlJywgJ15uZ01vZGVsJ10sXHJcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxlbWVudCwgYXR0cnMsIGN0cmxzKSB7XHJcbiAgICAgICAgICAgICAgICBlbGVtZW50Lm9uKCdrZXlkb3duJywgZnVuY3Rpb24gKGV2ZW50KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIG5nTW9kZWwgPSBjdHJsc1sxXTtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgY3RybCA9IGN0cmxzWzBdO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnQud2hpY2ggPT09IDEzKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBjdHJsLnBpcGUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGV2ZW50LndoaWNoID09PSAyNykge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGVsZW1lbnQuY29udGV4dC5hdHRyaWJ1dGVzWydzdC1zZWFyY2gnXSAhPT0gdW5kZWZpbmVkKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZmllbGROYW1lID0gZWxlbWVudC5jb250ZXh0LmF0dHJpYnV0ZXNbJ3N0LXNlYXJjaCddLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciB0YWJsZVN0YXRlID0gY3RybC50YWJsZVN0YXRlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGFibGVTdGF0ZS5zZWFyY2gucHJlZGljYXRlT2JqZWN0W2ZpZWxkTmFtZV0gPSAnJztcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gY3RybC5waXBlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gc2NvcGUuJGFwcGx5KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZ01vZGVsLiRzZXRWaWV3VmFsdWUobnVsbCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgbmdNb2RlbC4kcmVuZGVyKCk7IC8vIHdpbGwgdXBkYXRlIHRoZSBpbnB1dCB2YWx1ZSBhcyB3ZWxsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH07XHJcbiAgICB9KTtcclxuXHJcbn1cclxuKSgpOyIsIi8vdmlzaXRvci1lZGl0LmNvbXBvbmVudC5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnKTtcclxuXHJcbiAgICBmdW5jdGlvbiBjb250cm9sbGVyKCRodHRwKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3Zpc2l0b3IgZWRpdCBpbml0Jyk7XHJcblxyXG4gICAgICAgICAgICBpZiAoJGN0cmwucmVzb2x2ZSkge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuaWQgPSAkY3RybC5yZXNvbHZlLmlkO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGlmICgkY3RybC5pZCkge1xyXG4gICAgICAgICAgICAgICAgJGh0dHAuZ2V0KCdhcGkvdmlzaXRvci8nICsgJGN0cmwuaWQpLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgICAgICAkY3RybC52aXNpdG9yID0gci5kYXRhO1xyXG4gICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdlcnInLCBlcnIubWVzc2FnZSk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmNhbmNlbCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJGN0cmwuZGlzbWlzcygpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuc2F2ZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3NhdmUgdmlzaXRvcicsICRjdHJsLnZpc2l0b3IpO1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAucG9zdCgnYXBpL3Zpc2l0b3InLCAkY3RybC52aXNpdG9yKS50aGVuKGZ1bmN0aW9uIChyKSB7XHJcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmV4dGVuZCgkY3RybC52aXNpdG9yLCByLmRhdGEpO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwubW9kYWxJbnN0YW5jZS5jbG9zZSgkY3RybC52aXNpdG9yKTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignc29tZXRoaW5nIHdlbnQgd3JvbmcnLCBlcnIubWVzc2FnZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ3Zpc2l0b3JFZGl0JyxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJpbmRpbmdzOiB7XHJcbiAgICAgICAgICAgICAgICBpdGVtOiAnPCcsXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiAnPCcsXHJcbiAgICAgICAgICAgICAgICBjbG9zZTogJyYnLFxyXG4gICAgICAgICAgICAgICAgZGlzbWlzczogJyYnLFxyXG4gICAgICAgICAgICAgICAgbW9kYWxJbnN0YW5jZTogJzwnXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL3Zpc2l0b3JzL3Zpc2l0b3ItZWRpdC5jb21wb25lbnQuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJGh0dHAnLCBjb250cm9sbGVyXVxyXG4gICAgICAgIH0pO1xyXG59XHJcbikoKTsiLCIvL3Zpc2l0b3ItbGlzdC5jb21wb25lbnQuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7XHJcblxyXG4gICAgZnVuY3Rpb24gY29udHJvbGxlcigkaHR0cCwgJG1vZGFsKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpczsgXHJcbiAgICAgICAgdmFyIHBhZ2VTaXplRGVmYXVsdCA9IDEwO1xyXG4gICAgICAgIHZhciB0YWJsZVN0YXRlUmVmO1xyXG5cclxuICAgICAgICAkY3RybC5zZWFyY2hNb2RlbCA9IHtcclxuICAgICAgICAgICAgcGFnZTogMSxcclxuICAgICAgICAgICAgcGFnZVNpemU6IHBhZ2VTaXplRGVmYXVsdFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRjdHJsLiRvbkluaXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ2luaXQgdmlzaXRvciBsaXN0Jyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5jcmVhdGUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRtb2RhbC5vcGVuKHtcclxuICAgICAgICAgICAgICAgIGNvbXBvbmVudDogJ3Zpc2l0b3JFZGl0JyxcclxuICAgICAgICAgICAgICAgIGJpbmRpbmdzOiB7XHJcbiAgICAgICAgICAgICAgICAgICAgbW9kYWxJbnN0YW5jZTogXCI8XCJcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICByZXNvbHZlOiB7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogJ21kJ1xyXG4gICAgICAgICAgICB9KS5yZXN1bHQudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICAkY3RybC52aXNpdG9ycy51bnNoaWZ0KHJlc3VsdCk7XHJcbiAgICAgICAgICAgIH0sIGZ1bmN0aW9uIChyZWFzb24pIHtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5lZGl0ID0gZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgICAkbW9kYWwub3Blbih7XHJcbiAgICAgICAgICAgICAgICBjb21wb25lbnQ6ICd2aXNpdG9yRWRpdCcsXHJcbiAgICAgICAgICAgICAgICBiaW5kaW5nczoge1xyXG4gICAgICAgICAgICAgICAgICAgIG1vZGFsSW5zdGFuY2U6IFwiPFwiXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgcmVzb2x2ZToge1xyXG4gICAgICAgICAgICAgICAgICAgIGlkOiB2LmlkXHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgc2l6ZTogJ21kJ1xyXG4gICAgICAgICAgICB9KS5yZXN1bHQudGhlbihmdW5jdGlvbiAocmVzdWx0KSB7XHJcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmV4dGVuZCh2LCByZXN1bHQpO1xyXG4gICAgICAgICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuZGVsZXRlID0gZnVuY3Rpb24odikge1xyXG4gICAgICAgICAgICAkaHR0cC5kZWxldGUoJ2FwaS92aXNpdG9yLycgKyB2LmlkKS50aGVuKGZ1bmN0aW9uKHIpIHtcclxuICAgICAgICAgICAgICAgIHZhciBpZHggPSAkY3RybC52aXNpdG9ycy5pbmRleE9mKHYpO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwudmlzaXRvcnMuc3BsaWNlKGlkeCwgMSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuc2VhcmNoID0gZnVuY3Rpb24gKHRhYmxlU3RhdGUpIHtcclxuICAgICAgICAgICAgdGFibGVTdGF0ZVJlZiA9IHRhYmxlU3RhdGU7XHJcbiAgICAgICAgICAgICRodHRwLmdldCgnYXBpL3Zpc2l0b3InLCB7IHBhcmFtczogJGN0cmwuc2VhcmNoTW9kZWwgfSkudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwudmlzaXRvcnMgPSByLmRhdGEucmVzdWx0cztcclxuICAgICAgICAgICAgICAgICRjdHJsLnNlYXJjaE1vZGVsID0gci5kYXRhO1xyXG4gICAgICAgICAgICAgICAgZGVsZXRlICRjdHJsLnNlYXJjaE1vZGVsLnJlc3VsdHM7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwucGFnZWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRjdHJsLnNlYXJjaCh0YWJsZVN0YXRlUmVmKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ3Zpc2l0b3JMaXN0JyxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL3Zpc2l0b3JzL3Zpc2l0b3ItbGlzdC5jb21wb25lbnQuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJGh0dHAnLCAnJHVpYk1vZGFsJywgY29udHJvbGxlcl1cclxuICAgICAgICB9KTtcclxufVxyXG4pKCk7Il19
