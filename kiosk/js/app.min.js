!function(){var e=angular.module("app",["ngComponentRouter","ngAnimate","ui.bootstrap","ngMessages","onScreenKeyboard","treasure-overlay-spinner"]);e.component("kiosk",{template:"<ng-outlet>Loading ..</ng-outlet >",$routeConfig:[{path:"/",name:"Welcome",component:"welcome",useAsDefault:!0},{path:"/register",name:"Register",component:"register"},{path:"/pledge",name:"Pledge",component:"pledge"},{path:"/finish",name:"Finish",component:"finish"},{path:"/search",name:"Search",component:"search"},{path:"/results",name:"Results",component:"results"}]}),e.value("$routerRootComponent","kiosk"),e.value("config",{host:window.location.hostname,apiUrl:"http://localhost:49960/api/visitor",hubUrl:"http://localhost:49960/signalr",redirectTimeout:3e4,finishTimeout:4,kiosk:1}),e.run(["config",function(e){switch(e.host){case"crmckiosk":e.apiUrl="http://crmc/api/visitor",e.hubUrl="http://crmc/signalr";break;case"crmckiosk-test":e.apiUrl="http://crmc-test/api/visitor",e.hubUrl="http://crmc-test/signalr"}}])}();
!function(){function n(n,t,o){var i=this;i.$onInit=function(){console.log("finish init",n),$.connection.hub.url=n.hubUrl;var o=$.connection.nameNotificationHub;$.connection.hub.start().done(function(){console.log("hub connection started"),o.server.addName(1,t.get())}),i.countDown_tick=n.finishTimeout,i.startTimer()},this.$routerOnActivate=function(n){i.$router=this.$router},i.startTimer=function(){i.countDown_tick<=0?(t.clear(),console.log("timer finished"),i.$router.navigate(["Welcome"])):(i.countDown_tick--,o(i.startTimer,1e3))}}var t=angular.module("app");t.component("finish",{bindings:{$router:"<"},templateUrl:"app/finish.component.html",controller:["config","visitorService","$timeout",n]})}();
!function(){function e(e,t,n){var o,i=this;i.$onInit=function(){console.log("pledge init"),i.visitor=n.get(),i.startTimer()},this.$routerOnActivate=function(e){},i.gotoWelcome=function(){n.clear(),e.cancel(o),this.$router.navigate(["Welcome"])},i.gotoRegister=function(){e.cancel(o),this.$router.navigate(["Register"])},i.pledge=function(){n.get().id?console.log("returning visitor",n.get()):(console.log("save new visitor",n.get()),n.save()),e.cancel(o),this.$router.navigate(["Finish"])},i.startTimer=function(){e.cancel(o),o=e(function(){n.clear(),i.$router.navigate(["Welcome"])},t.redirectTimeout)}}var t=angular.module("app");t.component("pledge",{bindings:{$router:"<"},templateUrl:"app/pledge.component.html",controller:["$timeout","config","visitorService",e]})}();
!function(){function t(t,e,o){var n,r=this;r.$onInit=function(){r.visitor=e.get(),r.startTimer()},this.$routerOnActivate=function(t){r.$router=this.$router},r.gotoWelcome=function(){o.cancel(n),this.$router.navigate(["Welcome"])},r.gotoPledge=function(){o.cancel(n),this.$router.navigate(["Pledge"])},r.startTimer=function(){o.cancel(n),n=o(function(){e.clear(),r.$router.navigate(["Welcome"])},t.redirectTimeout)}}var e=angular.module("app");e.component("register",{bindings:{$router:"<"},templateUrl:"app/register.component.html",controller:["config","visitorService","$timeout",t]})}();
!function(){function e(e,t,n){var r,o,a=this,c=10;a.searchModel={page:1,pageSize:c},a.paging={currentPage:1},a.$onInit=function(){console.log("search init");const e=n.getTerm().split(" ");e.length>1?(a.searchModel.firstname=e[0],a.searchModel.lastname=e[1]):a.searchModel.lastname=e[0],a.search()},a.gotoWelcome=function(){t.cancel(r),this.$router.navigate(["Welcome"])},a.gotoSearch=function(){t.cancel(r),this.$router.navigate(["Search"])},a.pledge=function(){n.clearTerm(),t.cancel(r),this.$router.navigate(["Pledge"])},a.toggleName=function(e){a.visitor=e,n.set(e),a.startTimer()},a.search=function(e){return o=e,a.loading=!0,n.search(a.searchModel).then(function(e){a.visitors=e.results,a.searchModel=e,delete a.searchModel.results,a.startTimer(),a.loading=!1})},a.paged=function(){a.visitor=null,a.search(o)},a.startTimer=function(){t.cancel(r),r=t(function(){n.clear(),a.$router.navigate(["Welcome"])},e.redirectTimeout)}}var t=angular.module("app");t.component("results",{bindings:{$router:"<"},templateUrl:"app/results.component.html",controller:["config","$timeout","visitorService",e]})}();
!function(){function e(e,t,r){var n,o=this;o.$onInit=function(){console.log("search init"),o.searchTerm=t.getTerm(),o.startTimer()},o.gotoWelcome=function(){t.clear(),r.cancel(n),this.$router.navigate(["Welcome"])},o.gotoSearchResults=function(){t.setTerm(o.searchTerm),r.cancel(n),this.$router.navigate(["Results"])},o.startTimer=function(){r.cancel(n),n=r(function(){t.clear(),o.$router.navigate(["Welcome"])},e.redirectTimeout)}}var t=angular.module("app");t.component("search",{bindings:{$router:"<"},templateUrl:"app/search.component.html",controller:["config","visitorService","$timeout",e]})}();
!function(){function t(){var t=this;t.$onInit=function(){console.log("welcome init")},this.$routerOnActivate=function(t){},t.gotoRegister=function(){this.$router.navigate(["Register"])},t.gotoSearch=function(){this.$router.navigate(["Search"])}}var o=angular.module("app");o.component("welcome",{bindings:{$router:"<"},templateUrl:"app/welcome.component.html",controller:[t]})}();
angular.module("onScreenKeyboard",["ngSanitize"]).directive("onScreenKeyboard",["$timeout","$document",function(t,e){"use strict";return{restrict:"E",bindToController:!0,controllerAs:"ctrl",scope:{rows:"=?",uppercaseAllWords:"@"},controller:["$sce",function(t){var e=this;e.rows||(e.rows=[["1","2","3","4","5","6","7","8","9","0",{type:"erase",colspan:2,text:"&lArr;"}],["q","w","e","r","t","y","u","i","o","p","@"],["a","s","d","f","g","h","j","k","l","-","_",{type:"margin"}],[{type:"shift"},"z","x","c","v","b","n","m",",",".",{type:"shift"}],[{type:"margin"},{type:"space",colspan:9,text:" "}]]),e.getText=function(e){if("margin"===e.type)return"";if("shift"===e.type)return"&dArr;";var r=e.text||e;return r&&r.indexOf("&")>-1?t.trustAsHtml(r):r}}],link:function(r,n,s){var a=r.ctrl;n.bind("contextmenu",function(t){return t.preventDefault(),!1}),a.isUpperCase=!1,a.lastInputCtrl=null,a.startPos=null,a.endPos=null,a.printKeyStroke=function(t){if(a.lastInputCtrl){var e=angular.element(t.target||t.srcElement);if(e.hasClass("erase"))return void a.eraseKeyStroke();if(e.hasClass("shift"))return void a.inverseCase();var r=angular.element(a.lastInputCtrl),n=r.val(),s=n.substring(0,a.startPos),l=n.substring(a.endPos,n.length);r.val(s+e.text()+l),r.triggerHandler("change"),a.startPos++,a.endPos++,a.setKeyboardLayout()}},a.inverseCase=function(){},a.refocus=function(){a.lastInputCtrl.focus()},a.eraseKeyStroke=function(){if(a.lastInputCtrl){var t=a.startPos!==a.endPos,e=angular.element(a.lastInputCtrl),r=e.val(),n=r.substring(0,t?a.startPos:a.startPos-1),s=r.substring(a.endPos,r.length);e.val(n+s),e.triggerHandler("change"),t?a.endPos=a.startPos:(a.startPos--,a.endPos--),a.lastInputCtrl.selectionStart=a.startPos,a.lastInputCtrl.selectionEnd=a.startPos,a.setKeyboardLayout(),a.refocus()}},a.setKeyboardLayout=function(){return a.lastInputCtrl?void(a.lastInputCtrl.className&&a.isUpperCase?a.inverseCase():0===angular.element(a.lastInputCtrl).val().length?a.isUpperCase||(a.isUpperCase=!1,a.inverseCase()):" "===angular.element(a.lastInputCtrl).val().slice(-1)&&!a.isUpperCase&&s.hasOwnProperty("uppercaseAllWords")?a.inverseCase():(a.isUpperCase=!0,a.inverseCase())):(a.isUpperCase=!1,void a.inverseCase())},e.find("input").bind("blur focus",function(){a.setKeyboardLayout(),a.lastInputCtrl=this,a.lastInputCtrl&&"checkbox"!==a.lastInputCtrl.type&&(a.startPos=a.lastInputCtrl.selectionStart,a.endPos=a.lastInputCtrl.selectionEnd)}).bind("keydown",function(){a.startPos=a.lastInputCtrl.selectionStart,a.endPos=a.lastInputCtrl.selectionEnd}),t(function(){a.inverseCase()},0)},templateUrl:"/templates/angular-on-screen-keyboard.html"}}]),angular.module("onScreenKeyboard").run(["$templateCache",function(t){"use strict";t.put("/templates/angular-on-screen-keyboard.html","<div class=keyboard><table><tr ng-repeat=\"row in ctrl.rows\"><td ng-repeat=\"key in row\" ng-click=ctrl.printKeyStroke($event) colspan=\"{{key.colspan || 1}}\" ng-class=\"{'button': key.type !== 'margin', 'letter': key.type !== 'margin'}\" class={{key.type}} ng-bind-html=ctrl.getText(key)></td></tr></table></div>")}]);
!function(){function n(n,t){function e(){s={}}function r(){g=""}function o(){return s}function c(){return g}function i(n){s=n}function u(n){g=n}function a(e){return n.get(t.apiUrl,{params:e}).then(function(n){return n.data})}function f(e){n.post(t.apiUrl,s).then(function(n){console.log("saved new visitor",s)}).catch(function(n){console.error("something went wrong",n.message)})}var s={},g="";return{clear:e,clearTerm:r,get:o,getTerm:c,set:i,setTerm:u,save:f,search:a}}var t=angular.module("app");t.factory("visitorService",["$http","config",n])}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJmaW5pc2guY29tcG9uZW50LmpzIiwicGxlZGdlLmNvbXBvbmVudC5qcyIsInJlZ2lzdGVyLmNvbXBvbmVudC5qcyIsInJlc3VsdHMuY29tcG9uZW50LmpzIiwic2VhcmNoLmNvbXBvbmVudC5qcyIsIndlbGNvbWUuY29tcG9uZW50LmpzIiwiZGlyZWN0aXZlcy9hbmd1bGFyLW9uLXNjcmVlbi1rZXlib2FyZC5qcyIsInNlcnZpY2VzL3Zpc2l0b3Iuc2VydmljZS5qcyJdLCJuYW1lcyI6WyJtb2R1bGUiLCJhbmd1bGFyIiwiY29tcG9uZW50IiwidGVtcGxhdGUiLCIkcm91dGVDb25maWciLCJwYXRoIiwibmFtZSIsInVzZUFzRGVmYXVsdCIsInZhbHVlIiwiaG9zdCIsIndpbmRvdyIsImxvY2F0aW9uIiwiaG9zdG5hbWUiLCJhcGlVcmwiLCJodWJVcmwiLCJyZWRpcmVjdFRpbWVvdXQiLCJmaW5pc2hUaW1lb3V0Iiwia2lvc2siLCJydW4iLCJjb25maWciLCJjb250cm9sbGVyIiwidmlzaXRvciIsIiR0aW1lb3V0IiwiJGN0cmwiLCJ0aGlzIiwiJG9uSW5pdCIsImNvbnNvbGUiLCJsb2ciLCIkIiwiY29ubmVjdGlvbiIsImh1YiIsInVybCIsIm5hbWVOb3RpZmljYXRpb25IdWIiLCJzdGFydCIsImRvbmUiLCJzZXJ2ZXIiLCJhZGROYW1lIiwiZ2V0IiwiY291bnREb3duX3RpY2siLCJzdGFydFRpbWVyIiwiJHJvdXRlck9uQWN0aXZhdGUiLCJuZXh0IiwiJHJvdXRlciIsImNsZWFyIiwibmF2aWdhdGUiLCJiaW5kaW5ncyIsInRlbXBsYXRlVXJsIiwidGltZXIiLCJnb3RvV2VsY29tZSIsImNhbmNlbCIsImdvdG9SZWdpc3RlciIsInBsZWRnZSIsImlkIiwic2F2ZSIsImdvdG9QbGVkZ2UiLCJ0YWJsZVN0YXRlUmVmIiwicGFnZVNpemVEZWZhdWx0Iiwic2VhcmNoTW9kZWwiLCJwYWdlIiwicGFnZVNpemUiLCJwYWdpbmciLCJjdXJyZW50UGFnZSIsIm5hbWVzIiwiZ2V0VGVybSIsInNwbGl0IiwibGVuZ3RoIiwiZmlyc3RuYW1lIiwibGFzdG5hbWUiLCJzZWFyY2giLCJnb3RvU2VhcmNoIiwiY2xlYXJUZXJtIiwidG9nZ2xlTmFtZSIsInYiLCJzZXQiLCJ0YWJsZVN0YXRlIiwibG9hZGluZyIsInRoZW4iLCJyIiwidmlzaXRvcnMiLCJyZXN1bHRzIiwicGFnZWQiLCJzZWFyY2hUZXJtIiwiZ290b1NlYXJjaFJlc3VsdHMiLCJzZXRUZXJtIiwiZGlyZWN0aXZlIiwiYSIsImIiLCJyZXN0cmljdCIsImJpbmRUb0NvbnRyb2xsZXIiLCJjb250cm9sbGVyQXMiLCJzY29wZSIsInJvd3MiLCJ1cHBlcmNhc2VBbGxXb3JkcyIsInR5cGUiLCJjb2xzcGFuIiwidGV4dCIsImdldFRleHQiLCJjIiwiaW5kZXhPZiIsInRydXN0QXNIdG1sIiwibGluayIsImQiLCJlIiwiZiIsImN0cmwiLCJiaW5kIiwicHJldmVudERlZmF1bHQiLCJpc1VwcGVyQ2FzZSIsImxhc3RJbnB1dEN0cmwiLCJzdGFydFBvcyIsImVuZFBvcyIsInByaW50S2V5U3Ryb2tlIiwiZWxlbWVudCIsInRhcmdldCIsInNyY0VsZW1lbnQiLCJoYXNDbGFzcyIsImVyYXNlS2V5U3Ryb2tlIiwiaW52ZXJzZUNhc2UiLCJ2YWwiLCJzdWJzdHJpbmciLCJnIiwidHJpZ2dlckhhbmRsZXIiLCJzZXRLZXlib2FyZExheW91dCIsInJlZm9jdXMiLCJmb2N1cyIsInNlbGVjdGlvblN0YXJ0Iiwic2VsZWN0aW9uRW5kIiwiY2xhc3NOYW1lIiwic2xpY2UiLCJoYXNPd25Qcm9wZXJ0eSIsImZpbmQiLCIkdGVtcGxhdGVDYWNoZSIsInB1dCIsImZhY3RvcnkiLCIkaHR0cCIsInRlcm0iLCJ0IiwibW9kZWwiLCJwYXJhbXMiLCJkYXRhIiwicG9zdCIsImNhdGNoIiwiZXJyIiwiZXJyb3IiLCJtZXNzYWdlIl0sIm1hcHBpbmdzIjoiQ0FDQSxXQUNJLEdBQUlBLEdBQVNDLFFBQVFELE9BQU8s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UVEsR0FBU3VELEtBQUssU0FBVUMsR0FDOUNuRCxRQUFRQyxJQUFJLG9CQUFxQk4sS0FDbEN3SCxNQUFNLFNBQVVDLEdBQ2ZwSCxRQUFRcUgsTUFBTSx1QkFBd0JELEVBQUlFLFdBaERsRCxHQUFJM0gsTUFDQWtILEVBQU8sRUFFWCxRQUNJNUYsTUFBT0EsRUFDUDJCLFVBQVdBLEVBQ1hqQyxJQUFLQSxFQUNMMEIsUUFBU0EsRUFDVFUsSUFBS0EsRUFDTFUsUUFBU0EsRUFDVDlCLEtBQU1BLEVBQ05lLE9BQVFBLEdBZGhCLEdBQUlwRSxHQUFTQyxRQUFRRCxPQUFPLE1BeUQ1QkEsR0FBT3FJLFFBQVEsa0JBQW1CLFFBQVMsU0FBVUEiLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vYXBwLm1vZHVsZS5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXHJcbiAgICAgICAgJ25nQ29tcG9uZW50Um91dGVyJyxcclxuICAgICAgICAnbmdBbmltYXRlJywgXHJcbiAgICAgICAgJ3VpLmJvb3RzdHJhcCcsXHJcbiAgICAgICAgJ25nTWVzc2FnZXMnLFxyXG4gICAgICAgICdvblNjcmVlbktleWJvYXJkJywgXHJcbiAgICAgICAgJ3RyZWFzdXJlLW92ZXJsYXktc3Bpbm5lcidcclxuICAgIF0pO1xyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ2tpb3NrJyxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPG5nLW91dGxldD5Mb2FkaW5nIC4uPC9uZy1vdXRsZXQgPicsXHJcbiAgICAgICAgICAgICRyb3V0ZUNvbmZpZzogW1xyXG4gICAgICAgICAgICAgICAgeyBwYXRoOiAnLycsIG5hbWU6ICdXZWxjb21lJywgY29tcG9uZW50OiAnd2VsY29tZScsIHVzZUFzRGVmYXVsdDogdHJ1ZSB9LFxyXG4gICAgICAgICAgICAgICAgeyBwYXRoOiAnL3JlZ2lzdGVyJywgbmFtZTogJ1JlZ2lzdGVyJywgY29tcG9uZW50OiAncmVnaXN0ZXInIH0sXHJcbiAgICAgICAgICAgICAgICB7IHBhdGg6ICcvcGxlZGdlJywgbmFtZTogJ1BsZWRnZScsIGNvbXBvbmVudDogJ3BsZWRnZScgfSxcclxuICAgICAgICAgICAgICAgIHsgcGF0aDogJy9maW5pc2gnLCBuYW1lOiAnRmluaXNoJywgY29tcG9uZW50OiAnZmluaXNoJyB9LFxyXG4gICAgICAgICAgICAgICAgeyBwYXRoOiAnL3NlYXJjaCcsIG5hbWU6ICdTZWFyY2gnLCBjb21wb25lbnQ6ICdzZWFyY2gnIH0sXHJcbiAgICAgICAgICAgICAgICB7IHBhdGg6ICcvcmVzdWx0cycsIG5hbWU6ICdSZXN1bHRzJywgY29tcG9uZW50OiAncmVzdWx0cycgfVxyXG4gICAgICAgICAgICBdXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgbW9kdWxlLnZhbHVlKCckcm91dGVyUm9vdENvbXBvbmVudCcsICdraW9zaycpO1xyXG4gICAgbW9kdWxlLnZhbHVlKCdjb25maWcnLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaG9zdDogd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lLFxyXG4gICAgICAgICAgICBhcGlVcmw6ICdodHRwOi8vbG9jYWxob3N0OjQ5OTYwL2FwaS92aXNpdG9yJyxcclxuICAgICAgICAgICAgaHViVXJsOiAnaHR0cDovL2xvY2FsaG9zdDo0OTk2MC9zaWduYWxyJyxcclxuICAgICAgICAgICAgcmVkaXJlY3RUaW1lb3V0OiAzMDAwMCxcclxuICAgICAgICAgICAgZmluaXNoVGltZW91dDogNCxcclxuICAgICAgICAgICAga2lvc2s6IDFcclxuICAgICAgICB9KTtcclxuXHJcbiAgICAvL21vZHVsZS5jb25maWcoWyd1c1NwaW5uZXJDb25maWdQcm92aWRlcicsIGZ1bmN0aW9uICh1c1NwaW5uZXJDb25maWdQcm92aWRlcikge1xyXG4gICAgLy8gICAgdXNTcGlubmVyQ29uZmlnUHJvdmlkZXIuc2V0RGVmYXVsdHMoXHJcbiAgICAvLyAgICB7XHJcbiAgICAvLyAgICAgICAgY29sb3I6ICdibHVlJyxcclxuICAgIC8vICAgICAgICByYWRpdXM6IDMwLFxyXG4gICAgLy8gICAgICAgIHdpZHRoOiA4LFxyXG4gICAgLy8gICAgICAgIGxlbmd0aDogMTZcclxuICAgIC8vICAgIH0pO1xyXG4gICAgLy99XSk7XHJcblxyXG4gICAgbW9kdWxlLnJ1bihbJ2NvbmZpZycsIGZ1bmN0aW9uIChjb25maWcpIHtcclxuICAgICAgICBzd2l0Y2ggKGNvbmZpZy5ob3N0KSB7XHJcbiAgICAgICAgICAgIGNhc2UgJ2NybWNraW9zayc6XHJcbiAgICAgICAgICAgICAgICBjb25maWcuYXBpVXJsID0gJ2h0dHA6Ly9jcm1jL2FwaS92aXNpdG9yJztcclxuICAgICAgICAgICAgICAgIGNvbmZpZy5odWJVcmwgPSAnaHR0cDovL2NybWMvc2lnbmFscic7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnY3JtY2tpb3NrLXRlc3QnOlxyXG4gICAgICAgICAgICAgICAgY29uZmlnLmFwaVVybCA9ICdodHRwOi8vY3JtYy10ZXN0L2FwaS92aXNpdG9yJztcclxuICAgICAgICAgICAgICAgIGNvbmZpZy5odWJVcmwgPSAnaHR0cDovL2NybWMtdGVzdC9zaWduYWxyJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBkZWZhdWx0OlxyXG5cclxuICAgICAgICB9XHJcbiAgICB9XSk7XHJcblxyXG5cclxufVxyXG4pKCk7IiwiLy9maW5pc2guY29tcG9uZW50LmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xyXG4gICAgLy9UT0RPOiBTRVQvR0VUIGtpb3NrIG51bWJlciBmcm9tIGxvY2FsIHN0b3JhZ2VcclxuICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoY29uZmlnLCB2aXNpdG9yLCAkdGltZW91dCkge1xyXG4gICAgICAgIHZhciAkY3RybCA9IHRoaXM7XHJcblxyXG4gICAgICAgICRjdHJsLiRvbkluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdmaW5pc2ggaW5pdCcsIGNvbmZpZyk7XHJcbiAgICAgICAgICAgICQuY29ubmVjdGlvbi5odWIudXJsID0gY29uZmlnLmh1YlVybDtcclxuICAgICAgICAgICAgdmFyIGh1YiA9ICQuY29ubmVjdGlvbi5uYW1lTm90aWZpY2F0aW9uSHViO1xyXG4gICAgICAgICAgICAkLmNvbm5lY3Rpb24uaHViLnN0YXJ0KCkuZG9uZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdodWIgY29ubmVjdGlvbiBzdGFydGVkJyk7XHJcbiAgICAgICAgICAgICAgICBodWIuc2VydmVyLmFkZE5hbWUoMSwgdmlzaXRvci5nZXQoKSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgJGN0cmwuY291bnREb3duX3RpY2sgPSBjb25maWcuZmluaXNoVGltZW91dDtcclxuICAgICAgICAgICAgJGN0cmwuc3RhcnRUaW1lcigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy4kcm91dGVyT25BY3RpdmF0ZSA9IGZ1bmN0aW9uIChuZXh0KSB7XHJcbiAgICAgICAgICAgICRjdHJsLiRyb3V0ZXIgPSB0aGlzLiRyb3V0ZXI7IFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRjdHJsLnN0YXJ0VGltZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICgkY3RybC5jb3VudERvd25fdGljayA8PSAwKSB7XHJcbiAgICAgICAgICAgICAgICB2aXNpdG9yLmNsZWFyKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygndGltZXIgZmluaXNoZWQnKTtcclxuICAgICAgICAgICAgICAgICRjdHJsLiRyb3V0ZXIubmF2aWdhdGUoWydXZWxjb21lJ10pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuY291bnREb3duX3RpY2stLTtcclxuICAgICAgICAgICAgICAgICR0aW1lb3V0KCRjdHJsLnN0YXJ0VGltZXIsIDEwMDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW9kdWxlLmNvbXBvbmVudCgnZmluaXNoJyxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJpbmRpbmdzOiB7XHJcbiAgICAgICAgICAgICAgICAkcm91dGVyOiAnPCdcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvZmluaXNoLmNvbXBvbmVudC5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogWydjb25maWcnLCAndmlzaXRvclNlcnZpY2UnLCAnJHRpbWVvdXQnLCBjb250cm9sbGVyXVxyXG4gICAgICAgIH0pO1xyXG59XHJcbikoKTsiLCIvL3BsZWRnZS5jb21wb25lbnQuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7XHJcbiAgICAvL1RPRE86IEdFVCBodWIgdXJsIGZyb20gc2V0dGluZ3NcclxuICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoJHRpbWVvdXQsIGNvbmZpZywgdmlzaXRvcikge1xyXG4gICAgICAgIHZhciAkY3RybCA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHRpbWVyOyBcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3BsZWRnZSBpbml0Jyk7XHJcbiAgICAgICAgICAgICRjdHJsLnZpc2l0b3IgPSB2aXNpdG9yLmdldCgpO1xyXG4gICAgICAgICAgICAkY3RybC5zdGFydFRpbWVyKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLiRyb3V0ZXJPbkFjdGl2YXRlID0gZnVuY3Rpb24gKG5leHQpIHsgfTtcclxuXHJcbiAgICAgICAgJGN0cmwuZ290b1dlbGNvbWUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZpc2l0b3IuY2xlYXIoKTtcclxuICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKHRpbWVyKTtcclxuICAgICAgICAgICAgdGhpcy4kcm91dGVyLm5hdmlnYXRlKFsnV2VsY29tZSddKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmdvdG9SZWdpc3RlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKHRpbWVyKTtcclxuICAgICAgICAgICAgdGhpcy4kcm91dGVyLm5hdmlnYXRlKFsnUmVnaXN0ZXInXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5wbGVkZ2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICghdmlzaXRvci5nZXQoKS5pZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3NhdmUgbmV3IHZpc2l0b3InLCB2aXNpdG9yLmdldCgpKTtcclxuICAgICAgICAgICAgICAgIHZpc2l0b3Iuc2F2ZSgpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JldHVybmluZyB2aXNpdG9yJywgdmlzaXRvci5nZXQoKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKHRpbWVyKTtcclxuICAgICAgICAgICAgdGhpcy4kcm91dGVyLm5hdmlnYXRlKFsnRmluaXNoJ10pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuc3RhcnRUaW1lciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKHRpbWVyKTtcclxuICAgICAgICAgICAgdGltZXIgPSAkdGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2aXNpdG9yLmNsZWFyKCk7XHJcbiAgICAgICAgICAgICAgICAkY3RybC4kcm91dGVyLm5hdmlnYXRlKFsnV2VsY29tZSddKTtcclxuICAgICAgICAgICAgfSwgY29uZmlnLnJlZGlyZWN0VGltZW91dCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb2R1bGUuY29tcG9uZW50KCdwbGVkZ2UnLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgICAgICRyb3V0ZXI6ICc8J1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9wbGVkZ2UuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiBbJyR0aW1lb3V0JywgJ2NvbmZpZycsICd2aXNpdG9yU2VydmljZScsIGNvbnRyb2xsZXJdXHJcbiAgICAgICAgfSk7XHJcbn1cclxuKSgpOyIsIi8vcmVnaXN0ZXIuY29tcG9uZW50LmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoY29uZmlnLCB2aXNpdG9yLCAkdGltZW91dCkge1xyXG4gICAgICAgIHZhciAkY3RybCA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHRpbWVyOyBcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAkY3RybC52aXNpdG9yID0gdmlzaXRvci5nZXQoKTsgXHJcbiAgICAgICAgICAgICRjdHJsLnN0YXJ0VGltZXIoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuJHJvdXRlck9uQWN0aXZhdGUgPSBmdW5jdGlvbiAobmV4dCkge1xyXG4gICAgICAgICAgICAkY3RybC4kcm91dGVyID0gdGhpcy4kcm91dGVyO1xyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRjdHJsLmdvdG9XZWxjb21lID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkdGltZW91dC5jYW5jZWwodGltZXIpO1xyXG4gICAgICAgICAgICB0aGlzLiRyb3V0ZXIubmF2aWdhdGUoWydXZWxjb21lJ10pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuZ290b1BsZWRnZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKHRpbWVyKTtcclxuICAgICAgICAgICAgdGhpcy4kcm91dGVyLm5hdmlnYXRlKFsnUGxlZGdlJ10pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuc3RhcnRUaW1lciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKHRpbWVyKTtcclxuICAgICAgICAgICAgdGltZXIgPSAkdGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2aXNpdG9yLmNsZWFyKCk7XHJcbiAgICAgICAgICAgICAgICAkY3RybC4kcm91dGVyLm5hdmlnYXRlKFsnV2VsY29tZSddKTtcclxuICAgICAgICAgICAgfSwgY29uZmlnLnJlZGlyZWN0VGltZW91dCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb2R1bGUuY29tcG9uZW50KCdyZWdpc3RlcicsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiaW5kaW5nczogeyAkcm91dGVyOiAnPCcgfSxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvcmVnaXN0ZXIuY29tcG9uZW50Lmh0bWwnLCBcclxuICAgICAgICAgICAgY29udHJvbGxlcjogWydjb25maWcnLCAndmlzaXRvclNlcnZpY2UnLCAnJHRpbWVvdXQnLCBjb250cm9sbGVyXVxyXG4gICAgICAgIH0pO1xyXG5cclxuXHJcbn1cclxuKSgpOyIsIi8vcmVzdWx0cy5jb21wb25lbnQuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7XHJcbiAgICAvL1RPRE86IEdFVCBodWIgdXJsIGZyb20gc2V0dGluZ3NcclxuICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoY29uZmlnLCAkdGltZW91dCwgdmlzaXRvcikge1xyXG4gICAgICAgIHZhciAkY3RybCA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHRpbWVyOyBcclxuICAgICAgICB2YXIgcGFnZVNpemVEZWZhdWx0ID0gMTA7XHJcbiAgICAgICAgdmFyIHRhYmxlU3RhdGVSZWY7XHJcblxyXG4gICAgICAgICRjdHJsLnNlYXJjaE1vZGVsID0ge1xyXG4gICAgICAgICAgICBwYWdlOiAxLFxyXG4gICAgICAgICAgICBwYWdlU2l6ZTogcGFnZVNpemVEZWZhdWx0XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJGN0cmwucGFnaW5nID0ge1xyXG4gICAgICAgICAgICBjdXJyZW50UGFnZTogMVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3NlYXJjaCBpbml0Jyk7XHJcbiAgICAgICAgICAgIGNvbnN0IG5hbWVzID0gdmlzaXRvci5nZXRUZXJtKCkuc3BsaXQoJyAnKTtcclxuICAgICAgICAgICAgaWYgKG5hbWVzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgICAgICRjdHJsLnNlYXJjaE1vZGVsLmZpcnN0bmFtZSA9IG5hbWVzWzBdOyBcclxuICAgICAgICAgICAgICAgICRjdHJsLnNlYXJjaE1vZGVsLmxhc3RuYW1lID0gbmFtZXNbMV07IFxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuc2VhcmNoTW9kZWwubGFzdG5hbWUgPSBuYW1lc1swXTsgXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICRjdHJsLnNlYXJjaCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuZ290b1dlbGNvbWUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICR0aW1lb3V0LmNhbmNlbCh0aW1lcik7XHJcbiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5uYXZpZ2F0ZShbJ1dlbGNvbWUnXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5nb3RvU2VhcmNoID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkdGltZW91dC5jYW5jZWwodGltZXIpO1xyXG4gICAgICAgICAgICB0aGlzLiRyb3V0ZXIubmF2aWdhdGUoWydTZWFyY2gnXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5wbGVkZ2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZpc2l0b3IuY2xlYXJUZXJtKCk7XHJcbiAgICAgICAgICAgICR0aW1lb3V0LmNhbmNlbCh0aW1lcik7XHJcbiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5uYXZpZ2F0ZShbJ1BsZWRnZSddKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLnRvZ2dsZU5hbWUgPSBmdW5jdGlvbiAodikge1xyXG4gICAgICAgICAgICAkY3RybC52aXNpdG9yID0gdjtcclxuICAgICAgICAgICAgdmlzaXRvci5zZXQodik7XHJcbiAgICAgICAgICAgICRjdHJsLnN0YXJ0VGltZXIoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLnNlYXJjaCA9IGZ1bmN0aW9uICh0YWJsZVN0YXRlKSB7XHJcbiAgICAgICAgICAgIHRhYmxlU3RhdGVSZWYgPSB0YWJsZVN0YXRlO1xyXG4gICAgICAgICAgICAkY3RybC5sb2FkaW5nID0gdHJ1ZTtcclxuICAgICAgICAgICAgcmV0dXJuIHZpc2l0b3Iuc2VhcmNoKCRjdHJsLnNlYXJjaE1vZGVsKS50aGVuKGZ1bmN0aW9uIChyKSB7XHJcbiAgICAgICAgICAgICAgICAkY3RybC52aXNpdG9ycyA9IHIucmVzdWx0cztcclxuICAgICAgICAgICAgICAgICRjdHJsLnNlYXJjaE1vZGVsID0gcjtcclxuICAgICAgICAgICAgICAgIGRlbGV0ZSAkY3RybC5zZWFyY2hNb2RlbC5yZXN1bHRzO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuc3RhcnRUaW1lcigpO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwubG9hZGluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICB9KTsgXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5wYWdlZCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJGN0cmwudmlzaXRvciA9IG51bGw7IFxyXG4gICAgICAgICAgICAkY3RybC5zZWFyY2godGFibGVTdGF0ZVJlZik7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5zdGFydFRpbWVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkdGltZW91dC5jYW5jZWwodGltZXIpO1xyXG4gICAgICAgICAgICB0aW1lciA9ICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZpc2l0b3IuY2xlYXIoKTtcclxuICAgICAgICAgICAgICAgICRjdHJsLiRyb3V0ZXIubmF2aWdhdGUoWydXZWxjb21lJ10pO1xyXG4gICAgICAgICAgICB9LCBjb25maWcucmVkaXJlY3RUaW1lb3V0KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ3Jlc3VsdHMnLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYmluZGluZ3M6IHsgJHJvdXRlcjogJzwnIH0sXHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL3Jlc3VsdHMuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiBbJ2NvbmZpZycsICckdGltZW91dCcsICd2aXNpdG9yU2VydmljZScsIGNvbnRyb2xsZXJdXHJcbiAgICAgICAgfSk7XHJcbn1cclxuKSgpOyIsIi8vc2VhcmNoLmNvbXBvbmVudC5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnKTtcclxuXHJcbiAgICBmdW5jdGlvbiBjb250cm9sbGVyKGNvbmZpZywgdmlzaXRvciwgJHRpbWVvdXQpIHtcclxuICAgICAgICB2YXIgJGN0cmwgPSB0aGlzO1xyXG4gICAgICAgIHZhciB0aW1lcjsgXHJcblxyXG4gICAgICAgICRjdHJsLiRvbkluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzZWFyY2ggaW5pdCcpO1xyXG4gICAgICAgICAgICAkY3RybC5zZWFyY2hUZXJtID0gdmlzaXRvci5nZXRUZXJtKCk7XHJcbiAgICAgICAgICAgICRjdHJsLnN0YXJ0VGltZXIoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmdvdG9XZWxjb21lID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB2aXNpdG9yLmNsZWFyKCk7XHJcbiAgICAgICAgICAgICR0aW1lb3V0LmNhbmNlbCh0aW1lcik7XHJcbiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5uYXZpZ2F0ZShbJ1dlbGNvbWUnXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5nb3RvU2VhcmNoUmVzdWx0cyA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB2aXNpdG9yLnNldFRlcm0oJGN0cmwuc2VhcmNoVGVybSk7IFxyXG4gICAgICAgICAgICAkdGltZW91dC5jYW5jZWwodGltZXIpO1xyXG4gICAgICAgICAgICB0aGlzLiRyb3V0ZXIubmF2aWdhdGUoWydSZXN1bHRzJ10pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuc3RhcnRUaW1lciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKHRpbWVyKTtcclxuICAgICAgICAgICAgdGltZXIgPSAkdGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2aXNpdG9yLmNsZWFyKCk7XHJcbiAgICAgICAgICAgICAgICAkY3RybC4kcm91dGVyLm5hdmlnYXRlKFsnV2VsY29tZSddKTtcclxuICAgICAgICAgICAgfSwgY29uZmlnLnJlZGlyZWN0VGltZW91dCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb2R1bGUuY29tcG9uZW50KCdzZWFyY2gnLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYmluZGluZ3M6IHsgJHJvdXRlcjogJzwnIH0sXHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL3NlYXJjaC5jb21wb25lbnQuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnY29uZmlnJywgJ3Zpc2l0b3JTZXJ2aWNlJywgJyR0aW1lb3V0JywgY29udHJvbGxlcl1cclxuICAgICAgICB9KTtcclxufVxyXG4pKCk7IiwiLy93ZWxjb21lLmNvbXBvbmVudC5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnKTtcclxuXHJcbiAgICBmdW5jdGlvbiBjb250cm9sbGVyKCkge1xyXG4gICAgICAgIHZhciAkY3RybCA9IHRoaXM7IFxyXG5cclxuICAgICAgICAkY3RybC4kb25Jbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnd2VsY29tZSBpbml0Jyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLiRyb3V0ZXJPbkFjdGl2YXRlID0gZnVuY3Rpb24gKG5leHQpIHsgfTtcclxuXHJcbiAgICAgICAgJGN0cmwuZ290b1JlZ2lzdGVyID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5uYXZpZ2F0ZShbJ1JlZ2lzdGVyJ10pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuZ290b1NlYXJjaCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy4kcm91dGVyLm5hdmlnYXRlKFsnU2VhcmNoJ10pO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBtb2R1bGUuY29tcG9uZW50KCd3ZWxjb21lJyxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJpbmRpbmdzOiB7ICRyb3V0ZXI6ICc8JyB9LFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC93ZWxjb21lLmNvbXBvbmVudC5odG1sJywgXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFtjb250cm9sbGVyXVxyXG4gICAgICAgIH0pO1xyXG5cclxufVxyXG4pKCk7IiwiYW5ndWxhci5tb2R1bGUoXCJvblNjcmVlbktleWJvYXJkXCIsIFtcIm5nU2FuaXRpemVcIl0pLmRpcmVjdGl2ZShcIm9uU2NyZWVuS2V5Ym9hcmRcIiwgW1wiJHRpbWVvdXRcIiwgXCIkZG9jdW1lbnRcIiwgZnVuY3Rpb24gKGEsIGIpIHtcclxuICAgIFwidXNlIHN0cmljdFwiO1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgICByZXN0cmljdDogXCJFXCIsXHJcbiAgICAgICAgYmluZFRvQ29udHJvbGxlcjogITAsXHJcbiAgICAgICAgY29udHJvbGxlckFzOiBcImN0cmxcIixcclxuICAgICAgICBzY29wZToge1xyXG4gICAgICAgICAgICByb3dzOiBcIj0/XCIsXHJcbiAgICAgICAgICAgIHVwcGVyY2FzZUFsbFdvcmRzOiBcIkBcIlxyXG4gICAgICAgIH0sXHJcbiAgICAgICAgY29udHJvbGxlcjogW1wiJHNjZVwiLCBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICB2YXIgYiA9IHRoaXM7XHJcbiAgICAgICAgICAgIGIucm93cyB8fCAoYi5yb3dzID0gW1xyXG4gICAgICAgICAgICAgICAgW1wiMVwiLCBcIjJcIiwgXCIzXCIsIFwiNFwiLCBcIjVcIiwgXCI2XCIsIFwiN1wiLCBcIjhcIiwgXCI5XCIsIFwiMFwiLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJlcmFzZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbHNwYW46IDIsXHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogXCImbEFycjtcIlxyXG4gICAgICAgICAgICAgICAgfV0sXHJcbiAgICAgICAgICAgICAgICBbXCJxXCIsIFwid1wiLCBcImVcIiwgXCJyXCIsIFwidFwiLCBcInlcIiwgXCJ1XCIsIFwiaVwiLCBcIm9cIiwgXCJwXCIsIFwiQFwiXSxcclxuICAgICAgICAgICAgICAgIFtcImFcIiwgXCJzXCIsIFwiZFwiLCBcImZcIiwgXCJnXCIsIFwiaFwiLCBcImpcIiwgXCJrXCIsIFwibFwiLCBcIi1cIiwgXCJfXCIsIHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm1hcmdpblwiXHJcbiAgICAgICAgICAgICAgICB9XSxcclxuICAgICAgICAgICAgICAgIFt7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzaGlmdFwiXHJcbiAgICAgICAgICAgICAgICB9LCBcInpcIiwgXCJ4XCIsIFwiY1wiLCBcInZcIiwgXCJiXCIsIFwiblwiLCBcIm1cIiwgXCIsXCIsIFwiLlwiLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzaGlmdFwiXHJcbiAgICAgICAgICAgICAgICB9XSxcclxuICAgICAgICAgICAgICAgIFt7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJtYXJnaW5cIlxyXG4gICAgICAgICAgICAgICAgfSwge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3BhY2VcIixcclxuICAgICAgICAgICAgICAgICAgICBjb2xzcGFuOiA5LFxyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IFwiIFwiXHJcbiAgICAgICAgICAgICAgICB9XVxyXG4gICAgICAgICAgICBdKSxcclxuICAgICAgICAgICAgICAgIGIuZ2V0VGV4dCA9IGZ1bmN0aW9uIChiKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKFwibWFyZ2luXCIgPT09IGIudHlwZSkgcmV0dXJuIFwiXCI7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKFwic2hpZnRcIiA9PT0gYi50eXBlKSByZXR1cm4gXCImZEFycjtcIjtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IGIudGV4dCB8fCBiO1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBjICYmIGMuaW5kZXhPZihcIiZcIikgPiAtMSA/IGEudHJ1c3RBc0h0bWwoYykgOiBjO1xyXG4gICAgICAgICAgICAgICAgfTtcclxuICAgICAgICB9XSxcclxuICAgICAgICBsaW5rOiBmdW5jdGlvbiAoYywgZCwgZSkge1xyXG4gICAgICAgICAgICB2YXIgZiA9IGMuY3RybDtcclxuICAgICAgICAgICAgZC5iaW5kKFwiY29udGV4dG1lbnVcIiwgZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiBhLnByZXZlbnREZWZhdWx0KCksICExO1xyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgICAgIGYuaXNVcHBlckNhc2UgPSAhMSwgZi5sYXN0SW5wdXRDdHJsID0gbnVsbCwgZi5zdGFydFBvcyA9IG51bGwsIGYuZW5kUG9zID0gbnVsbCxcclxuICAgICAgICAgICAgICAgIGYucHJpbnRLZXlTdHJva2UgPSBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChmLmxhc3RJbnB1dEN0cmwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGIgPSBhbmd1bGFyLmVsZW1lbnQoYS50YXJnZXQgfHwgYS5zcmNFbGVtZW50KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGIuaGFzQ2xhc3MoXCJlcmFzZVwiKSkgcmV0dXJuIHZvaWQgZi5lcmFzZUtleVN0cm9rZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYi5oYXNDbGFzcyhcInNoaWZ0XCIpKSByZXR1cm4gdm9pZCBmLmludmVyc2VDYXNlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBjID0gYW5ndWxhci5lbGVtZW50KGYubGFzdElucHV0Q3RybCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkID0gYy52YWwoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUgPSBkLnN1YnN0cmluZygwLCBmLnN0YXJ0UG9zKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGcgPSBkLnN1YnN0cmluZyhmLmVuZFBvcywgZC5sZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjLnZhbChlICsgYi50ZXh0KCkgKyBnKSwgYy50cmlnZ2VySGFuZGxlcihcImNoYW5nZVwiKSwgZi5zdGFydFBvcysrICwgZi5lbmRQb3MrKyAsIGYuc2V0S2V5Ym9hcmRMYXlvdXQoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZi5pbnZlcnNlQ2FzZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAvL3ZhciBhID0gZFswXS5xdWVyeVNlbGVjdG9yQWxsKFwiLmxldHRlclwiKTtcclxuICAgICAgICAgICAgICAgICAgICAvL2FuZ3VsYXIuZm9yRWFjaChhLCBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgIHZhciBiID0gYW5ndWxhci5lbGVtZW50KGEpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgIGYuaXNVcHBlckNhc2UgPyBiLnRleHQoYi50ZXh0KCkudG9TdHJpbmcoKS50b0xvd2VyQ2FzZSgpKSA6IGIudGV4dChiLnRleHQoKS50b1N0cmluZygpLnRvVXBwZXJDYXNlKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vfSksIGFuZ3VsYXIuZm9yRWFjaChkWzBdLnF1ZXJ5U2VsZWN0b3JBbGwoXCIuc2hpZnRcIiksIGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgZi5pc1VwcGVyQ2FzZSA/IGFuZ3VsYXIuZWxlbWVudChhKS5odG1sKFwiJmRBcnI7XCIpIDogYW5ndWxhci5lbGVtZW50KGEpLmh0bWwoXCImdUFycjtcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgLy99KSwgZi5pc1VwcGVyQ2FzZSA9ICFmLmlzVXBwZXJDYXNlO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGYucmVmb2N1cyA9IGZ1bmN0aW9uICgpIHsgZi5sYXN0SW5wdXRDdHJsLmZvY3VzKCkgfSxcclxuICAgICAgICAgICAgICAgIGYuZXJhc2VLZXlTdHJva2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGYubGFzdElucHV0Q3RybCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSA9IGYuc3RhcnRQb3MgIT09IGYuZW5kUG9zLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYiA9IGFuZ3VsYXIuZWxlbWVudChmLmxhc3RJbnB1dEN0cmwpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYyA9IGIudmFsKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkID0gYy5zdWJzdHJpbmcoMCwgYSA/IGYuc3RhcnRQb3MgOiBmLnN0YXJ0UG9zIC0gMSksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlID0gYy5zdWJzdHJpbmcoZi5lbmRQb3MsIGMubGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYi52YWwoZCArIGUpLCBiLnRyaWdnZXJIYW5kbGVyKFwiY2hhbmdlXCIpLCBhID8gZi5lbmRQb3MgPSBmLnN0YXJ0UG9zIDogKGYuc3RhcnRQb3MtLSAsIGYuZW5kUG9zLS0pLCBmLmxhc3RJbnB1dEN0cmwuc2VsZWN0aW9uU3RhcnQgPSBmLnN0YXJ0UG9zLCBmLmxhc3RJbnB1dEN0cmwuc2VsZWN0aW9uRW5kID0gZi5zdGFydFBvcywgZi5zZXRLZXlib2FyZExheW91dCgpLCBmLnJlZm9jdXMoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9LCBmLnNldEtleWJvYXJkTGF5b3V0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmLmxhc3RJbnB1dEN0cmwgPyB2b2lkIChmLmxhc3RJbnB1dEN0cmwuY2xhc3NOYW1lICYmIGYuaXNVcHBlckNhc2UgPyBmLmludmVyc2VDYXNlKCkgOiAwID09PSBhbmd1bGFyLmVsZW1lbnQoZi5sYXN0SW5wdXRDdHJsKS52YWwoKS5sZW5ndGggPyBmLmlzVXBwZXJDYXNlIHx8IChmLmlzVXBwZXJDYXNlID0gITEsIGYuaW52ZXJzZUNhc2UoKSkgOiBcIiBcIiA9PT0gYW5ndWxhci5lbGVtZW50KGYubGFzdElucHV0Q3RybCkudmFsKCkuc2xpY2UoLTEpICYmICFmLmlzVXBwZXJDYXNlICYmIGUuaGFzT3duUHJvcGVydHkoXCJ1cHBlcmNhc2VBbGxXb3Jkc1wiKSA/IGYuaW52ZXJzZUNhc2UoKSA6IChmLmlzVXBwZXJDYXNlID0gITAsIGYuaW52ZXJzZUNhc2UoKSkpIDogKGYuaXNVcHBlckNhc2UgPSAhMSwgdm9pZCBmLmludmVyc2VDYXNlKCkpO1xyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGIuZmluZChcImlucHV0XCIpLmJpbmQoXCJibHVyIGZvY3VzXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBmLnNldEtleWJvYXJkTGF5b3V0KCksIGYubGFzdElucHV0Q3RybCA9IHRoaXMsIGYubGFzdElucHV0Q3RybCAmJiBcImNoZWNrYm94XCIgIT09IGYubGFzdElucHV0Q3RybC50eXBlICYmIChmLnN0YXJ0UG9zID0gZi5sYXN0SW5wdXRDdHJsLnNlbGVjdGlvblN0YXJ0LCBmLmVuZFBvcyA9IGYubGFzdElucHV0Q3RybC5zZWxlY3Rpb25FbmQpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgICAgICAuYmluZChcImtleWRvd25cIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBmLnN0YXJ0UG9zID0gZi5sYXN0SW5wdXRDdHJsLnNlbGVjdGlvblN0YXJ0LCBmLmVuZFBvcyA9IGYubGFzdElucHV0Q3RybC5zZWxlY3Rpb25FbmQ7XHJcbiAgICAgICAgICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICBhKGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBmLmludmVyc2VDYXNlKCk7XHJcbiAgICAgICAgICAgICAgICB9LCAwKTtcclxuICAgICAgICB9LFxyXG4gICAgICAgIHRlbXBsYXRlVXJsOiBcIi90ZW1wbGF0ZXMvYW5ndWxhci1vbi1zY3JlZW4ta2V5Ym9hcmQuaHRtbFwiXHJcbiAgICB9O1xyXG59XSk7O1xyXG5hbmd1bGFyLm1vZHVsZSgnb25TY3JlZW5LZXlib2FyZCcpLnJ1bihbJyR0ZW1wbGF0ZUNhY2hlJywgZnVuY3Rpb24gKCR0ZW1wbGF0ZUNhY2hlKSB7XHJcbiAgICAndXNlIHN0cmljdCc7XHJcblxyXG4gICAgJHRlbXBsYXRlQ2FjaGUucHV0KCcvdGVtcGxhdGVzL2FuZ3VsYXItb24tc2NyZWVuLWtleWJvYXJkLmh0bWwnLFxyXG4gICAgICAgIFwiPGRpdiBjbGFzcz1rZXlib2FyZD48dGFibGU+PHRyIG5nLXJlcGVhdD1cXFwicm93IGluIGN0cmwucm93c1xcXCI+PHRkIG5nLXJlcGVhdD1cXFwia2V5IGluIHJvd1xcXCIgbmctY2xpY2s9Y3RybC5wcmludEtleVN0cm9rZSgkZXZlbnQpIGNvbHNwYW49XFxcInt7a2V5LmNvbHNwYW4gfHwgMX19XFxcIiBuZy1jbGFzcz1cXFwieydidXR0b24nOiBrZXkudHlwZSAhPT0gJ21hcmdpbicsICdsZXR0ZXInOiBrZXkudHlwZSAhPT0gJ21hcmdpbid9XFxcIiBjbGFzcz17e2tleS50eXBlfX0gbmctYmluZC1odG1sPWN0cmwuZ2V0VGV4dChrZXkpPjwvdGQ+PC90cj48L3RhYmxlPjwvZGl2PlwiXHJcbiAgICApO1xyXG5cclxufV0pOyIsIi8vdmlzaXRvci5zZXJ2aWNlLmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xyXG4gICAgXHJcbiAgICBmdW5jdGlvbiBmYWN0b3J5KCRodHRwLCBjb25maWcpIHtcclxuICAgICAgICB2YXIgdmlzaXRvciA9IHt9O1xyXG4gICAgICAgIHZhciB0ZXJtID0gJyc7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgY2xlYXI6IGNsZWFyLFxyXG4gICAgICAgICAgICBjbGVhclRlcm06IGNsZWFyVGVybSwgXHJcbiAgICAgICAgICAgIGdldDogZ2V0LFxyXG4gICAgICAgICAgICBnZXRUZXJtOiBnZXRUZXJtLFxyXG4gICAgICAgICAgICBzZXQ6IHNldCxcclxuICAgICAgICAgICAgc2V0VGVybTogc2V0VGVybSxcclxuICAgICAgICAgICAgc2F2ZTogc2F2ZSwgXHJcbiAgICAgICAgICAgIHNlYXJjaDogc2VhcmNoXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY2xlYXIoKSB7XHJcbiAgICAgICAgICAgIHZpc2l0b3IgPSB7fTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGNsZWFyVGVybSgpIHtcclxuICAgICAgICAgICAgdGVybSA9ICcnOyBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdldCgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHZpc2l0b3I7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBnZXRUZXJtKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGVybTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNldCh2KSB7XHJcbiAgICAgICAgICAgIHZpc2l0b3IgPSB2O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2V0VGVybSh0KSB7XHJcbiAgICAgICAgICAgIHRlcm0gPSB0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2VhcmNoKG1vZGVsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoY29uZmlnLmFwaVVybCwgeyBwYXJhbXM6IG1vZGVsIH0pLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByLmRhdGE7IFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNhdmUodikge1xyXG4gICAgICAgICAgICAkaHR0cC5wb3N0KGNvbmZpZy5hcGlVcmwsIHZpc2l0b3IpLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzYXZlZCBuZXcgdmlzaXRvcicsIHZpc2l0b3IpO1xyXG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdzb21ldGhpbmcgd2VudCB3cm9uZycsIGVyci5tZXNzYWdlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb2R1bGUuZmFjdG9yeSgndmlzaXRvclNlcnZpY2UnLCBbJyRodHRwJywgJ2NvbmZpZycsIGZhY3RvcnldKTtcclxuXHJcbn1cclxuKSgpOyJdfQ==
