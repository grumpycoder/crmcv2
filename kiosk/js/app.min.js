!function(){var t=angular.module("app",["ngComponentRouter","ngAnimate","ui.bootstrap","ngMessages","onScreenKeyboard","utils.autofocus","treasure-overlay-spinner"]);t.component("kiosk",{template:"<ng-outlet>Loading ..</ng-outlet >",$routeConfig:[{path:"/",name:"Welcome",component:"welcome",useAsDefault:!0},{path:"/register",name:"Register",component:"register"},{path:"/pledge",name:"Pledge",component:"pledge"},{path:"/finish",name:"Finish",component:"finish"},{path:"/search",name:"Search",component:"search"},{path:"/results",name:"Results",component:"results"}]}),t.value("$routerRootComponent","kiosk"),t.value("config",{host:window.location.hostname,apiUrlBase:"http://localhost:49960/api/",apiUrl:"http://localhost:49960/api/visitor",hubUrl:"http://localhost:49960/signalr",redirectTimeout:3e4,finishTimeout:4,kiosk:1}),t.run(["config","censorService","$http",function(t,e,o){switch(t.host){case"crmckiosk":t.apiUrlBase="http://crmc/api/",t.apiUrl="http://crmc/api/visitor",t.hubUrl="http://crmc/signalr";break;case"crmckiosk-test.splcenter.org":t.apiUrlBase="http://crmc-test/api/",t.apiUrl="http://crmc-test/api/visitor",t.hubUrl="http://crmc-test/signalr";break;case"crmckiosk.splcenter.org":t.apiUrlBase="http://crmc/api/",t.apiUrl="http://crmc/api/visitor",t.hubUrl="http://crmc/signalr"}}])}();
!function(){function n(n,t,o){var i=this;i.$onInit=function(){console.log("finish init",n),$.connection.hub.url=n.hubUrl;var o=$.connection.nameNotificationHub;$.connection.hub.start().done(function(){console.log("hub connection started"),o.server.addName(1,t.get())}),i.countDown_tick=n.finishTimeout,i.startTimer()},this.$routerOnActivate=function(n){i.$router=this.$router},i.startTimer=function(){i.countDown_tick<=0?(t.clear(),console.log("timer finished"),i.$router.navigate(["Welcome"])):(i.countDown_tick--,o(i.startTimer,1e3))}}var t=angular.module("app");t.component("finish",{bindings:{$router:"<"},templateUrl:"app/finish.component.html",controller:["config","visitorService","$timeout",n]})}();
!function(){function e(e,t,n){var o,i=this;i.$onInit=function(){console.log("pledge init"),i.visitor=n.get(),i.startTimer()},this.$routerOnActivate=function(e){},i.gotoWelcome=function(){n.clear(),e.cancel(o),this.$router.navigate(["Welcome"])},i.gotoRegister=function(){e.cancel(o),this.$router.navigate(["Register"])},i.pledge=function(){n.get().id?console.log("returning visitor",n.get()):(console.log("save new visitor",n.get()),n.save()),e.cancel(o),this.$router.navigate(["Finish"])},i.startTimer=function(){e.cancel(o),o=e(function(){n.clear(),i.$router.navigate(["Welcome"])},t.redirectTimeout)}}var t=angular.module("app");t.component("pledge",{bindings:{$router:"<"},templateUrl:"app/pledge.component.html",controller:["$timeout","config","visitorService",e]})}();
!function(){function t(t,e,r,n,o,i){function a(){n.$watchCollection("$ctrl.visitor",function(t){if(void 0!==t.firstname){var e=t.firstname+t.lastname;if(e=e.replace(/ /g,""),e.length>0){var r=c(e.toUpperCase());u.form.lastname.$setValidity("blacklist",r)}}})}function c(t){for(var e=i.get(),r=0;r<e.length;r++)if(t.match((".*"+e[r].trim()+".*").replace(" ",".*")))return!1;return!0}var l,u=this;u.$onInit=function(){u.visitor=e.get(),o.get(t.apiUrlBase+"censor").then(function(e){return console.log("getting data from uri"),o.get(t.apiUrlBase+"censor").then(function(t){var e=[];t.data.length>0&&t.data.forEach(function(t){null!==t.word&&e.push(t.word.replace(/ /g,"").toUpperCase())}),i.set(e)})}),a(),u.startTimer()},this.$routerOnActivate=function(t){u.$router=this.$router},u.gotoWelcome=function(){r.cancel(l),this.$router.navigate(["Welcome"])},u.gotoPledge=function(){r.cancel(l),this.$router.navigate(["Pledge"])},u.startTimer=function(){r.cancel(l),l=r(function(){e.clear(),u.$router.navigate(["Welcome"])},t.redirectTimeout)}}var e=angular.module("app");e.component("register",{bindings:{$router:"<"},templateUrl:"app/register.component.html",controller:["config","visitorService","$timeout","$scope","$http","censorService",t]})}();
!function(){function e(e,t,n){var r,o,a=this,c=10;a.searchModel={page:1,pageSize:c},a.paging={currentPage:1},a.$onInit=function(){console.log("search init");const e=n.getTerm().split(" ");e.length>1?(a.searchModel.firstname=e[0],a.searchModel.lastname=e[1]):a.searchModel.lastname=e[0],a.search()},a.gotoWelcome=function(){t.cancel(r),this.$router.navigate(["Welcome"])},a.gotoSearch=function(){t.cancel(r),this.$router.navigate(["Search"])},a.pledge=function(){n.clearTerm(),t.cancel(r),this.$router.navigate(["Pledge"])},a.toggleName=function(e){a.visitor=e,n.set(e),a.startTimer()},a.search=function(e){return o=e,a.loading=!0,n.search(a.searchModel).then(function(e){a.visitors=e.results,a.searchModel=e,delete a.searchModel.results,a.startTimer(),a.loading=!1})},a.paged=function(){a.visitor=null,a.search(o)},a.startTimer=function(){t.cancel(r),r=t(function(){n.clear(),a.$router.navigate(["Welcome"])},e.redirectTimeout)}}var t=angular.module("app");t.component("results",{bindings:{$router:"<"},templateUrl:"app/results.component.html",controller:["config","$timeout","visitorService",e]})}();
!function(){function e(e,t,r){var n,o=this;o.$onInit=function(){console.log("search init"),o.searchTerm=t.getTerm(),o.startTimer()},o.gotoWelcome=function(){t.clear(),r.cancel(n),this.$router.navigate(["Welcome"])},o.gotoSearchResults=function(){t.setTerm(o.searchTerm),r.cancel(n),this.$router.navigate(["Results"])},o.startTimer=function(){r.cancel(n),n=r(function(){t.clear(),o.$router.navigate(["Welcome"])},e.redirectTimeout)}}var t=angular.module("app");t.component("search",{bindings:{$router:"<"},templateUrl:"app/search.component.html",controller:["config","visitorService","$timeout",e]})}();
!function(){function t(){var t=this;t.$onInit=function(){console.log("welcome init")},this.$routerOnActivate=function(t){},t.gotoRegister=function(){this.$router.navigate(["Register"])},t.gotoSearch=function(){this.$router.navigate(["Search"])}}var o=angular.module("app");o.component("welcome",{bindings:{$router:"<"},templateUrl:"app/welcome.component.html",controller:[t]})}();
angular.module("onScreenKeyboard",["ngSanitize"]).directive("onScreenKeyboard",["$timeout","$document",function(t,e){"use strict";return{restrict:"E",bindToController:!0,controllerAs:"ctrl",scope:{rows:"=?",uppercaseAllWords:"@"},controller:["$sce",function(t){var e=this;e.rows||(e.rows=[["1","2","3","4","5","6","7","8","9","0",{type:"erase",colspan:2,text:"&lArr;"}],["q","w","e","r","t","y","u","i","o","p","@"],["a","s","d","f","g","h","j","k","l","-","_",{type:"margin"}],[{type:"shift"},"z","x","c","v","b","n","m",",",".",{type:"shift"}],[{type:"margin"},{type:"space",colspan:9,text:" "}]]),e.getText=function(e){if("margin"===e.type)return"";if("shift"===e.type)return"&dArr;";var r=e.text||e;return r&&r.indexOf("&")>-1?t.trustAsHtml(r):r}}],link:function(r,n,s){var a=r.ctrl;n.bind("contextmenu",function(t){return t.preventDefault(),!1}),a.isUpperCase=!1,a.lastInputCtrl=null,a.startPos=null,a.endPos=null,a.printKeyStroke=function(t){if(a.lastInputCtrl){var e=angular.element(t.target||t.srcElement);if(e.hasClass("erase"))return void a.eraseKeyStroke();if(e.hasClass("shift"))return void a.inverseCase();var r=angular.element(a.lastInputCtrl),n=r.val(),s=n.substring(0,a.startPos),l=n.substring(a.endPos,n.length);r.val(s+e.text()+l),r.triggerHandler("change"),a.startPos++,a.endPos++,a.setKeyboardLayout()}},a.inverseCase=function(){},a.refocus=function(){a.lastInputCtrl.focus()},a.eraseKeyStroke=function(){if(a.lastInputCtrl){var t=a.startPos!==a.endPos,e=angular.element(a.lastInputCtrl),r=e.val(),n=r.substring(0,t?a.startPos:a.startPos-1),s=r.substring(a.endPos,r.length);e.val(n+s),e.triggerHandler("change"),t?a.endPos=a.startPos:(a.startPos--,a.endPos--),a.lastInputCtrl.selectionStart=a.startPos,a.lastInputCtrl.selectionEnd=a.startPos,a.setKeyboardLayout(),a.refocus()}},a.setKeyboardLayout=function(){return a.lastInputCtrl?void(a.lastInputCtrl.className&&a.isUpperCase?a.inverseCase():0===angular.element(a.lastInputCtrl).val().length?a.isUpperCase||(a.isUpperCase=!1,a.inverseCase()):" "===angular.element(a.lastInputCtrl).val().slice(-1)&&!a.isUpperCase&&s.hasOwnProperty("uppercaseAllWords")?a.inverseCase():(a.isUpperCase=!0,a.inverseCase())):(a.isUpperCase=!1,void a.inverseCase())},e.find("input").bind("blur focus",function(){a.setKeyboardLayout(),a.lastInputCtrl=this,a.lastInputCtrl&&"checkbox"!==a.lastInputCtrl.type&&(a.startPos=a.lastInputCtrl.selectionStart,a.endPos=a.lastInputCtrl.selectionEnd)}).bind("keydown",function(){a.startPos=a.lastInputCtrl.selectionStart,a.endPos=a.lastInputCtrl.selectionEnd}),t(function(){a.inverseCase()},0)},templateUrl:"/templates/angular-on-screen-keyboard.html"}}]),angular.module("onScreenKeyboard").run(["$templateCache",function(t){"use strict";t.put("/templates/angular-on-screen-keyboard.html","<div class=keyboard><table><tr ng-repeat=\"row in ctrl.rows\"><td ng-repeat=\"key in row\" ng-click=ctrl.printKeyStroke($event) colspan=\"{{key.colspan || 1}}\" ng-class=\"{'button': key.type !== 'margin', 'letter': key.type !== 'margin'}\" class={{key.type}} ng-bind-html=ctrl.getText(key)></td></tr></table></div>")}]);
angular.module("app").directive("blacklist",["$timeout","$q","censorService",function(e,r,t){return{restrict:"A",require:"ngModel",link:function(e,i,n,c){function o(e){for(var r=t.get(),i=0;i<r.length;i++)if(e.toUpperCase().match((".*"+r[i].trim()+".*").replace(" ",".*")))return!1;return!0}c.$asyncValidators.blacklist=function(e,t){if(c.$isEmpty(e))return r.resolve();var i=r.defer();return o(e)?i.resolve():i.reject(),i.promise}}}}]);
angular.module("utils.autofocus",[]).directive("autofocus",["$timeout",function(u){return{restrict:"A",link:function(t,o){u(function(){o[0].focus()})}}}]);
!function(){function n(n,t,r){var c=[];return{set:function(n){c=n},get:function(){return c}}}var t=angular.module("app");t.factory("censorService",["$q","$http","config",n])}();
!function(){function n(n,t){function e(){s={}}function r(){g=""}function o(){return s}function c(){return g}function i(n){s=n}function u(n){g=n}function a(e){return n.get(t.apiUrl,{params:e}).then(function(n){return n.data})}function f(e){n.post(t.apiUrl,s).then(function(n){console.log("saved new visitor",s)}).catch(function(n){console.error("something went wrong",n.message)})}var s={},g="";return{clear:e,clearTerm:r,get:o,getTerm:c,set:i,setTerm:u,save:f,search:a}}var t=angular.module("app");t.factory("visitorService",["$http","config",n])}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJmaW5pc2guY29tcG9uZW50LmpzIiwicGxlZGdlLmNvbXBvbmVudC5qcyIsInJlZ2lzdGVyLmNvbXBvbmVudC5qcyIsInJlc3VsdHMuY29tcG9uZW50LmpzIiwic2VhcmNoLmNvbXBvbmVudC5qcyIsIndlbGNvbWUuY29tcG9uZW50LmpzIiwiZGlyZWN0aXZlcy9hbmd1bGFyLW9uLXNjcmVlbi1rZXlib2FyZC5qcyIsImRpcmVjdGl2ZXMvYmxhY2tsaXN0LmRpcmVjdGl2ZS5qcyIsImRpcmVjdGl2ZXMvdXRpbC5hdXRvZm9jdXMuanMiLCJzZXJ2aWNlcy9jZW5zb3Iuc2VydmljZS5qcyIsInNlcnZpY2VzL3Zpc2l0b3Iuc2VydmljZS5qcyJdLCJuYW1lcyI6WyJtb2R1bGUiLCJhbmd1bGFyIiwiY29tcG9uZW50IiwidGVtcGxhdGUiLCIkcm91dGVDb25maWciLCJwYXRoIiwibmFtZSIsInVzZUFzRGVmYXVsdCIsInZhbHVlIiwiaG9zdCIsIndpbmRvdyIsImxvY2F0aW9uIiwiaG9zdG5hbWUiLCJhcGlVcmxCYXNlIiwiYXBpVXJsIiwiaHViVXJsIiwicmVkaXJlY3RUaW1lb3V0IiwiZmluaXNoVGltZW91dCIsImtpb3NrIiwicnVuIiwiY29uZmlnIiwiY2Vuc29yIiwiJGh0dHAiLCJjb250cm9sbGVyIiwidmlzaXRvciIsIiR0aW1lb3V0IiwiJGN0cmwiLCJ0aGlzIiwiJG9uSW5pdCIsImNvbnNvbGUiLCJsb2ciLCIkIiwiY29ubmVjdGlvbiIsImh1YiIsInVybCIsIm5hbWVOb3RpZmljYXRpb25IdWIiLCJzdGFydCIsImRvbmUiLCJzZXJ2ZXIiLCJhZGROYW1lIiwiZ2V0IiwiY291bnREb3duX3RpY2siLCJzdGFydFRpbWVyIiwiJHJvdXRlck9uQWN0aXZhdGUiLCJuZXh0IiwiJHJvdXRlciIsImNsZWFyIiwibmF2aWdhdGUiLCJiaW5kaW5ncyIsInRlbXBsYXRlVXJsIiwidGltZXIiLCJnb3RvV2VsY29tZSIsImNhbmNlbCIsImdvdG9SZWdpc3RlciIsInBsZWRnZSIsImlkIiwic2F2ZSIsIiRzY29wZSIsImNyZWF0ZVZhbGlkYXRpb25XYXRjaGVyIiwiJHdhdGNoQ29sbGVjdGlvbiIsInZhbCIsInVuZGVmaW5lZCIsImZpcnN0bmFtZSIsImxhc3RuYW1lIiwicmVwbGFjZSIsImxlbmd0aCIsInZhbGlkIiwiY2hlY2tBcnJheSIsInRvVXBwZXJDYXNlIiwiZm9ybSIsIiRzZXRWYWxpZGl0eSIsInN0ciIsImFyciIsImkiLCJtYXRjaCIsInRyaW0iLCJ0aGVuIiwiciIsImxpc3QiLCJkYXRhIiwiZm9yRWFjaCIsIml0ZW0iLCJ3b3JkIiwicHVzaCIsInNldCIsImdvdG9QbGVkZ2UiLCJ0YWJsZVN0YXRlUmVmIiwicGFnZVNpemVEZWZhdWx0Iiwic2VhcmNoTW9kZWwiLCJwYWdlIiwicGFnZVNpemUiLCJwYWdpbmciLCJjdXJyZW50UGFnZSIsIm5hbWVzIiwiZ2V0VGVybSIsInNwbGl0Iiwic2VhcmNoIiwiZ290b1NlYXJjaCIsImNsZWFyVGVybSIsInRvZ2dsZU5hbWUiLCJ2IiwidGFibGVTdGF0ZSIsImxvYWRpbmciLCJ2aXNpdG9ycyIsInJlc3VsdHMiLCJwYWdlZCIsInNlYXJjaFRlcm0iLCJnb3RvU2VhcmNoUmVzdWx0cyIsInNldFRlcm0iLCJkaXJlY3RpdmUiLCJhIiwiYiIsInJlc3RyaWN0IiwiYmluZFRvQ29udHJvbGxlciIsImNvbnRyb2xsZXJBcyIsInNjb3BlIiwicm93cyIsInVwcGVyY2FzZUFsbFdvcmRzIiwidHlwZSIsImNvbHNwYW4iLCJ0ZXh0IiwiZ2V0VGV4dCIsImMiLCJpbmRleE9mIiwidHJ1c3RBc0h0bWwiLCJsaW5rIiwiZCIsImUiLCJmIiwiY3RybCIsImJpbmQiLCJwcmV2ZW50RGVmYXVsdCIsImlzVXBwZXJDYXNlIiwibGFzdElucHV0Q3RybCIsInN0YXJ0UG9zIiwiZW5kUG9zIiwicHJpbnRLZXlTdHJva2UiLCJlbGVtZW50IiwidGFyZ2V0Iiwic3JjRWxlbWVudCIsImhhc0NsYXNzIiwiZXJhc2VLZXlTdHJva2UiLCJpbnZlcnNlQ2FzZSIsInN1YnN0cmluZyIsImciLCJ0cmlnZ2VySGFuZGxlciIsInNldEtleWJvYXJkTGF5b3V0IiwicmVmb2N1cyIsImZvY3VzIiwic2VsZWN0aW9uU3RhcnQiLCJzZWxlY3Rpb25FbmQiLCJjbGFzc05hbWUiLCJzbGljZSIsImhhc093blByb3BlcnR5IiwiZmluZCIsIiR0ZW1wbGF0ZUNhY2hlIiwicHV0IiwiJHEiLCJyZXF1aXJlIiwiZWxtIiwiYXR0cnMiLCIkYXN5bmNWYWxpZGF0b3JzIiwiYmxhY2tsaXN0IiwibW9kZWxWYWx1ZSIsInZpZXdWYWx1ZSIsIiRpc0VtcHR5IiwicmVzb2x2ZSIsImRlZiIsImRlZmVyIiwicmVqZWN0IiwicHJvbWlzZSIsIiRlbGVtZW50IiwiZmFjdG9yeSIsImpzb24iLCJ0ZXJtIiwidCIsIm1vZGVsIiwicGFyYW1zIiwicG9zdCIsImNhdGNoIiwiZXJyIiwiZXJyb3IiLCJtZXNzYWdlIl0sIm1hcHBpbmdzIjoiQ0FDQSxXQUNJLEdBQUlBLEdBQVNDLFFBQVFELE9BQU8sT0FDeEIsb0JBQ0EsWUFDQSxlQUNBLGFBQ0EsbUJBQ0Esa0JBQ0EsNEJBR0pBLEdBQU9FLFVBQVUsU0FFVEMsU0FBVSxxQ0FDVkMsZUFDTUMsS0FBTSxJQUFLQyxLQUFNLFVBQVdKLFVBQVcsVUFBV0ssY0FBYyxJQUNoRUYsS0FBTSxZQUFhQyxLQUFNLFdBQVlKLFVBQVcsYUFDaERHLEtBQU0sVUFBV0MsS0FBTSxTQUFVSixVQUFXLFdBQzVDRyxLQUFNLFVBQVdDLEtBQU0sU0FBVUosVUFBVyxXQUM1Q0csS0FBTSxVQUFXQyxLQUFNLFNBQVVKLFVBQVcsV0FDNUNHLEtBQU0sV0FBWUMsS0FBTSxVQUFXSixVQUFXLGNBSTVERixFQUFPUSxNQUFNLHVCQUF3QixTQUNyQ1IsRUFBT1EsTUFBTSxVQUVMQyxLQUFNQyxPQUFPQyxTQUFTQyxTQUN0QkMsV0FBWSw4QkFDWkMsT0FBUSxxQ0FDUkMsT0FBUSxpQ0FDUkMsZ0JBQWlCLElBQ2pCQyxjQUFlLEVBQ2ZD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QUFRLGlCQUFrQixLQUFNLFFBQVMsU0FBVUE7Q0N4RDlELFdBR0ksUUFBU0EsR0FBUXRKLEVBQU9GLEdBZXBCLFFBQVMwQixLQUNMdEIsS0FHSixRQUFTMEUsS0FDTDRFLEVBQU8sR0FHWCxRQUFTdEksS0FDTCxNQUFPaEIsR0FHWCxRQUFTc0UsS0FDTCxNQUFPZ0YsR0FHWCxRQUFTMUYsR0FBSWdCLEdBQ1Q1RSxFQUFVNEUsRUFHZCxRQUFTUSxHQUFRbUUsR0FDYkQsRUFBT0MsRUFHWCxRQUFTL0UsR0FBT2dGLEdBQ1osTUFBTzFKLEdBQU1rQixJQUFJcEIsRUFBT04sUUFBVW1LLE9BQVFELElBQVNwRyxLQUFLLFNBQVVDLEdBQzlELE1BQU9BLEdBQUVFLE9BSWpCLFFBQVN2QixHQUFLNEMsR0FDVjlFLEVBQU00SixLQUFLOUosRUFBT04sT0FBUVUsR0FBU29ELEtBQUssU0FBVUMsR0FDOUNoRCxRQUFRQyxJQUFJLG9CQUFxQk4sS0FDbEMySixNQUFNLFNBQVVDLEdBQ2Z2SixRQUFRd0osTUFBTSx1QkFBd0JELEVBQUlFLFdBaERsRCxHQUFJOUosTUFDQXNKLEVBQU8sRUFFWCxRQUNJaEksTUFBT0EsRUFDUG9ELFVBQVdBLEVBQ1gxRCxJQUFLQSxFQUNMc0QsUUFBU0EsRUFDVFYsSUFBS0EsRUFDTHdCLFFBQVNBLEVBQ1RwRCxLQUFNQSxFQUNOd0MsT0FBUUEsR0FkaEIsR0FBSWhHLEdBQVNDLFFBQVFELE9BQU8sTUF5RDVCQSxHQUFPNEssUUFBUSxrQkFBbUIsUUFBUyxTQUFVQSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLy9hcHAubW9kdWxlLmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcsIFtcclxuICAgICAgICAnbmdDb21wb25lbnRSb3V0ZXInLFxyXG4gICAgICAgICduZ0FuaW1hdGUnLFxyXG4gICAgICAgICd1aS5ib290c3RyYXAnLFxyXG4gICAgICAgICduZ01lc3NhZ2VzJyxcclxuICAgICAgICAnb25TY3JlZW5LZXlib2FyZCcsXHJcbiAgICAgICAgJ3V0aWxzLmF1dG9mb2N1cycsXHJcbiAgICAgICAgJ3RyZWFzdXJlLW92ZXJsYXktc3Bpbm5lcidcclxuICAgIF0pO1xyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ2tpb3NrJyxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPG5nLW91dGxldD5Mb2FkaW5nIC4uPC9uZy1vdXRsZXQgPicsXHJcbiAgICAgICAgICAgICRyb3V0ZUNvbmZpZzogW1xyXG4gICAgICAgICAgICAgICAgeyBwYXRoOiAnLycsIG5hbWU6ICdXZWxjb21lJywgY29tcG9uZW50OiAnd2VsY29tZScsIHVzZUFzRGVmYXVsdDogdHJ1ZSB9LFxyXG4gICAgICAgICAgICAgICAgeyBwYXRoOiAnL3JlZ2lzdGVyJywgbmFtZTogJ1JlZ2lzdGVyJywgY29tcG9uZW50OiAncmVnaXN0ZXInIH0sXHJcbiAgICAgICAgICAgICAgICB7IHBhdGg6ICcvcGxlZGdlJywgbmFtZTogJ1BsZWRnZScsIGNvbXBvbmVudDogJ3BsZWRnZScgfSxcclxuICAgICAgICAgICAgICAgIHsgcGF0aDogJy9maW5pc2gnLCBuYW1lOiAnRmluaXNoJywgY29tcG9uZW50OiAnZmluaXNoJyB9LFxyXG4gICAgICAgICAgICAgICAgeyBwYXRoOiAnL3NlYXJjaCcsIG5hbWU6ICdTZWFyY2gnLCBjb21wb25lbnQ6ICdzZWFyY2gnIH0sXHJcbiAgICAgICAgICAgICAgICB7IHBhdGg6ICcvcmVzdWx0cycsIG5hbWU6ICdSZXN1bHRzJywgY29tcG9uZW50OiAncmVzdWx0cycgfVxyXG4gICAgICAgICAgICBdXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgbW9kdWxlLnZhbHVlKCckcm91dGVyUm9vdENvbXBvbmVudCcsICdraW9zaycpO1xyXG4gICAgbW9kdWxlLnZhbHVlKCdjb25maWcnLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaG9zdDogd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lLFxyXG4gICAgICAgICAgICBhcGlVcmxCYXNlOiAnaHR0cDovL2xvY2FsaG9zdDo0OTk2MC9hcGkvJyxcclxuICAgICAgICAgICAgYXBpVXJsOiAnaHR0cDovL2xvY2FsaG9zdDo0OTk2MC9hcGkvdmlzaXRvcicsXHJcbiAgICAgICAgICAgIGh1YlVybDogJ2h0dHA6Ly9sb2NhbGhvc3Q6NDk5NjAvc2lnbmFscicsXHJcbiAgICAgICAgICAgIHJlZGlyZWN0VGltZW91dDogMzAwMDAsXHJcbiAgICAgICAgICAgIGZpbmlzaFRpbWVvdXQ6IDQsXHJcbiAgICAgICAgICAgIGtpb3NrOiAxXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgbW9kdWxlLnJ1bihbJ2NvbmZpZycsICdjZW5zb3JTZXJ2aWNlJywgJyRodHRwJywgZnVuY3Rpb24gKGNvbmZpZywgY2Vuc29yLCAkaHR0cCkge1xyXG4gICAgICAgIHN3aXRjaCAoY29uZmlnLmhvc3QpIHtcclxuICAgICAgICAgICAgY2FzZSAnY3JtY2tpb3NrJzpcclxuICAgICAgICAgICAgICAgIGNvbmZpZy5hcGlVcmxCYXNlID0gJ2h0dHA6Ly9jcm1jL2FwaS8nLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbmZpZy5hcGlVcmwgPSAnaHR0cDovL2NybWMvYXBpL3Zpc2l0b3InO1xyXG4gICAgICAgICAgICAgICAgY29uZmlnLmh1YlVybCA9ICdodHRwOi8vY3JtYy9zaWduYWxyJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdjcm1ja2lvc2stdGVzdC5zcGxjZW50ZXIub3JnJzpcclxuICAgICAgICAgICAgICAgIGNvbmZpZy5hcGlVcmxCYXNlID0gJ2h0dHA6Ly9jcm1jLXRlc3QvYXBpLycsXHJcbiAgICAgICAgICAgICAgICAgICAgY29uZmlnLmFwaVVybCA9ICdodHRwOi8vY3JtYy10ZXN0L2FwaS92aXNpdG9yJztcclxuICAgICAgICAgICAgICAgIGNvbmZpZy5odWJVcmwgPSAnaHR0cDovL2NybWMtdGVzdC9zaWduYWxyJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdjcm1ja2lvc2suc3BsY2VudGVyLm9yZyc6XHJcbiAgICAgICAgICAgICAgICBjb25maWcuYXBpVXJsQmFzZSA9ICdodHRwOi8vY3JtYy9hcGkvJyxcclxuICAgICAgICAgICAgICAgICAgICBjb25maWcuYXBpVXJsID0gJ2h0dHA6Ly9jcm1jL2FwaS92aXNpdG9yJztcclxuICAgICAgICAgICAgICAgIGNvbmZpZy5odWJVcmwgPSAnaHR0cDovL2NybWMvc2lnbmFscic7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgZGVmYXVsdDpcclxuXHJcbiAgICAgICAgfVxyXG4gICAgICAgIFxyXG4gICAgfV0pO1xyXG5cclxufVxyXG4pKCk7IiwiLy9maW5pc2guY29tcG9uZW50LmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xyXG4gICAgLy9UT0RPOiBTRVQvR0VUIGtpb3NrIG51bWJlciBmcm9tIGxvY2FsIHN0b3JhZ2VcclxuICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoY29uZmlnLCB2aXNpdG9yLCAkdGltZW91dCkge1xyXG4gICAgICAgIHZhciAkY3RybCA9IHRoaXM7XHJcblxyXG4gICAgICAgICRjdHJsLiRvbkluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdmaW5pc2ggaW5pdCcsIGNvbmZpZyk7XHJcbiAgICAgICAgICAgICQuY29ubmVjdGlvbi5odWIudXJsID0gY29uZmlnLmh1YlVybDtcclxuICAgICAgICAgICAgdmFyIGh1YiA9ICQuY29ubmVjdGlvbi5uYW1lTm90aWZpY2F0aW9uSHViO1xyXG4gICAgICAgICAgICAkLmNvbm5lY3Rpb24uaHViLnN0YXJ0KCkuZG9uZShmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdodWIgY29ubmVjdGlvbiBzdGFydGVkJyk7XHJcbiAgICAgICAgICAgICAgICBodWIuc2VydmVyLmFkZE5hbWUoMSwgdmlzaXRvci5nZXQoKSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgJGN0cmwuY291bnREb3duX3RpY2sgPSBjb25maWcuZmluaXNoVGltZW91dDtcclxuICAgICAgICAgICAgJGN0cmwuc3RhcnRUaW1lcigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy4kcm91dGVyT25BY3RpdmF0ZSA9IGZ1bmN0aW9uIChuZXh0KSB7XHJcbiAgICAgICAgICAgICRjdHJsLiRyb3V0ZXIgPSB0aGlzLiRyb3V0ZXI7IFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgICRjdHJsLnN0YXJ0VGltZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICgkY3RybC5jb3VudERvd25fdGljayA8PSAwKSB7XHJcbiAgICAgICAgICAgICAgICB2aXNpdG9yLmNsZWFyKCk7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygndGltZXIgZmluaXNoZWQnKTtcclxuICAgICAgICAgICAgICAgICRjdHJsLiRyb3V0ZXIubmF2aWdhdGUoWydXZWxjb21lJ10pO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuY291bnREb3duX3RpY2stLTtcclxuICAgICAgICAgICAgICAgICR0aW1lb3V0KCRjdHJsLnN0YXJ0VGltZXIsIDEwMDApO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW9kdWxlLmNvbXBvbmVudCgnZmluaXNoJyxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJpbmRpbmdzOiB7XHJcbiAgICAgICAgICAgICAgICAkcm91dGVyOiAnPCdcclxuICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvZmluaXNoLmNvbXBvbmVudC5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogWydjb25maWcnLCAndmlzaXRvclNlcnZpY2UnLCAnJHRpbWVvdXQnLCBjb250cm9sbGVyXVxyXG4gICAgICAgIH0pO1xyXG59XHJcbikoKTsiLCIvL3BsZWRnZS5jb21wb25lbnQuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7XHJcbiAgICAvL1RPRE86IEdFVCBodWIgdXJsIGZyb20gc2V0dGluZ3NcclxuICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoJHRpbWVvdXQsIGNvbmZpZywgdmlzaXRvcikge1xyXG4gICAgICAgIHZhciAkY3RybCA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHRpbWVyOyBcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3BsZWRnZSBpbml0Jyk7XHJcbiAgICAgICAgICAgICRjdHJsLnZpc2l0b3IgPSB2aXNpdG9yLmdldCgpO1xyXG4gICAgICAgICAgICAkY3RybC5zdGFydFRpbWVyKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLiRyb3V0ZXJPbkFjdGl2YXRlID0gZnVuY3Rpb24gKG5leHQpIHsgfTtcclxuXHJcbiAgICAgICAgJGN0cmwuZ290b1dlbGNvbWUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZpc2l0b3IuY2xlYXIoKTtcclxuICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKHRpbWVyKTtcclxuICAgICAgICAgICAgdGhpcy4kcm91dGVyLm5hdmlnYXRlKFsnV2VsY29tZSddKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmdvdG9SZWdpc3RlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKHRpbWVyKTtcclxuICAgICAgICAgICAgdGhpcy4kcm91dGVyLm5hdmlnYXRlKFsnUmVnaXN0ZXInXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5wbGVkZ2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGlmICghdmlzaXRvci5nZXQoKS5pZCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3NhdmUgbmV3IHZpc2l0b3InLCB2aXNpdG9yLmdldCgpKTtcclxuICAgICAgICAgICAgICAgIHZpc2l0b3Iuc2F2ZSgpO1xyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3JldHVybmluZyB2aXNpdG9yJywgdmlzaXRvci5nZXQoKSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKHRpbWVyKTtcclxuICAgICAgICAgICAgdGhpcy4kcm91dGVyLm5hdmlnYXRlKFsnRmluaXNoJ10pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuc3RhcnRUaW1lciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKHRpbWVyKTtcclxuICAgICAgICAgICAgdGltZXIgPSAkdGltZW91dChmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB2aXNpdG9yLmNsZWFyKCk7XHJcbiAgICAgICAgICAgICAgICAkY3RybC4kcm91dGVyLm5hdmlnYXRlKFsnV2VsY29tZSddKTtcclxuICAgICAgICAgICAgfSwgY29uZmlnLnJlZGlyZWN0VGltZW91dCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb2R1bGUuY29tcG9uZW50KCdwbGVkZ2UnLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgICAgICRyb3V0ZXI6ICc8J1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9wbGVkZ2UuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiBbJyR0aW1lb3V0JywgJ2NvbmZpZycsICd2aXNpdG9yU2VydmljZScsIGNvbnRyb2xsZXJdXHJcbiAgICAgICAgfSk7XHJcbn1cclxuKSgpOyIsIi8vcmVnaXN0ZXIuY29tcG9uZW50LmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoY29uZmlnLCB2aXNpdG9yLCAkdGltZW91dCwgJHNjb3BlLCAkaHR0cCwgY2Vuc29yKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuICAgICAgICB2YXIgdGltZXI7XHJcblxyXG4gICAgICAgICRjdHJsLiRvbkluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICRjdHJsLnZpc2l0b3IgPSB2aXNpdG9yLmdldCgpO1xyXG4gICAgICAgICAgICAkaHR0cC5nZXQoY29uZmlnLmFwaVVybEJhc2UgKyAnY2Vuc29yJykudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2dldHRpbmcgZGF0YSBmcm9tIHVyaScpO1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldChjb25maWcuYXBpVXJsQmFzZSArICdjZW5zb3InKS50aGVuKGZ1bmN0aW9uIChyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGxpc3QgPSBbXTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoci5kYXRhLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgci5kYXRhLmZvckVhY2goZnVuY3Rpb24gKGl0ZW0pIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChpdGVtLndvcmQgIT09IG51bGwpIGxpc3QucHVzaChpdGVtLndvcmQucmVwbGFjZSgvIC9nLCBcIlwiKS50b1VwcGVyQ2FzZSgpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIGNlbnNvci5zZXQobGlzdCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgICBjcmVhdGVWYWxpZGF0aW9uV2F0Y2hlcigpO1xyXG4gICAgICAgICAgICAkY3RybC5zdGFydFRpbWVyKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLiRyb3V0ZXJPbkFjdGl2YXRlID0gZnVuY3Rpb24gKG5leHQpIHtcclxuICAgICAgICAgICAgJGN0cmwuJHJvdXRlciA9IHRoaXMuJHJvdXRlcjtcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkY3RybC5nb3RvV2VsY29tZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKHRpbWVyKTtcclxuICAgICAgICAgICAgdGhpcy4kcm91dGVyLm5hdmlnYXRlKFsnV2VsY29tZSddKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmdvdG9QbGVkZ2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICR0aW1lb3V0LmNhbmNlbCh0aW1lcik7XHJcbiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5uYXZpZ2F0ZShbJ1BsZWRnZSddKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLnN0YXJ0VGltZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICR0aW1lb3V0LmNhbmNlbCh0aW1lcik7XHJcbiAgICAgICAgICAgIHRpbWVyID0gJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmlzaXRvci5jbGVhcigpO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuJHJvdXRlci5uYXZpZ2F0ZShbJ1dlbGNvbWUnXSk7XHJcbiAgICAgICAgICAgIH0sIGNvbmZpZy5yZWRpcmVjdFRpbWVvdXQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlVmFsaWRhdGlvbldhdGNoZXIoKSB7XHJcblxyXG4gICAgICAgICAgICAkc2NvcGUuJHdhdGNoQ29sbGVjdGlvbignJGN0cmwudmlzaXRvcicsXHJcbiAgICAgICAgICAgICAgICBmdW5jdGlvbiAodmFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHZhbC5maXJzdG5hbWUgPT09IHVuZGVmaW5lZCkgcmV0dXJuO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBuYW1lID0gdmFsLmZpcnN0bmFtZSArIHZhbC5sYXN0bmFtZTtcclxuICAgICAgICAgICAgICAgICAgICBuYW1lID0gbmFtZS5yZXBsYWNlKC8gL2csIFwiXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChuYW1lLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIHZhbGlkID0gY2hlY2tBcnJheShuYW1lLnRvVXBwZXJDYXNlKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAkY3RybC5mb3JtLmxhc3RuYW1lLiRzZXRWYWxpZGl0eSgnYmxhY2tsaXN0JywgdmFsaWQpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGNoZWNrQXJyYXkoc3RyKSB7XHJcbiAgICAgICAgICAgIHZhciBhcnIgPSBjZW5zb3IuZ2V0KCk7XHJcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBpZiAoc3RyLm1hdGNoKChcIi4qXCIgKyBhcnJbaV0udHJpbSgpICsgXCIuKlwiKS5yZXBsYWNlKFwiIFwiLCBcIi4qXCIpKSkge1xyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ3JlZ2lzdGVyJyxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJpbmRpbmdzOiB7ICRyb3V0ZXI6ICc8JyB9LFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9yZWdpc3Rlci5jb21wb25lbnQuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnY29uZmlnJywgJ3Zpc2l0b3JTZXJ2aWNlJywgJyR0aW1lb3V0JywgJyRzY29wZScsICckaHR0cCcsICdjZW5zb3JTZXJ2aWNlJywgY29udHJvbGxlcl1cclxuICAgICAgICB9KTtcclxuXHJcblxyXG59XHJcbikoKTtcclxuIiwiLy9yZXN1bHRzLmNvbXBvbmVudC5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnKTtcclxuICAgIC8vVE9ETzogR0VUIGh1YiB1cmwgZnJvbSBzZXR0aW5nc1xyXG4gICAgZnVuY3Rpb24gY29udHJvbGxlcihjb25maWcsICR0aW1lb3V0LCB2aXNpdG9yKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuICAgICAgICB2YXIgdGltZXI7IFxyXG4gICAgICAgIHZhciBwYWdlU2l6ZURlZmF1bHQgPSAxMDtcclxuICAgICAgICB2YXIgdGFibGVTdGF0ZVJlZjtcclxuXHJcbiAgICAgICAgJGN0cmwuc2VhcmNoTW9kZWwgPSB7XHJcbiAgICAgICAgICAgIHBhZ2U6IDEsXHJcbiAgICAgICAgICAgIHBhZ2VTaXplOiBwYWdlU2l6ZURlZmF1bHRcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkY3RybC5wYWdpbmcgPSB7XHJcbiAgICAgICAgICAgIGN1cnJlbnRQYWdlOiAxXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC4kb25Jbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnc2VhcmNoIGluaXQnKTtcclxuICAgICAgICAgICAgY29uc3QgbmFtZXMgPSB2aXNpdG9yLmdldFRlcm0oKS5zcGxpdCgnICcpO1xyXG4gICAgICAgICAgICBpZiAobmFtZXMubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuc2VhcmNoTW9kZWwuZmlyc3RuYW1lID0gbmFtZXNbMF07IFxyXG4gICAgICAgICAgICAgICAgJGN0cmwuc2VhcmNoTW9kZWwubGFzdG5hbWUgPSBuYW1lc1sxXTsgXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5zZWFyY2hNb2RlbC5sYXN0bmFtZSA9IG5hbWVzWzBdOyBcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgJGN0cmwuc2VhcmNoKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5nb3RvV2VsY29tZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKHRpbWVyKTtcclxuICAgICAgICAgICAgdGhpcy4kcm91dGVyLm5hdmlnYXRlKFsnV2VsY29tZSddKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmdvdG9TZWFyY2ggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICR0aW1lb3V0LmNhbmNlbCh0aW1lcik7XHJcbiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5uYXZpZ2F0ZShbJ1NlYXJjaCddKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLnBsZWRnZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmlzaXRvci5jbGVhclRlcm0oKTtcclxuICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKHRpbWVyKTtcclxuICAgICAgICAgICAgdGhpcy4kcm91dGVyLm5hdmlnYXRlKFsnUGxlZGdlJ10pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwudG9nZ2xlTmFtZSA9IGZ1bmN0aW9uICh2KSB7XHJcbiAgICAgICAgICAgICRjdHJsLnZpc2l0b3IgPSB2O1xyXG4gICAgICAgICAgICB2aXNpdG9yLnNldCh2KTtcclxuICAgICAgICAgICAgJGN0cmwuc3RhcnRUaW1lcigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuc2VhcmNoID0gZnVuY3Rpb24gKHRhYmxlU3RhdGUpIHtcclxuICAgICAgICAgICAgdGFibGVTdGF0ZVJlZiA9IHRhYmxlU3RhdGU7XHJcbiAgICAgICAgICAgICRjdHJsLmxvYWRpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICByZXR1cm4gdmlzaXRvci5zZWFyY2goJGN0cmwuc2VhcmNoTW9kZWwpLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgICRjdHJsLnZpc2l0b3JzID0gci5yZXN1bHRzO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuc2VhcmNoTW9kZWwgPSByO1xyXG4gICAgICAgICAgICAgICAgZGVsZXRlICRjdHJsLnNlYXJjaE1vZGVsLnJlc3VsdHM7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5zdGFydFRpbWVyKCk7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5sb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0pOyBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLnBhZ2VkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkY3RybC52aXNpdG9yID0gbnVsbDsgXHJcbiAgICAgICAgICAgICRjdHJsLnNlYXJjaCh0YWJsZVN0YXRlUmVmKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLnN0YXJ0VGltZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICR0aW1lb3V0LmNhbmNlbCh0aW1lcik7XHJcbiAgICAgICAgICAgIHRpbWVyID0gJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmlzaXRvci5jbGVhcigpO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuJHJvdXRlci5uYXZpZ2F0ZShbJ1dlbGNvbWUnXSk7XHJcbiAgICAgICAgICAgIH0sIGNvbmZpZy5yZWRpcmVjdFRpbWVvdXQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW9kdWxlLmNvbXBvbmVudCgncmVzdWx0cycsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiaW5kaW5nczogeyAkcm91dGVyOiAnPCcgfSxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvcmVzdWx0cy5jb21wb25lbnQuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnY29uZmlnJywgJyR0aW1lb3V0JywgJ3Zpc2l0b3JTZXJ2aWNlJywgY29udHJvbGxlcl1cclxuICAgICAgICB9KTtcclxufVxyXG4pKCk7IiwiLy9zZWFyY2guY29tcG9uZW50LmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoY29uZmlnLCB2aXNpdG9yLCAkdGltZW91dCkge1xyXG4gICAgICAgIHZhciAkY3RybCA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHRpbWVyOyBcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3NlYXJjaCBpbml0Jyk7XHJcbiAgICAgICAgICAgICRjdHJsLnNlYXJjaFRlcm0gPSB2aXNpdG9yLmdldFRlcm0oKTtcclxuICAgICAgICAgICAgJGN0cmwuc3RhcnRUaW1lcigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuZ290b1dlbGNvbWUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZpc2l0b3IuY2xlYXIoKTtcclxuICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKHRpbWVyKTtcclxuICAgICAgICAgICAgdGhpcy4kcm91dGVyLm5hdmlnYXRlKFsnV2VsY29tZSddKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmdvdG9TZWFyY2hSZXN1bHRzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZpc2l0b3Iuc2V0VGVybSgkY3RybC5zZWFyY2hUZXJtKTsgXHJcbiAgICAgICAgICAgICR0aW1lb3V0LmNhbmNlbCh0aW1lcik7XHJcbiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5uYXZpZ2F0ZShbJ1Jlc3VsdHMnXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5zdGFydFRpbWVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkdGltZW91dC5jYW5jZWwodGltZXIpO1xyXG4gICAgICAgICAgICB0aW1lciA9ICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZpc2l0b3IuY2xlYXIoKTtcclxuICAgICAgICAgICAgICAgICRjdHJsLiRyb3V0ZXIubmF2aWdhdGUoWydXZWxjb21lJ10pO1xyXG4gICAgICAgICAgICB9LCBjb25maWcucmVkaXJlY3RUaW1lb3V0KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ3NlYXJjaCcsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiaW5kaW5nczogeyAkcm91dGVyOiAnPCcgfSxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvc2VhcmNoLmNvbXBvbmVudC5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogWydjb25maWcnLCAndmlzaXRvclNlcnZpY2UnLCAnJHRpbWVvdXQnLCBjb250cm9sbGVyXVxyXG4gICAgICAgIH0pO1xyXG59XHJcbikoKTsiLCIvL3dlbGNvbWUuY29tcG9uZW50LmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3dlbGNvbWUgaW5pdCcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy4kcm91dGVyT25BY3RpdmF0ZSA9IGZ1bmN0aW9uIChuZXh0KSB7IH07XHJcblxyXG4gICAgICAgICRjdHJsLmdvdG9SZWdpc3RlciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdGhpcy4kcm91dGVyLm5hdmlnYXRlKFsnUmVnaXN0ZXInXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5nb3RvU2VhcmNoID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLiRyb3V0ZXIubmF2aWdhdGUoWydTZWFyY2gnXSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ3dlbGNvbWUnLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYmluZGluZ3M6IHsgJHJvdXRlcjogJzwnIH0sXHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL3dlbGNvbWUuY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiBbY29udHJvbGxlcl1cclxuICAgICAgICB9KTtcclxuXHJcbn1cclxuKSgpOyIsImFuZ3VsYXIubW9kdWxlKFwib25TY3JlZW5LZXlib2FyZFwiLCBbXCJuZ1Nhbml0aXplXCJdKS5kaXJlY3RpdmUoXCJvblNjcmVlbktleWJvYXJkXCIsIFtcIiR0aW1lb3V0XCIsIFwiJGRvY3VtZW50XCIsIGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgcmVzdHJpY3Q6IFwiRVwiLFxyXG4gICAgICAgIGJpbmRUb0NvbnRyb2xsZXI6ICEwLFxyXG4gICAgICAgIGNvbnRyb2xsZXJBczogXCJjdHJsXCIsXHJcbiAgICAgICAgc2NvcGU6IHtcclxuICAgICAgICAgICAgcm93czogXCI9P1wiLFxyXG4gICAgICAgICAgICB1cHBlcmNhc2VBbGxXb3JkczogXCJAXCJcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNvbnRyb2xsZXI6IFtcIiRzY2VcIiwgZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSB0aGlzO1xyXG4gICAgICAgICAgICBiLnJvd3MgfHwgKGIucm93cyA9IFtcclxuICAgICAgICAgICAgICAgIFtcIjFcIiwgXCIyXCIsIFwiM1wiLCBcIjRcIiwgXCI1XCIsIFwiNlwiLCBcIjdcIiwgXCI4XCIsIFwiOVwiLCBcIjBcIiwge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiZXJhc2VcIixcclxuICAgICAgICAgICAgICAgICAgICBjb2xzcGFuOiAyLFxyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IFwiJmxBcnI7XCJcclxuICAgICAgICAgICAgICAgIH1dLFxyXG4gICAgICAgICAgICAgICAgW1wicVwiLCBcIndcIiwgXCJlXCIsIFwiclwiLCBcInRcIiwgXCJ5XCIsIFwidVwiLCBcImlcIiwgXCJvXCIsIFwicFwiLCBcIkBcIl0sXHJcbiAgICAgICAgICAgICAgICBbXCJhXCIsIFwic1wiLCBcImRcIiwgXCJmXCIsIFwiZ1wiLCBcImhcIiwgXCJqXCIsIFwia1wiLCBcImxcIiwgXCItXCIsIFwiX1wiLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJtYXJnaW5cIlxyXG4gICAgICAgICAgICAgICAgfV0sXHJcbiAgICAgICAgICAgICAgICBbe1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic2hpZnRcIlxyXG4gICAgICAgICAgICAgICAgfSwgXCJ6XCIsIFwieFwiLCBcImNcIiwgXCJ2XCIsIFwiYlwiLCBcIm5cIiwgXCJtXCIsIFwiLFwiLCBcIi5cIiwge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic2hpZnRcIlxyXG4gICAgICAgICAgICAgICAgfV0sXHJcbiAgICAgICAgICAgICAgICBbe1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwibWFyZ2luXCJcclxuICAgICAgICAgICAgICAgIH0sIHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInNwYWNlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgY29sc3BhbjogOSxcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiBcIiBcIlxyXG4gICAgICAgICAgICAgICAgfV1cclxuICAgICAgICAgICAgXSksXHJcbiAgICAgICAgICAgICAgICBiLmdldFRleHQgPSBmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChcIm1hcmdpblwiID09PSBiLnR5cGUpIHJldHVybiBcIlwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChcInNoaWZ0XCIgPT09IGIudHlwZSkgcmV0dXJuIFwiJmRBcnI7XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBiLnRleHQgfHwgYjtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYyAmJiBjLmluZGV4T2YoXCImXCIpID4gLTEgPyBhLnRydXN0QXNIdG1sKGMpIDogYztcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgfV0sXHJcbiAgICAgICAgbGluazogZnVuY3Rpb24gKGMsIGQsIGUpIHtcclxuICAgICAgICAgICAgdmFyIGYgPSBjLmN0cmw7XHJcbiAgICAgICAgICAgIGQuYmluZChcImNvbnRleHRtZW51XCIsIGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYS5wcmV2ZW50RGVmYXVsdCgpLCAhMTtcclxuICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICBmLmlzVXBwZXJDYXNlID0gITEsIGYubGFzdElucHV0Q3RybCA9IG51bGwsIGYuc3RhcnRQb3MgPSBudWxsLCBmLmVuZFBvcyA9IG51bGwsXHJcbiAgICAgICAgICAgICAgICBmLnByaW50S2V5U3Ryb2tlID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZi5sYXN0SW5wdXRDdHJsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiID0gYW5ndWxhci5lbGVtZW50KGEudGFyZ2V0IHx8IGEuc3JjRWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiLmhhc0NsYXNzKFwiZXJhc2VcIikpIHJldHVybiB2b2lkIGYuZXJhc2VLZXlTdHJva2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGIuaGFzQ2xhc3MoXCJzaGlmdFwiKSkgcmV0dXJuIHZvaWQgZi5pbnZlcnNlQ2FzZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IGFuZ3VsYXIuZWxlbWVudChmLmxhc3RJbnB1dEN0cmwpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZCA9IGMudmFsKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlID0gZC5zdWJzdHJpbmcoMCwgZi5zdGFydFBvcyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnID0gZC5zdWJzdHJpbmcoZi5lbmRQb3MsIGQubGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYy52YWwoZSArIGIudGV4dCgpICsgZyksIGMudHJpZ2dlckhhbmRsZXIoXCJjaGFuZ2VcIiksIGYuc3RhcnRQb3MrKyAsIGYuZW5kUG9zKysgLCBmLnNldEtleWJvYXJkTGF5b3V0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGYuaW52ZXJzZUNhc2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy92YXIgYSA9IGRbMF0ucXVlcnlTZWxlY3RvckFsbChcIi5sZXR0ZXJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9hbmd1bGFyLmZvckVhY2goYSwgZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICB2YXIgYiA9IGFuZ3VsYXIuZWxlbWVudChhKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICBmLmlzVXBwZXJDYXNlID8gYi50ZXh0KGIudGV4dCgpLnRvU3RyaW5nKCkudG9Mb3dlckNhc2UoKSkgOiBiLnRleHQoYi50ZXh0KCkudG9TdHJpbmcoKS50b1VwcGVyQ2FzZSgpKTtcclxuICAgICAgICAgICAgICAgICAgICAvL30pLCBhbmd1bGFyLmZvckVhY2goZFswXS5xdWVyeVNlbGVjdG9yQWxsKFwiLnNoaWZ0XCIpLCBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgIGYuaXNVcHBlckNhc2UgPyBhbmd1bGFyLmVsZW1lbnQoYSkuaHRtbChcIiZkQXJyO1wiKSA6IGFuZ3VsYXIuZWxlbWVudChhKS5odG1sKFwiJnVBcnI7XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vfSksIGYuaXNVcHBlckNhc2UgPSAhZi5pc1VwcGVyQ2FzZTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBmLnJlZm9jdXMgPSBmdW5jdGlvbiAoKSB7IGYubGFzdElucHV0Q3RybC5mb2N1cygpIH0sXHJcbiAgICAgICAgICAgICAgICBmLmVyYXNlS2V5U3Ryb2tlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChmLmxhc3RJbnB1dEN0cmwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBmLnN0YXJ0UG9zICE9PSBmLmVuZFBvcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIgPSBhbmd1bGFyLmVsZW1lbnQoZi5sYXN0SW5wdXRDdHJsKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBiLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZCA9IGMuc3Vic3RyaW5nKDAsIGEgPyBmLnN0YXJ0UG9zIDogZi5zdGFydFBvcyAtIDEpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZSA9IGMuc3Vic3RyaW5nKGYuZW5kUG9zLCBjLmxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGIudmFsKGQgKyBlKSwgYi50cmlnZ2VySGFuZGxlcihcImNoYW5nZVwiKSwgYSA/IGYuZW5kUG9zID0gZi5zdGFydFBvcyA6IChmLnN0YXJ0UG9zLS0gLCBmLmVuZFBvcy0tKSwgZi5sYXN0SW5wdXRDdHJsLnNlbGVjdGlvblN0YXJ0ID0gZi5zdGFydFBvcywgZi5sYXN0SW5wdXRDdHJsLnNlbGVjdGlvbkVuZCA9IGYuc3RhcnRQb3MsIGYuc2V0S2V5Ym9hcmRMYXlvdXQoKSwgZi5yZWZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSwgZi5zZXRLZXlib2FyZExheW91dCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZi5sYXN0SW5wdXRDdHJsID8gdm9pZCAoZi5sYXN0SW5wdXRDdHJsLmNsYXNzTmFtZSAmJiBmLmlzVXBwZXJDYXNlID8gZi5pbnZlcnNlQ2FzZSgpIDogMCA9PT0gYW5ndWxhci5lbGVtZW50KGYubGFzdElucHV0Q3RybCkudmFsKCkubGVuZ3RoID8gZi5pc1VwcGVyQ2FzZSB8fCAoZi5pc1VwcGVyQ2FzZSA9ICExLCBmLmludmVyc2VDYXNlKCkpIDogXCIgXCIgPT09IGFuZ3VsYXIuZWxlbWVudChmLmxhc3RJbnB1dEN0cmwpLnZhbCgpLnNsaWNlKC0xKSAmJiAhZi5pc1VwcGVyQ2FzZSAmJiBlLmhhc093blByb3BlcnR5KFwidXBwZXJjYXNlQWxsV29yZHNcIikgPyBmLmludmVyc2VDYXNlKCkgOiAoZi5pc1VwcGVyQ2FzZSA9ICEwLCBmLmludmVyc2VDYXNlKCkpKSA6IChmLmlzVXBwZXJDYXNlID0gITEsIHZvaWQgZi5pbnZlcnNlQ2FzZSgpKTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBiLmZpbmQoXCJpbnB1dFwiKS5iaW5kKFwiYmx1ciBmb2N1c1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZi5zZXRLZXlib2FyZExheW91dCgpLCBmLmxhc3RJbnB1dEN0cmwgPSB0aGlzLCBmLmxhc3RJbnB1dEN0cmwgJiYgXCJjaGVja2JveFwiICE9PSBmLmxhc3RJbnB1dEN0cmwudHlwZSAmJiAoZi5zdGFydFBvcyA9IGYubGFzdElucHV0Q3RybC5zZWxlY3Rpb25TdGFydCwgZi5lbmRQb3MgPSBmLmxhc3RJbnB1dEN0cmwuc2VsZWN0aW9uRW5kKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmJpbmQoXCJrZXlkb3duXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZi5zdGFydFBvcyA9IGYubGFzdElucHV0Q3RybC5zZWxlY3Rpb25TdGFydCwgZi5lbmRQb3MgPSBmLmxhc3RJbnB1dEN0cmwuc2VsZWN0aW9uRW5kO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICAgICAgYShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZi5pbnZlcnNlQ2FzZSgpO1xyXG4gICAgICAgICAgICAgICAgfSwgMCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICB0ZW1wbGF0ZVVybDogXCIvdGVtcGxhdGVzL2FuZ3VsYXItb24tc2NyZWVuLWtleWJvYXJkLmh0bWxcIlxyXG4gICAgfTtcclxufV0pOztcclxuYW5ndWxhci5tb2R1bGUoJ29uU2NyZWVuS2V5Ym9hcmQnKS5ydW4oWyckdGVtcGxhdGVDYWNoZScsIGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgICR0ZW1wbGF0ZUNhY2hlLnB1dCgnL3RlbXBsYXRlcy9hbmd1bGFyLW9uLXNjcmVlbi1rZXlib2FyZC5odG1sJyxcclxuICAgICAgICBcIjxkaXYgY2xhc3M9a2V5Ym9hcmQ+PHRhYmxlPjx0ciBuZy1yZXBlYXQ9XFxcInJvdyBpbiBjdHJsLnJvd3NcXFwiPjx0ZCBuZy1yZXBlYXQ9XFxcImtleSBpbiByb3dcXFwiIG5nLWNsaWNrPWN0cmwucHJpbnRLZXlTdHJva2UoJGV2ZW50KSBjb2xzcGFuPVxcXCJ7e2tleS5jb2xzcGFuIHx8IDF9fVxcXCIgbmctY2xhc3M9XFxcInsnYnV0dG9uJzoga2V5LnR5cGUgIT09ICdtYXJnaW4nLCAnbGV0dGVyJzoga2V5LnR5cGUgIT09ICdtYXJnaW4nfVxcXCIgY2xhc3M9e3trZXkudHlwZX19IG5nLWJpbmQtaHRtbD1jdHJsLmdldFRleHQoa2V5KT48L3RkPjwvdHI+PC90YWJsZT48L2Rpdj5cIlxyXG4gICAgKTtcclxuXHJcbn1dKTsiLCIvL2JsYWNrbGlzdC5kaXJlY3RpdmUuanNcclxuXHJcbmFuZ3VsYXJcclxuICAgIC5tb2R1bGUoJ2FwcCcpXHJcbiAgICAuZGlyZWN0aXZlKCdibGFja2xpc3QnLCBbJyR0aW1lb3V0JywgJyRxJywgJ2NlbnNvclNlcnZpY2UnLCBmdW5jdGlvbiAoJHRpbWVvdXQsICRxLCBjZW5zb3IpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICByZXN0cmljdDogJ0EnLFxyXG4gICAgICAgICAgICByZXF1aXJlOiAnbmdNb2RlbCcsXHJcbiAgICAgICAgICAgIGxpbms6IGZ1bmN0aW9uIChzY29wZSwgZWxtLCBhdHRycywgY3RybCkge1xyXG4gICAgICAgICAgICAgICAgdmFyIHVzZXJuYW1lcyA9IFsnSmltJywgJ0pvaG4nLCAnSmlsbCcsICdKYWNraWUnXTtcclxuXHJcbiAgICAgICAgICAgICAgICBjdHJsLiRhc3luY1ZhbGlkYXRvcnMuYmxhY2tsaXN0ID0gZnVuY3Rpb24gKG1vZGVsVmFsdWUsIHZpZXdWYWx1ZSkge1xyXG5cclxuICAgICAgICAgICAgICAgICAgICBpZiAoY3RybC4kaXNFbXB0eShtb2RlbFZhbHVlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBjb25zaWRlciBlbXB0eSBtb2RlbCB2YWxpZFxyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHEucmVzb2x2ZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGRlZiA9ICRxLmRlZmVyKCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIGlmICghY2hlY2tBcnJheShtb2RlbFZhbHVlKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBkZWYucmVqZWN0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZGVmLnJlc29sdmUoKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBkZWYucHJvbWlzZTtcclxuICAgICAgICAgICAgICAgIH07XHJcblxyXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gY2hlY2tBcnJheShzdHIpIHtcclxuICAgICAgICAgICAgICAgICAgICB2YXIgYXJyID0gY2Vuc29yLmdldCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgYXJyLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChzdHIudG9VcHBlckNhc2UoKS5tYXRjaCgoXCIuKlwiICsgYXJyW2ldLnRyaW0oKSArIFwiLipcIikucmVwbGFjZShcIiBcIiwgXCIuKlwiKSkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1dKTtcclxuXHJcblxyXG4iLCIvL3V0aWwuYXV0b2ZvY3VzLmpzXHJcbi8qKlxyXG4gKiB0aGUgSFRNTDUgYXV0b2ZvY3VzIHByb3BlcnR5IGNhbiBiZSBmaW5pY2t5IHdoZW4gaXQgY29tZXMgdG8gZHluYW1pY2FsbHkgbG9hZGVkXHJcbiAqIHRlbXBsYXRlcyBhbmQgc3VjaCB3aXRoIEFuZ3VsYXJKUy4gVXNlIHRoaXMgc2ltcGxlIGRpcmVjdGl2ZSB0b1xyXG4gKiB0YW1lIHRoaXMgYmVhc3Qgb25jZSBhbmQgZm9yIGFsbC5cclxuICpcclxuICogVXNhZ2U6XHJcbiAqIDxpbnB1dCB0eXBlPVwidGV4dFwiIGF1dG9mb2N1cz5cclxuICogXHJcbiAqIExpY2Vuc2U6IE1JVFxyXG4gKi9cclxuXHJcblxyXG5hbmd1bGFyXHJcbiAgICAubW9kdWxlKCd1dGlscy5hdXRvZm9jdXMnLCBbXSlcclxuICAgIC5kaXJlY3RpdmUoJ2F1dG9mb2N1cycsIFsnJHRpbWVvdXQnLCBmdW5jdGlvbiAoJHRpbWVvdXQpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICByZXN0cmljdDogJ0EnLFxyXG4gICAgICAgICAgICBsaW5rOiBmdW5jdGlvbiAoJHNjb3BlLCAkZWxlbWVudCkge1xyXG4gICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgICRlbGVtZW50WzBdLmZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1dKTtcclxuXHJcbiIsIi8vY2Vuc29yLnNlcnZpY2UuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7XHJcblxyXG4gICAgZnVuY3Rpb24gZmFjdG9yeSgkcSwgJGh0dHAsIGNvbmZpZykge1xyXG5cclxuICAgICAgICB2YXIganNvbiA9IFtdO1xyXG5cclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBzZXQ6IGZ1bmN0aW9uICh2YWwpIHtcclxuICAgICAgICAgICAgICAgIGpzb24gPSB2YWw7XHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIGdldDogZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGpzb247XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG5cclxuICAgICAgICAvL3JldHVybiB7XHJcbiAgICAgICAgLy8gICAgaXNCbGFja0xpc3RlZDogaXNCbGFja0xpc3RlZCxcclxuICAgICAgICAvLyAgICBnZXQ6IGdldCwgXHJcbiAgICAgICAgLy8gICAgYWxsOiBhbGxcclxuICAgICAgICAvL307XHJcblxyXG4gICAgICAgIC8vZnVuY3Rpb24gaXNCbGFja0xpc3RlZCh1c2VybmFtZSkge1xyXG4gICAgICAgIC8vICAgIGlmICghIXVzZXJuYW1lKSB7XHJcbiAgICAgICAgLy8gICAgICAgIHJldHVybiAkcS53aGVuKCh1c2VybmFtZSA9PT0gJ2ZyZWQnKSk7XHJcbiAgICAgICAgLy8gICAgfVxyXG4gICAgICAgIC8vICAgIHJldHVybiAkcS5yZWplY3QoXCJJbnZhbGlkIHVzZXJuYW1lXCIpO1xyXG4gICAgICAgIC8vfVxyXG5cclxuICAgICAgICAvL2Z1bmN0aW9uIGdldCgpIHtcclxuICAgICAgICAvLyAgICBpZiAobGlzdC5sZW5ndGggPT09IDApIHtcclxuICAgICAgICAvLyAgICAgICAgbG9hZCgpLnRoZW4oZnVuY3Rpb24ocikge1xyXG4gICAgICAgIC8vICAgICAgICAgICAgbGlzdCA9IHI7IFxyXG4gICAgICAgIC8vICAgICAgICB9KTsgXHJcbiAgICAgICAgLy8gICAgfVxyXG5cclxuICAgICAgICAvLyAgICByZXR1cm4gbGlzdDtcclxuXHJcbiAgICAgICAgLy99XHJcblxyXG4gICAgICAgIC8vZnVuY3Rpb24gX2FsbCgpIHtcclxuICAgICAgICAvLyAgICBjb25zb2xlLmxvZygnbGlzdCcsIGxpc3QpO1xyXG4gICAgICAgIC8vICAgIGlmIChsaXN0Lmxlbmd0aCA+IDApIHJldHVybiBsaXN0O1xyXG4gICAgICAgIC8vICAgIHJldHVybiAkaHR0cC5nZXQoY29uZmlnLmFwaVVybEJhc2UgKyAnY2Vuc29yJykudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgIC8vICAgICAgICBjb25zb2xlLmxvZygnZ2V0dGluZyBkYXRhIGZyb20gdXJpJyk7XHJcbiAgICAgICAgLy8gICAgICAgIGxpc3QgPSByLmRhdGE7XHJcbiAgICAgICAgLy8gICAgICAgIHJldHVybiBsaXN0O1xyXG4gICAgICAgIC8vICAgIH0pO1xyXG4gICAgICAgIC8vfVxyXG5cclxuICAgICAgICAvL3Jlc3VsdHMuYWxsID0gX2FsbDtcclxuICAgICAgICAvL3JldHVybiByZXN1bHRzO1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb2R1bGUuZmFjdG9yeSgnY2Vuc29yU2VydmljZScsIFsnJHEnLCAnJGh0dHAnLCAnY29uZmlnJywgZmFjdG9yeV0pO1xyXG59XHJcbikoKTsiLCIvL3Zpc2l0b3Iuc2VydmljZS5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnKTtcclxuICAgIFxyXG4gICAgZnVuY3Rpb24gZmFjdG9yeSgkaHR0cCwgY29uZmlnKSB7XHJcbiAgICAgICAgdmFyIHZpc2l0b3IgPSB7fTtcclxuICAgICAgICB2YXIgdGVybSA9ICcnO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICAgIGNsZWFyOiBjbGVhcixcclxuICAgICAgICAgICAgY2xlYXJUZXJtOiBjbGVhclRlcm0sIFxyXG4gICAgICAgICAgICBnZXQ6IGdldCxcclxuICAgICAgICAgICAgZ2V0VGVybTogZ2V0VGVybSxcclxuICAgICAgICAgICAgc2V0OiBzZXQsXHJcbiAgICAgICAgICAgIHNldFRlcm06IHNldFRlcm0sXHJcbiAgICAgICAgICAgIHNhdmU6IHNhdmUsIFxyXG4gICAgICAgICAgICBzZWFyY2g6IHNlYXJjaFxyXG4gICAgICAgIH07XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGNsZWFyKCkge1xyXG4gICAgICAgICAgICB2aXNpdG9yID0ge307XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBjbGVhclRlcm0oKSB7XHJcbiAgICAgICAgICAgIHRlcm0gPSAnJzsgXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBnZXQoKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB2aXNpdG9yO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0VGVybSgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHRlcm07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzZXQodikge1xyXG4gICAgICAgICAgICB2aXNpdG9yID0gdjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNldFRlcm0odCkge1xyXG4gICAgICAgICAgICB0ZXJtID0gdDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNlYXJjaChtb2RlbCkge1xyXG4gICAgICAgICAgICByZXR1cm4gJGh0dHAuZ2V0KGNvbmZpZy5hcGlVcmwsIHsgcGFyYW1zOiBtb2RlbCB9KS50aGVuKGZ1bmN0aW9uIChyKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gci5kYXRhOyBcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzYXZlKHYpIHtcclxuICAgICAgICAgICAgJGh0dHAucG9zdChjb25maWcuYXBpVXJsLCB2aXNpdG9yKS50aGVuKGZ1bmN0aW9uIChyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnc2F2ZWQgbmV3IHZpc2l0b3InLCB2aXNpdG9yKTtcclxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5lcnJvcignc29tZXRoaW5nIHdlbnQgd3JvbmcnLCBlcnIubWVzc2FnZSk7XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW9kdWxlLmZhY3RvcnkoJ3Zpc2l0b3JTZXJ2aWNlJywgWyckaHR0cCcsICdjb25maWcnLCBmYWN0b3J5XSk7XHJcblxyXG59XHJcbikoKTsiXX0=
