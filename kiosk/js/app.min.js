!function(){var e=angular.module("app",["ngComponentRouter","ngAnimate","ui.bootstrap","ngMessages","onScreenKeyboard","treasure-overlay-spinner"]);e.component("kiosk",{template:"<ng-outlet>Loading ..</ng-outlet >",$routeConfig:[{path:"/",name:"Welcome",component:"welcome",useAsDefault:!0},{path:"/register",name:"Register",component:"register"},{path:"/pledge",name:"Pledge",component:"pledge"},{path:"/finish",name:"Finish",component:"finish"},{path:"/search",name:"Search",component:"search"},{path:"/results",name:"Results",component:"results"}]}),e.value("$routerRootComponent","kiosk"),e.value("config",{host:window.location.hostname,apiUrl:"http://localhost:49960/api/visitor",hubUrl:"http://localhost:49960/signalr",redirectTimeout:3e4,finishTimeout:4,kiosk:1}),e.run(["config",function(e){switch(e.host){case"crmckiosk":e.apiUrl="http://crmc/api/visitor",e.hubUrl="http://crmc/signalr";break;case"crmckiosk-test.splcenter.org":e.apiUrl="http://crmc-test/api/visitor",e.hubUrl="http://crmc-test/signalr";break;case"crmckiosk.splcenter.org":e.apiUrl="http://crmc/api/visitor",e.hubUrl="http://crmc/signalr"}}])}();
!function(){function n(n,t,o){var i=this;i.$onInit=function(){console.log("finish init",n),$.connection.hub.url=n.hubUrl;var o=$.connection.nameNotificationHub;$.connection.hub.start().done(function(){console.log("hub connection started"),o.server.addName(1,t.get())}),i.countDown_tick=n.finishTimeout,i.startTimer()},this.$routerOnActivate=function(n){i.$router=this.$router},i.startTimer=function(){i.countDown_tick<=0?(t.clear(),console.log("timer finished"),i.$router.navigate(["Welcome"])):(i.countDown_tick--,o(i.startTimer,1e3))}}var t=angular.module("app");t.component("finish",{bindings:{$router:"<"},templateUrl:"app/finish.component.html",controller:["config","visitorService","$timeout",n]})}();
!function(){function e(e,t,n){var o,i=this;i.$onInit=function(){console.log("pledge init"),i.visitor=n.get(),i.startTimer()},this.$routerOnActivate=function(e){},i.gotoWelcome=function(){n.clear(),e.cancel(o),this.$router.navigate(["Welcome"])},i.gotoRegister=function(){e.cancel(o),this.$router.navigate(["Register"])},i.pledge=function(){n.get().id?console.log("returning visitor",n.get()):(console.log("save new visitor",n.get()),n.save()),e.cancel(o),this.$router.navigate(["Finish"])},i.startTimer=function(){e.cancel(o),o=e(function(){n.clear(),i.$router.navigate(["Welcome"])},t.redirectTimeout)}}var t=angular.module("app");t.component("pledge",{bindings:{$router:"<"},templateUrl:"app/pledge.component.html",controller:["$timeout","config","visitorService",e]})}();
!function(){function t(t,e,o){var n,r=this;r.$onInit=function(){r.visitor=e.get(),r.startTimer()},this.$routerOnActivate=function(t){r.$router=this.$router},r.gotoWelcome=function(){o.cancel(n),this.$router.navigate(["Welcome"])},r.gotoPledge=function(){o.cancel(n),this.$router.navigate(["Pledge"])},r.startTimer=function(){o.cancel(n),n=o(function(){e.clear(),r.$router.navigate(["Welcome"])},t.redirectTimeout)}}var e=angular.module("app");e.component("register",{bindings:{$router:"<"},templateUrl:"app/register.component.html",controller:["config","visitorService","$timeout",t]})}();
!function(){function e(e,t,n){var r,o,a=this,c=10;a.searchModel={page:1,pageSize:c},a.paging={currentPage:1},a.$onInit=function(){console.log("search init");const e=n.getTerm().split(" ");e.length>1?(a.searchModel.firstname=e[0],a.searchModel.lastname=e[1]):a.searchModel.lastname=e[0],a.search()},a.gotoWelcome=function(){t.cancel(r),this.$router.navigate(["Welcome"])},a.gotoSearch=function(){t.cancel(r),this.$router.navigate(["Search"])},a.pledge=function(){n.clearTerm(),t.cancel(r),this.$router.navigate(["Pledge"])},a.toggleName=function(e){a.visitor=e,n.set(e),a.startTimer()},a.search=function(e){return o=e,a.loading=!0,n.search(a.searchModel).then(function(e){a.visitors=e.results,a.searchModel=e,delete a.searchModel.results,a.startTimer(),a.loading=!1})},a.paged=function(){a.visitor=null,a.search(o)},a.startTimer=function(){t.cancel(r),r=t(function(){n.clear(),a.$router.navigate(["Welcome"])},e.redirectTimeout)}}var t=angular.module("app");t.component("results",{bindings:{$router:"<"},templateUrl:"app/results.component.html",controller:["config","$timeout","visitorService",e]})}();
!function(){function e(e,t,r){var n,o=this;o.$onInit=function(){console.log("search init"),o.searchTerm=t.getTerm(),o.startTimer()},o.gotoWelcome=function(){t.clear(),r.cancel(n),this.$router.navigate(["Welcome"])},o.gotoSearchResults=function(){t.setTerm(o.searchTerm),r.cancel(n),this.$router.navigate(["Results"])},o.startTimer=function(){r.cancel(n),n=r(function(){t.clear(),o.$router.navigate(["Welcome"])},e.redirectTimeout)}}var t=angular.module("app");t.component("search",{bindings:{$router:"<"},templateUrl:"app/search.component.html",controller:["config","visitorService","$timeout",e]})}();
!function(){function t(){var t=this;t.$onInit=function(){console.log("welcome init")},this.$routerOnActivate=function(t){},t.gotoRegister=function(){this.$router.navigate(["Register"])},t.gotoSearch=function(){this.$router.navigate(["Search"])}}var o=angular.module("app");o.component("welcome",{bindings:{$router:"<"},templateUrl:"app/welcome.component.html",controller:[t]})}();
angular.module("onScreenKeyboard",["ngSanitize"]).directive("onScreenKeyboard",["$timeout","$document",function(t,e){"use strict";return{restrict:"E",bindToController:!0,controllerAs:"ctrl",scope:{rows:"=?",uppercaseAllWords:"@"},controller:["$sce",function(t){var e=this;e.rows||(e.rows=[["1","2","3","4","5","6","7","8","9","0",{type:"erase",colspan:2,text:"&lArr;"}],["q","w","e","r","t","y","u","i","o","p","@"],["a","s","d","f","g","h","j","k","l","-","_",{type:"margin"}],[{type:"shift"},"z","x","c","v","b","n","m",",",".",{type:"shift"}],[{type:"margin"},{type:"space",colspan:9,text:" "}]]),e.getText=function(e){if("margin"===e.type)return"";if("shift"===e.type)return"&dArr;";var r=e.text||e;return r&&r.indexOf("&")>-1?t.trustAsHtml(r):r}}],link:function(r,n,s){var a=r.ctrl;n.bind("contextmenu",function(t){return t.preventDefault(),!1}),a.isUpperCase=!1,a.lastInputCtrl=null,a.startPos=null,a.endPos=null,a.printKeyStroke=function(t){if(a.lastInputCtrl){var e=angular.element(t.target||t.srcElement);if(e.hasClass("erase"))return void a.eraseKeyStroke();if(e.hasClass("shift"))return void a.inverseCase();var r=angular.element(a.lastInputCtrl),n=r.val(),s=n.substring(0,a.startPos),l=n.substring(a.endPos,n.length);r.val(s+e.text()+l),r.triggerHandler("change"),a.startPos++,a.endPos++,a.setKeyboardLayout()}},a.inverseCase=function(){},a.refocus=function(){a.lastInputCtrl.focus()},a.eraseKeyStroke=function(){if(a.lastInputCtrl){var t=a.startPos!==a.endPos,e=angular.element(a.lastInputCtrl),r=e.val(),n=r.substring(0,t?a.startPos:a.startPos-1),s=r.substring(a.endPos,r.length);e.val(n+s),e.triggerHandler("change"),t?a.endPos=a.startPos:(a.startPos--,a.endPos--),a.lastInputCtrl.selectionStart=a.startPos,a.lastInputCtrl.selectionEnd=a.startPos,a.setKeyboardLayout(),a.refocus()}},a.setKeyboardLayout=function(){return a.lastInputCtrl?void(a.lastInputCtrl.className&&a.isUpperCase?a.inverseCase():0===angular.element(a.lastInputCtrl).val().length?a.isUpperCase||(a.isUpperCase=!1,a.inverseCase()):" "===angular.element(a.lastInputCtrl).val().slice(-1)&&!a.isUpperCase&&s.hasOwnProperty("uppercaseAllWords")?a.inverseCase():(a.isUpperCase=!0,a.inverseCase())):(a.isUpperCase=!1,void a.inverseCase())},e.find("input").bind("blur focus",function(){a.setKeyboardLayout(),a.lastInputCtrl=this,a.lastInputCtrl&&"checkbox"!==a.lastInputCtrl.type&&(a.startPos=a.lastInputCtrl.selectionStart,a.endPos=a.lastInputCtrl.selectionEnd)}).bind("keydown",function(){a.startPos=a.lastInputCtrl.selectionStart,a.endPos=a.lastInputCtrl.selectionEnd}),t(function(){a.inverseCase()},0)},templateUrl:"/templates/angular-on-screen-keyboard.html"}}]),angular.module("onScreenKeyboard").run(["$templateCache",function(t){"use strict";t.put("/templates/angular-on-screen-keyboard.html","<div class=keyboard><table><tr ng-repeat=\"row in ctrl.rows\"><td ng-repeat=\"key in row\" ng-click=ctrl.printKeyStroke($event) colspan=\"{{key.colspan || 1}}\" ng-class=\"{'button': key.type !== 'margin', 'letter': key.type !== 'margin'}\" class={{key.type}} ng-bind-html=ctrl.getText(key)></td></tr></table></div>")}]);
!function(){function n(n,t){function e(){s={}}function r(){g=""}function o(){return s}function c(){return g}function i(n){s=n}function u(n){g=n}function a(e){return n.get(t.apiUrl,{params:e}).then(function(n){return n.data})}function f(e){n.post(t.apiUrl,s).then(function(n){console.log("saved new visitor",s)}).catch(function(n){console.error("something went wrong",n.message)})}var s={},g="";return{clear:e,clearTerm:r,get:o,getTerm:c,set:i,setTerm:u,save:f,search:a}}var t=angular.module("app");t.factory("visitorService",["$http","config",n])}();
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJmaW5pc2guY29tcG9uZW50LmpzIiwicGxlZGdlLmNvbXBvbmVudC5qcyIsInJlZ2lzdGVyLmNvbXBvbmVudC5qcyIsInJlc3VsdHMuY29tcG9uZW50LmpzIiwic2VhcmNoLmNvbXBvbmVudC5qcyIsIndlbGNvbWUuY29tcG9uZW50LmpzIiwiZGlyZWN0aXZlcy9hbmd1bGFyLW9uLXNjcmVlbi1rZXlib2FyZC5qcyIsInNlcnZpY2VzL3Zpc2l0b3Iuc2VydmljZS5qcyJdLCJuYW1lcyI6WyJtb2R1bGUiLCJhbmd1bGFyIiwiY29tcG9uZW50IiwidGVtcGxhdGUiLCIkcm91dGVDb25maWciLCJwYXRoIiwibmFtZSIsInVzZUFzRGVmYXVsdCIsInZhbHVlIiwiaG9zdCIsIndpbmRvdyIsImxvY2F0aW9uIiwiaG9zdG5hbWUiLCJhcGlVcmwiLCJodWJVcmwiLCJyZWRpcmVjdFRpbWVvdXQiLCJmaW5pc2hUaW1lb3V0Iiwia2lvc2siLCJydW4iLCJjb25maWciLCJjb250cm9sbGVyIiwidmlzaXRvciIsIiR0aW1lb3V0IiwiJGN0cmwiLCJ0aGlzIiwiJG9uSW5pdCIsImNvbnNvbGUiLCJsb2ciLCIkIiwiY29ubmVjdGlvbiIsImh1YiIsInVybCIsIm5hbWVOb3RpZmljYXRpb25IdWIiLCJzdGFydCIsImRvbmUiLCJzZXJ2ZXIiLCJhZGROYW1lIiwiZ2V0IiwiY291bnREb3duX3RpY2siLCJzdGFydFRpbWVyIiwiJHJvdXRlck9uQWN0aXZhdGUiLCJuZXh0IiwiJHJvdXRlciIsImNsZWFyIiwibmF2aWdhdGUiLCJiaW5kaW5ncyIsInRlbXBsYXRlVXJsIiwidGltZXIiLCJnb3RvV2VsY29tZSIsImNhbmNlbCIsImdvdG9SZWdpc3RlciIsInBsZWRnZSIsImlkIiwic2F2ZSIsImdvdG9QbGVkZ2UiLCJ0YWJsZVN0YXRlUmVmIiwicGFnZVNpemVEZWZhdWx0Iiwic2VhcmNoTW9kZWwiLCJwYWdlIiwicGFnZVNpemUiLCJwYWdpbmciLCJjdXJyZW50UGFnZSIsIm5hbWVzIiwiZ2V0VGVybSIsInNwbGl0IiwibGVuZ3RoIiwiZmlyc3RuYW1lIiwibGFzdG5hbWUiLCJzZWFyY2giLCJnb3RvU2VhcmNoIiwiY2xlYXJUZXJtIiwidG9nZ2xlTmFtZSIsInYiLCJzZXQiLCJ0YWJsZVN0YXRlIiwibG9hZGluZyIsInRoZW4iLCJyIiwidmlzaXRvcnMiLCJyZXN1bHRzIiwicGFnZWQiLCJzZWFyY2hUZXJtIiwiZ290b1NlYXJjaFJlc3VsdHMiLCJzZXRUZXJtIiwiZGlyZWN0aXZlIiwiYSIsImIiLCJyZXN0cmljdCIsImJpbmRUb0NvbnRyb2xsZXIiLCJjb250cm9sbGVyQXMiLCJzY29wZSIsInJvd3MiLCJ1cHBlcmNhc2VBbGxXb3JkcyIsInR5cGUiLCJjb2xzcGFuIiwidGV4dCIsImdldFRleHQiLCJjIiwiaW5kZXhPZiIsInRydXN0QXNIdG1sIiwibGluayIsImQiLCJlIiwiZiIsImN0cmwiLCJiaW5kIiwicHJldmVudERlZmF1bHQiLCJpc1VwcGVyQ2FzZSIsImxhc3RJbnB1dEN0cmwiLCJzdGFydFBvcyIsImVuZFBvcyIsInByaW50S2V5U3Ryb2tlIiwiZWxlbWVudCIsInRhcmdldCIsInNyY0VsZW1lbnQiLCJoYXNDbGFzcyIsImVyYXNlS2V5U3Ryb2tlIiwiaW52ZXJzZUNhc2UiLCJ2YWwiLCJzdWJzdHJpbmciLCJnIiwidHJpZ2dlckhhbmRsZXIiLCJzZXRLZXlib2FyZExheW91dCIsInJlZm9jdXMiLCJmb2N1cyIsInNlbGVjdGlvblN0YXJ0Iiwic2VsZWN0aW9uRW5kIiwiY2xhc3NOYW1lIiwic2xpY2UiLCJoYXNPd25Qcm9wZXJ0eSIsImZpbmQiLCIkdGVtcGxhdGVDYWNoZSIsInB1dCIsImZhY3RvcnkiLCIkaHR0cCIsInRlcm0iLCJ0IiwibW9kZWwiLCJwYXJhbXMiLCJkYXRhIiwicG9zdCIsImNhdGNoIiwiZXJyIiwiZXJyb3IiLCJtZXNzYWdlIl0sIm1hcHBpbmdzIjoiQ0FDQSxXQUNJLEdBQUlBLEdBQVNDLFFBQVFELE9BQU8s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QUU4RCxPQUlqQixRQUFTdEYsR0FBS21CLEdBQ1Y4RCxFQUFNTSxLQUFLekgsRUFBT04sT0FBUVEsR0FBU3VELEtBQUssU0FBVUMsR0FDOUNuRCxRQUFRQyxJQUFJLG9CQUFxQk4sS0FDbEN3SCxNQUFNLFNBQVVDLEdBQ2ZwSCxRQUFRcUgsTUFBTSx1QkFBd0JELEVBQUlFLFdBaERsRCxHQUFJM0gsTUFDQWtILEVBQU8sRUFFWCxRQUNJNUYsTUFBT0EsRUFDUDJCLFVBQVdBLEVBQ1hqQyxJQUFLQSxFQUNMMEIsUUFBU0EsRUFDVFUsSUFBS0EsRUFDTFUsUUFBU0EsRUFDVDlCLEtBQU1BLEVBQ05lLE9BQVFBLEdBZGhCLEdBQUlwRSxHQUFTQyxRQUFRRCxPQUFPLE1BeUQ1QkEsR0FBT3FJLFFBQVEsa0JBQW1CLFFBQVMsU0FBVUEiLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vYXBwLm1vZHVsZS5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbXHJcbiAgICAgICAgJ25nQ29tcG9uZW50Um91dGVyJyxcclxuICAgICAgICAnbmdBbmltYXRlJywgXHJcbiAgICAgICAgJ3VpLmJvb3RzdHJhcCcsXHJcbiAgICAgICAgJ25nTWVzc2FnZXMnLFxyXG4gICAgICAgICdvblNjcmVlbktleWJvYXJkJywgXHJcbiAgICAgICAgJ3RyZWFzdXJlLW92ZXJsYXktc3Bpbm5lcidcclxuICAgIF0pO1xyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ2tpb3NrJyxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIHRlbXBsYXRlOiAnPG5nLW91dGxldD5Mb2FkaW5nIC4uPC9uZy1vdXRsZXQgPicsXHJcbiAgICAgICAgICAgICRyb3V0ZUNvbmZpZzogW1xyXG4gICAgICAgICAgICAgICAgeyBwYXRoOiAnLycsIG5hbWU6ICdXZWxjb21lJywgY29tcG9uZW50OiAnd2VsY29tZScsIHVzZUFzRGVmYXVsdDogdHJ1ZSB9LFxyXG4gICAgICAgICAgICAgICAgeyBwYXRoOiAnL3JlZ2lzdGVyJywgbmFtZTogJ1JlZ2lzdGVyJywgY29tcG9uZW50OiAncmVnaXN0ZXInIH0sXHJcbiAgICAgICAgICAgICAgICB7IHBhdGg6ICcvcGxlZGdlJywgbmFtZTogJ1BsZWRnZScsIGNvbXBvbmVudDogJ3BsZWRnZScgfSxcclxuICAgICAgICAgICAgICAgIHsgcGF0aDogJy9maW5pc2gnLCBuYW1lOiAnRmluaXNoJywgY29tcG9uZW50OiAnZmluaXNoJyB9LFxyXG4gICAgICAgICAgICAgICAgeyBwYXRoOiAnL3NlYXJjaCcsIG5hbWU6ICdTZWFyY2gnLCBjb21wb25lbnQ6ICdzZWFyY2gnIH0sXHJcbiAgICAgICAgICAgICAgICB7IHBhdGg6ICcvcmVzdWx0cycsIG5hbWU6ICdSZXN1bHRzJywgY29tcG9uZW50OiAncmVzdWx0cycgfVxyXG4gICAgICAgICAgICBdXHJcbiAgICAgICAgfSk7XHJcblxyXG4gICAgbW9kdWxlLnZhbHVlKCckcm91dGVyUm9vdENvbXBvbmVudCcsICdraW9zaycpO1xyXG4gICAgbW9kdWxlLnZhbHVlKCdjb25maWcnLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgaG9zdDogd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lLFxyXG4gICAgICAgICAgICBhcGlVcmw6ICdodHRwOi8vbG9jYWxob3N0OjQ5OTYwL2FwaS92aXNpdG9yJyxcclxuICAgICAgICAgICAgaHViVXJsOiAnaHR0cDovL2xvY2FsaG9zdDo0OTk2MC9zaWduYWxyJyxcclxuICAgICAgICAgICAgcmVkaXJlY3RUaW1lb3V0OiAzMDAwMCxcclxuICAgICAgICAgICAgZmluaXNoVGltZW91dDogNCxcclxuICAgICAgICAgICAga2lvc2s6IDFcclxuICAgICAgICB9KTtcclxuXHJcbiAgICBtb2R1bGUucnVuKFsnY29uZmlnJywgZnVuY3Rpb24gKGNvbmZpZykge1xyXG4gICAgICAgIHN3aXRjaCAoY29uZmlnLmhvc3QpIHtcclxuICAgICAgICAgICAgY2FzZSAnY3JtY2tpb3NrJzpcclxuICAgICAgICAgICAgICAgIGNvbmZpZy5hcGlVcmwgPSAnaHR0cDovL2NybWMvYXBpL3Zpc2l0b3InO1xyXG4gICAgICAgICAgICAgICAgY29uZmlnLmh1YlVybCA9ICdodHRwOi8vY3JtYy9zaWduYWxyJztcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICBjYXNlICdjcm1ja2lvc2stdGVzdC5zcGxjZW50ZXIub3JnJzpcclxuICAgICAgICAgICAgICAgIGNvbmZpZy5hcGlVcmwgPSAnaHR0cDovL2NybWMtdGVzdC9hcGkvdmlzaXRvcic7XHJcbiAgICAgICAgICAgICAgICBjb25maWcuaHViVXJsID0gJ2h0dHA6Ly9jcm1jLXRlc3Qvc2lnbmFscic7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgY2FzZSAnY3JtY2tpb3NrLnNwbGNlbnRlci5vcmcnOlxyXG4gICAgICAgICAgICAgICAgY29uZmlnLmFwaVVybCA9ICdodHRwOi8vY3JtYy9hcGkvdmlzaXRvcic7XHJcbiAgICAgICAgICAgICAgICBjb25maWcuaHViVXJsID0gJ2h0dHA6Ly9jcm1jL3NpZ25hbHInO1xyXG4gICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgIGRlZmF1bHQ6XHJcblxyXG4gICAgICAgIH1cclxuICAgIH1dKTtcclxuXHJcblxyXG59XHJcbikoKTsiLCIvL2ZpbmlzaC5jb21wb25lbnQuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7XHJcbiAgICAvL1RPRE86IFNFVC9HRVQga2lvc2sgbnVtYmVyIGZyb20gbG9jYWwgc3RvcmFnZVxyXG4gICAgZnVuY3Rpb24gY29udHJvbGxlcihjb25maWcsIHZpc2l0b3IsICR0aW1lb3V0KSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ2ZpbmlzaCBpbml0JywgY29uZmlnKTtcclxuICAgICAgICAgICAgJC5jb25uZWN0aW9uLmh1Yi51cmwgPSBjb25maWcuaHViVXJsO1xyXG4gICAgICAgICAgICB2YXIgaHViID0gJC5jb25uZWN0aW9uLm5hbWVOb3RpZmljYXRpb25IdWI7XHJcbiAgICAgICAgICAgICQuY29ubmVjdGlvbi5odWIuc3RhcnQoKS5kb25lKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2h1YiBjb25uZWN0aW9uIHN0YXJ0ZWQnKTtcclxuICAgICAgICAgICAgICAgIGh1Yi5zZXJ2ZXIuYWRkTmFtZSgxLCB2aXNpdG9yLmdldCgpKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAkY3RybC5jb3VudERvd25fdGljayA9IGNvbmZpZy5maW5pc2hUaW1lb3V0O1xyXG4gICAgICAgICAgICAkY3RybC5zdGFydFRpbWVyKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLiRyb3V0ZXJPbkFjdGl2YXRlID0gZnVuY3Rpb24gKG5leHQpIHtcclxuICAgICAgICAgICAgJGN0cmwuJHJvdXRlciA9IHRoaXMuJHJvdXRlcjsgXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJGN0cmwuc3RhcnRUaW1lciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCRjdHJsLmNvdW50RG93bl90aWNrIDw9IDApIHtcclxuICAgICAgICAgICAgICAgIHZpc2l0b3IuY2xlYXIoKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0aW1lciBmaW5pc2hlZCcpO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuJHJvdXRlci5uYXZpZ2F0ZShbJ1dlbGNvbWUnXSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5jb3VudERvd25fdGljay0tO1xyXG4gICAgICAgICAgICAgICAgJHRpbWVvdXQoJGN0cmwuc3RhcnRUaW1lciwgMTAwMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb2R1bGUuY29tcG9uZW50KCdmaW5pc2gnLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgICAgICRyb3V0ZXI6ICc8J1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9maW5pc2guY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiBbJ2NvbmZpZycsICd2aXNpdG9yU2VydmljZScsICckdGltZW91dCcsIGNvbnRyb2xsZXJdXHJcbiAgICAgICAgfSk7XHJcbn1cclxuKSgpOyIsIi8vcGxlZGdlLmNvbXBvbmVudC5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnKTtcclxuICAgIC8vVE9ETzogR0VUIGh1YiB1cmwgZnJvbSBzZXR0aW5nc1xyXG4gICAgZnVuY3Rpb24gY29udHJvbGxlcigkdGltZW91dCwgY29uZmlnLCB2aXNpdG9yKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuICAgICAgICB2YXIgdGltZXI7IFxyXG5cclxuICAgICAgICAkY3RybC4kb25Jbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygncGxlZGdlIGluaXQnKTtcclxuICAgICAgICAgICAgJGN0cmwudmlzaXRvciA9IHZpc2l0b3IuZ2V0KCk7XHJcbiAgICAgICAgICAgICRjdHJsLnN0YXJ0VGltZXIoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuJHJvdXRlck9uQWN0aXZhdGUgPSBmdW5jdGlvbiAobmV4dCkgeyB9O1xyXG5cclxuICAgICAgICAkY3RybC5nb3RvV2VsY29tZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmlzaXRvci5jbGVhcigpO1xyXG4gICAgICAgICAgICAkdGltZW91dC5jYW5jZWwodGltZXIpO1xyXG4gICAgICAgICAgICB0aGlzLiRyb3V0ZXIubmF2aWdhdGUoWydXZWxjb21lJ10pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuZ290b1JlZ2lzdGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkdGltZW91dC5jYW5jZWwodGltZXIpO1xyXG4gICAgICAgICAgICB0aGlzLiRyb3V0ZXIubmF2aWdhdGUoWydSZWdpc3RlciddKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLnBsZWRnZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCF2aXNpdG9yLmdldCgpLmlkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnc2F2ZSBuZXcgdmlzaXRvcicsIHZpc2l0b3IuZ2V0KCkpO1xyXG4gICAgICAgICAgICAgICAgdmlzaXRvci5zYXZlKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncmV0dXJuaW5nIHZpc2l0b3InLCB2aXNpdG9yLmdldCgpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAkdGltZW91dC5jYW5jZWwodGltZXIpO1xyXG4gICAgICAgICAgICB0aGlzLiRyb3V0ZXIubmF2aWdhdGUoWydGaW5pc2gnXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5zdGFydFRpbWVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkdGltZW91dC5jYW5jZWwodGltZXIpO1xyXG4gICAgICAgICAgICB0aW1lciA9ICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZpc2l0b3IuY2xlYXIoKTtcclxuICAgICAgICAgICAgICAgICRjdHJsLiRyb3V0ZXIubmF2aWdhdGUoWydXZWxjb21lJ10pO1xyXG4gICAgICAgICAgICB9LCBjb25maWcucmVkaXJlY3RUaW1lb3V0KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ3BsZWRnZScsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiaW5kaW5nczoge1xyXG4gICAgICAgICAgICAgICAgJHJvdXRlcjogJzwnXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL3BsZWRnZS5jb21wb25lbnQuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJHRpbWVvdXQnLCAnY29uZmlnJywgJ3Zpc2l0b3JTZXJ2aWNlJywgY29udHJvbGxlcl1cclxuICAgICAgICB9KTtcclxufVxyXG4pKCk7IiwiLy9yZWdpc3Rlci5jb21wb25lbnQuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7XHJcblxyXG4gICAgZnVuY3Rpb24gY29udHJvbGxlcihjb25maWcsIHZpc2l0b3IsICR0aW1lb3V0KSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuICAgICAgICB2YXIgdGltZXI7IFxyXG5cclxuICAgICAgICAkY3RybC4kb25Jbml0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRjdHJsLnZpc2l0b3IgPSB2aXNpdG9yLmdldCgpOyBcclxuICAgICAgICAgICAgJGN0cmwuc3RhcnRUaW1lcigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy4kcm91dGVyT25BY3RpdmF0ZSA9IGZ1bmN0aW9uIChuZXh0KSB7XHJcbiAgICAgICAgICAgICRjdHJsLiRyb3V0ZXIgPSB0aGlzLiRyb3V0ZXI7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJGN0cmwuZ290b1dlbGNvbWUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICR0aW1lb3V0LmNhbmNlbCh0aW1lcik7XHJcbiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5uYXZpZ2F0ZShbJ1dlbGNvbWUnXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5nb3RvUGxlZGdlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkdGltZW91dC5jYW5jZWwodGltZXIpO1xyXG4gICAgICAgICAgICB0aGlzLiRyb3V0ZXIubmF2aWdhdGUoWydQbGVkZ2UnXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5zdGFydFRpbWVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkdGltZW91dC5jYW5jZWwodGltZXIpO1xyXG4gICAgICAgICAgICB0aW1lciA9ICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZpc2l0b3IuY2xlYXIoKTtcclxuICAgICAgICAgICAgICAgICRjdHJsLiRyb3V0ZXIubmF2aWdhdGUoWydXZWxjb21lJ10pO1xyXG4gICAgICAgICAgICB9LCBjb25maWcucmVkaXJlY3RUaW1lb3V0KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ3JlZ2lzdGVyJyxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJpbmRpbmdzOiB7ICRyb3V0ZXI6ICc8JyB9LFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9yZWdpc3Rlci5jb21wb25lbnQuaHRtbCcsIFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiBbJ2NvbmZpZycsICd2aXNpdG9yU2VydmljZScsICckdGltZW91dCcsIGNvbnRyb2xsZXJdXHJcbiAgICAgICAgfSk7XHJcblxyXG5cclxufVxyXG4pKCk7IiwiLy9yZXN1bHRzLmNvbXBvbmVudC5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnKTtcclxuICAgIC8vVE9ETzogR0VUIGh1YiB1cmwgZnJvbSBzZXR0aW5nc1xyXG4gICAgZnVuY3Rpb24gY29udHJvbGxlcihjb25maWcsICR0aW1lb3V0LCB2aXNpdG9yKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuICAgICAgICB2YXIgdGltZXI7IFxyXG4gICAgICAgIHZhciBwYWdlU2l6ZURlZmF1bHQgPSAxMDtcclxuICAgICAgICB2YXIgdGFibGVTdGF0ZVJlZjtcclxuXHJcbiAgICAgICAgJGN0cmwuc2VhcmNoTW9kZWwgPSB7XHJcbiAgICAgICAgICAgIHBhZ2U6IDEsXHJcbiAgICAgICAgICAgIHBhZ2VTaXplOiBwYWdlU2l6ZURlZmF1bHRcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkY3RybC5wYWdpbmcgPSB7XHJcbiAgICAgICAgICAgIGN1cnJlbnRQYWdlOiAxXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC4kb25Jbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnc2VhcmNoIGluaXQnKTtcclxuICAgICAgICAgICAgY29uc3QgbmFtZXMgPSB2aXNpdG9yLmdldFRlcm0oKS5zcGxpdCgnICcpO1xyXG4gICAgICAgICAgICBpZiAobmFtZXMubGVuZ3RoID4gMSkge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuc2VhcmNoTW9kZWwuZmlyc3RuYW1lID0gbmFtZXNbMF07IFxyXG4gICAgICAgICAgICAgICAgJGN0cmwuc2VhcmNoTW9kZWwubGFzdG5hbWUgPSBuYW1lc1sxXTsgXHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5zZWFyY2hNb2RlbC5sYXN0bmFtZSA9IG5hbWVzWzBdOyBcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgJGN0cmwuc2VhcmNoKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5nb3RvV2VsY29tZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKHRpbWVyKTtcclxuICAgICAgICAgICAgdGhpcy4kcm91dGVyLm5hdmlnYXRlKFsnV2VsY29tZSddKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmdvdG9TZWFyY2ggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICR0aW1lb3V0LmNhbmNlbCh0aW1lcik7XHJcbiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5uYXZpZ2F0ZShbJ1NlYXJjaCddKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLnBsZWRnZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmlzaXRvci5jbGVhclRlcm0oKTtcclxuICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKHRpbWVyKTtcclxuICAgICAgICAgICAgdGhpcy4kcm91dGVyLm5hdmlnYXRlKFsnUGxlZGdlJ10pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwudG9nZ2xlTmFtZSA9IGZ1bmN0aW9uICh2KSB7XHJcbiAgICAgICAgICAgICRjdHJsLnZpc2l0b3IgPSB2O1xyXG4gICAgICAgICAgICB2aXNpdG9yLnNldCh2KTtcclxuICAgICAgICAgICAgJGN0cmwuc3RhcnRUaW1lcigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuc2VhcmNoID0gZnVuY3Rpb24gKHRhYmxlU3RhdGUpIHtcclxuICAgICAgICAgICAgdGFibGVTdGF0ZVJlZiA9IHRhYmxlU3RhdGU7XHJcbiAgICAgICAgICAgICRjdHJsLmxvYWRpbmcgPSB0cnVlO1xyXG4gICAgICAgICAgICByZXR1cm4gdmlzaXRvci5zZWFyY2goJGN0cmwuc2VhcmNoTW9kZWwpLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgICRjdHJsLnZpc2l0b3JzID0gci5yZXN1bHRzO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuc2VhcmNoTW9kZWwgPSByO1xyXG4gICAgICAgICAgICAgICAgZGVsZXRlICRjdHJsLnNlYXJjaE1vZGVsLnJlc3VsdHM7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5zdGFydFRpbWVyKCk7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5sb2FkaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgIH0pOyBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLnBhZ2VkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkY3RybC52aXNpdG9yID0gbnVsbDsgXHJcbiAgICAgICAgICAgICRjdHJsLnNlYXJjaCh0YWJsZVN0YXRlUmVmKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLnN0YXJ0VGltZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICR0aW1lb3V0LmNhbmNlbCh0aW1lcik7XHJcbiAgICAgICAgICAgIHRpbWVyID0gJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmlzaXRvci5jbGVhcigpO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuJHJvdXRlci5uYXZpZ2F0ZShbJ1dlbGNvbWUnXSk7XHJcbiAgICAgICAgICAgIH0sIGNvbmZpZy5yZWRpcmVjdFRpbWVvdXQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW9kdWxlLmNvbXBvbmVudCgncmVzdWx0cycsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiaW5kaW5nczogeyAkcm91dGVyOiAnPCcgfSxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvcmVzdWx0cy5jb21wb25lbnQuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnY29uZmlnJywgJyR0aW1lb3V0JywgJ3Zpc2l0b3JTZXJ2aWNlJywgY29udHJvbGxlcl1cclxuICAgICAgICB9KTtcclxufVxyXG4pKCk7IiwiLy9zZWFyY2guY29tcG9uZW50LmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoY29uZmlnLCB2aXNpdG9yLCAkdGltZW91dCkge1xyXG4gICAgICAgIHZhciAkY3RybCA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHRpbWVyOyBcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3NlYXJjaCBpbml0Jyk7XHJcbiAgICAgICAgICAgICRjdHJsLnNlYXJjaFRlcm0gPSB2aXNpdG9yLmdldFRlcm0oKTtcclxuICAgICAgICAgICAgJGN0cmwuc3RhcnRUaW1lcigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuZ290b1dlbGNvbWUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZpc2l0b3IuY2xlYXIoKTtcclxuICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKHRpbWVyKTtcclxuICAgICAgICAgICAgdGhpcy4kcm91dGVyLm5hdmlnYXRlKFsnV2VsY29tZSddKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmdvdG9TZWFyY2hSZXN1bHRzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZpc2l0b3Iuc2V0VGVybSgkY3RybC5zZWFyY2hUZXJtKTsgXHJcbiAgICAgICAgICAgICR0aW1lb3V0LmNhbmNlbCh0aW1lcik7XHJcbiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5uYXZpZ2F0ZShbJ1Jlc3VsdHMnXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5zdGFydFRpbWVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkdGltZW91dC5jYW5jZWwodGltZXIpO1xyXG4gICAgICAgICAgICB0aW1lciA9ICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZpc2l0b3IuY2xlYXIoKTtcclxuICAgICAgICAgICAgICAgICRjdHJsLiRyb3V0ZXIubmF2aWdhdGUoWydXZWxjb21lJ10pO1xyXG4gICAgICAgICAgICB9LCBjb25maWcucmVkaXJlY3RUaW1lb3V0KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ3NlYXJjaCcsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiaW5kaW5nczogeyAkcm91dGVyOiAnPCcgfSxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvc2VhcmNoLmNvbXBvbmVudC5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogWydjb25maWcnLCAndmlzaXRvclNlcnZpY2UnLCAnJHRpbWVvdXQnLCBjb250cm9sbGVyXVxyXG4gICAgICAgIH0pO1xyXG59XHJcbikoKTsiLCIvL3dlbGNvbWUuY29tcG9uZW50LmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpczsgXHJcblxyXG4gICAgICAgICRjdHJsLiRvbkluaXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCd3ZWxjb21lIGluaXQnKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuJHJvdXRlck9uQWN0aXZhdGUgPSBmdW5jdGlvbiAobmV4dCkgeyB9O1xyXG5cclxuICAgICAgICAkY3RybC5nb3RvUmVnaXN0ZXIgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgdGhpcy4kcm91dGVyLm5hdmlnYXRlKFsnUmVnaXN0ZXInXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5nb3RvU2VhcmNoID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICB0aGlzLiRyb3V0ZXIubmF2aWdhdGUoWydTZWFyY2gnXSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ3dlbGNvbWUnLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYmluZGluZ3M6IHsgJHJvdXRlcjogJzwnIH0sXHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL3dlbGNvbWUuY29tcG9uZW50Lmh0bWwnLCBcclxuICAgICAgICAgICAgY29udHJvbGxlcjogW2NvbnRyb2xsZXJdXHJcbiAgICAgICAgfSk7XHJcblxyXG59XHJcbikoKTsiLCJhbmd1bGFyLm1vZHVsZShcIm9uU2NyZWVuS2V5Ym9hcmRcIiwgW1wibmdTYW5pdGl6ZVwiXSkuZGlyZWN0aXZlKFwib25TY3JlZW5LZXlib2FyZFwiLCBbXCIkdGltZW91dFwiLCBcIiRkb2N1bWVudFwiLCBmdW5jdGlvbiAoYSwgYikge1xyXG4gICAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICAgIHJlc3RyaWN0OiBcIkVcIixcclxuICAgICAgICBiaW5kVG9Db250cm9sbGVyOiAhMCxcclxuICAgICAgICBjb250cm9sbGVyQXM6IFwiY3RybFwiLFxyXG4gICAgICAgIHNjb3BlOiB7XHJcbiAgICAgICAgICAgIHJvd3M6IFwiPT9cIixcclxuICAgICAgICAgICAgdXBwZXJjYXNlQWxsV29yZHM6IFwiQFwiXHJcbiAgICAgICAgfSxcclxuICAgICAgICBjb250cm9sbGVyOiBbXCIkc2NlXCIsIGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgIHZhciBiID0gdGhpcztcclxuICAgICAgICAgICAgYi5yb3dzIHx8IChiLnJvd3MgPSBbXHJcbiAgICAgICAgICAgICAgICBbXCIxXCIsIFwiMlwiLCBcIjNcIiwgXCI0XCIsIFwiNVwiLCBcIjZcIiwgXCI3XCIsIFwiOFwiLCBcIjlcIiwgXCIwXCIsIHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImVyYXNlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgY29sc3BhbjogMixcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiBcIiZsQXJyO1wiXHJcbiAgICAgICAgICAgICAgICB9XSxcclxuICAgICAgICAgICAgICAgIFtcInFcIiwgXCJ3XCIsIFwiZVwiLCBcInJcIiwgXCJ0XCIsIFwieVwiLCBcInVcIiwgXCJpXCIsIFwib1wiLCBcInBcIiwgXCJAXCJdLFxyXG4gICAgICAgICAgICAgICAgW1wiYVwiLCBcInNcIiwgXCJkXCIsIFwiZlwiLCBcImdcIiwgXCJoXCIsIFwialwiLCBcImtcIiwgXCJsXCIsIFwiLVwiLCBcIl9cIiwge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwibWFyZ2luXCJcclxuICAgICAgICAgICAgICAgIH1dLFxyXG4gICAgICAgICAgICAgICAgW3tcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInNoaWZ0XCJcclxuICAgICAgICAgICAgICAgIH0sIFwielwiLCBcInhcIiwgXCJjXCIsIFwidlwiLCBcImJcIiwgXCJuXCIsIFwibVwiLCBcIixcIiwgXCIuXCIsIHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInNoaWZ0XCJcclxuICAgICAgICAgICAgICAgIH1dLFxyXG4gICAgICAgICAgICAgICAgW3tcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm1hcmdpblwiXHJcbiAgICAgICAgICAgICAgICB9LCB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzcGFjZVwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbHNwYW46IDksXHJcbiAgICAgICAgICAgICAgICAgICAgdGV4dDogXCIgXCJcclxuICAgICAgICAgICAgICAgIH1dXHJcbiAgICAgICAgICAgIF0pLFxyXG4gICAgICAgICAgICAgICAgYi5nZXRUZXh0ID0gZnVuY3Rpb24gKGIpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoXCJtYXJnaW5cIiA9PT0gYi50eXBlKSByZXR1cm4gXCJcIjtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoXCJzaGlmdFwiID09PSBiLnR5cGUpIHJldHVybiBcIiZkQXJyO1wiO1xyXG4gICAgICAgICAgICAgICAgICAgIHZhciBjID0gYi50ZXh0IHx8IGI7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGMgJiYgYy5pbmRleE9mKFwiJlwiKSA+IC0xID8gYS50cnVzdEFzSHRtbChjKSA6IGM7XHJcbiAgICAgICAgICAgICAgICB9O1xyXG4gICAgICAgIH1dLFxyXG4gICAgICAgIGxpbms6IGZ1bmN0aW9uIChjLCBkLCBlKSB7XHJcbiAgICAgICAgICAgIHZhciBmID0gYy5jdHJsO1xyXG4gICAgICAgICAgICBkLmJpbmQoXCJjb250ZXh0bWVudVwiLCBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGEucHJldmVudERlZmF1bHQoKSwgITE7XHJcbiAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICAgICAgZi5pc1VwcGVyQ2FzZSA9ICExLCBmLmxhc3RJbnB1dEN0cmwgPSBudWxsLCBmLnN0YXJ0UG9zID0gbnVsbCwgZi5lbmRQb3MgPSBudWxsLFxyXG4gICAgICAgICAgICAgICAgZi5wcmludEtleVN0cm9rZSA9IGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGYubGFzdElucHV0Q3RybCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYiA9IGFuZ3VsYXIuZWxlbWVudChhLnRhcmdldCB8fCBhLnNyY0VsZW1lbnQpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoYi5oYXNDbGFzcyhcImVyYXNlXCIpKSByZXR1cm4gdm9pZCBmLmVyYXNlS2V5U3Ryb2tlKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiLmhhc0NsYXNzKFwic2hpZnRcIikpIHJldHVybiB2b2lkIGYuaW52ZXJzZUNhc2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBhbmd1bGFyLmVsZW1lbnQoZi5sYXN0SW5wdXRDdHJsKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgPSBjLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZSA9IGQuc3Vic3RyaW5nKDAsIGYuc3RhcnRQb3MpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZyA9IGQuc3Vic3RyaW5nKGYuZW5kUG9zLCBkLmxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGMudmFsKGUgKyBiLnRleHQoKSArIGcpLCBjLnRyaWdnZXJIYW5kbGVyKFwiY2hhbmdlXCIpLCBmLnN0YXJ0UG9zKysgLCBmLmVuZFBvcysrICwgZi5zZXRLZXlib2FyZExheW91dCgpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBmLmludmVyc2VDYXNlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vdmFyIGEgPSBkWzBdLnF1ZXJ5U2VsZWN0b3JBbGwoXCIubGV0dGVyXCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vYW5ndWxhci5mb3JFYWNoKGEsIGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgdmFyIGIgPSBhbmd1bGFyLmVsZW1lbnQoYSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy8gICAgZi5pc1VwcGVyQ2FzZSA/IGIudGV4dChiLnRleHQoKS50b1N0cmluZygpLnRvTG93ZXJDYXNlKCkpIDogYi50ZXh0KGIudGV4dCgpLnRvU3RyaW5nKCkudG9VcHBlckNhc2UoKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgLy99KSwgYW5ndWxhci5mb3JFYWNoKGRbMF0ucXVlcnlTZWxlY3RvckFsbChcIi5zaGlmdFwiKSwgZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICBmLmlzVXBwZXJDYXNlID8gYW5ndWxhci5lbGVtZW50KGEpLmh0bWwoXCImZEFycjtcIikgOiBhbmd1bGFyLmVsZW1lbnQoYSkuaHRtbChcIiZ1QXJyO1wiKTtcclxuICAgICAgICAgICAgICAgICAgICAvL30pLCBmLmlzVXBwZXJDYXNlID0gIWYuaXNVcHBlckNhc2U7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgZi5yZWZvY3VzID0gZnVuY3Rpb24gKCkgeyBmLmxhc3RJbnB1dEN0cmwuZm9jdXMoKSB9LFxyXG4gICAgICAgICAgICAgICAgZi5lcmFzZUtleVN0cm9rZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZi5sYXN0SW5wdXRDdHJsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBhID0gZi5zdGFydFBvcyAhPT0gZi5lbmRQb3MsXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBiID0gYW5ndWxhci5lbGVtZW50KGYubGFzdElucHV0Q3RybCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjID0gYi52YWwoKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGQgPSBjLnN1YnN0cmluZygwLCBhID8gZi5zdGFydFBvcyA6IGYuc3RhcnRQb3MgLSAxKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGUgPSBjLnN1YnN0cmluZyhmLmVuZFBvcywgYy5sZW5ndGgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBiLnZhbChkICsgZSksIGIudHJpZ2dlckhhbmRsZXIoXCJjaGFuZ2VcIiksIGEgPyBmLmVuZFBvcyA9IGYuc3RhcnRQb3MgOiAoZi5zdGFydFBvcy0tICwgZi5lbmRQb3MtLSksIGYubGFzdElucHV0Q3RybC5zZWxlY3Rpb25TdGFydCA9IGYuc3RhcnRQb3MsIGYubGFzdElucHV0Q3RybC5zZWxlY3Rpb25FbmQgPSBmLnN0YXJ0UG9zLCBmLnNldEtleWJvYXJkTGF5b3V0KCksIGYucmVmb2N1cygpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgIH0sIGYuc2V0S2V5Ym9hcmRMYXlvdXQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGYubGFzdElucHV0Q3RybCA/IHZvaWQgKGYubGFzdElucHV0Q3RybC5jbGFzc05hbWUgJiYgZi5pc1VwcGVyQ2FzZSA/IGYuaW52ZXJzZUNhc2UoKSA6IDAgPT09IGFuZ3VsYXIuZWxlbWVudChmLmxhc3RJbnB1dEN0cmwpLnZhbCgpLmxlbmd0aCA/IGYuaXNVcHBlckNhc2UgfHwgKGYuaXNVcHBlckNhc2UgPSAhMSwgZi5pbnZlcnNlQ2FzZSgpKSA6IFwiIFwiID09PSBhbmd1bGFyLmVsZW1lbnQoZi5sYXN0SW5wdXRDdHJsKS52YWwoKS5zbGljZSgtMSkgJiYgIWYuaXNVcHBlckNhc2UgJiYgZS5oYXNPd25Qcm9wZXJ0eShcInVwcGVyY2FzZUFsbFdvcmRzXCIpID8gZi5pbnZlcnNlQ2FzZSgpIDogKGYuaXNVcHBlckNhc2UgPSAhMCwgZi5pbnZlcnNlQ2FzZSgpKSkgOiAoZi5pc1VwcGVyQ2FzZSA9ICExLCB2b2lkIGYuaW52ZXJzZUNhc2UoKSk7XHJcbiAgICAgICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICAgICAgYi5maW5kKFwiaW5wdXRcIikuYmluZChcImJsdXIgZm9jdXNcIiwgZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGYuc2V0S2V5Ym9hcmRMYXlvdXQoKSwgZi5sYXN0SW5wdXRDdHJsID0gdGhpcywgZi5sYXN0SW5wdXRDdHJsICYmIFwiY2hlY2tib3hcIiAhPT0gZi5sYXN0SW5wdXRDdHJsLnR5cGUgJiYgKGYuc3RhcnRQb3MgPSBmLmxhc3RJbnB1dEN0cmwuc2VsZWN0aW9uU3RhcnQsIGYuZW5kUG9zID0gZi5sYXN0SW5wdXRDdHJsLnNlbGVjdGlvbkVuZCk7XHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgICAgIC5iaW5kKFwia2V5ZG93blwiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGYuc3RhcnRQb3MgPSBmLmxhc3RJbnB1dEN0cmwuc2VsZWN0aW9uU3RhcnQsIGYuZW5kUG9zID0gZi5sYXN0SW5wdXRDdHJsLnNlbGVjdGlvbkVuZDtcclxuICAgICAgICAgICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgICAgIGEoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGYuaW52ZXJzZUNhc2UoKTtcclxuICAgICAgICAgICAgICAgIH0sIDApO1xyXG4gICAgICAgIH0sXHJcbiAgICAgICAgdGVtcGxhdGVVcmw6IFwiL3RlbXBsYXRlcy9hbmd1bGFyLW9uLXNjcmVlbi1rZXlib2FyZC5odG1sXCJcclxuICAgIH07XHJcbn1dKTs7XHJcbmFuZ3VsYXIubW9kdWxlKCdvblNjcmVlbktleWJvYXJkJykucnVuKFsnJHRlbXBsYXRlQ2FjaGUnLCBmdW5jdGlvbiAoJHRlbXBsYXRlQ2FjaGUpIHtcclxuICAgICd1c2Ugc3RyaWN0JztcclxuXHJcbiAgICAkdGVtcGxhdGVDYWNoZS5wdXQoJy90ZW1wbGF0ZXMvYW5ndWxhci1vbi1zY3JlZW4ta2V5Ym9hcmQuaHRtbCcsXHJcbiAgICAgICAgXCI8ZGl2IGNsYXNzPWtleWJvYXJkPjx0YWJsZT48dHIgbmctcmVwZWF0PVxcXCJyb3cgaW4gY3RybC5yb3dzXFxcIj48dGQgbmctcmVwZWF0PVxcXCJrZXkgaW4gcm93XFxcIiBuZy1jbGljaz1jdHJsLnByaW50S2V5U3Ryb2tlKCRldmVudCkgY29sc3Bhbj1cXFwie3trZXkuY29sc3BhbiB8fCAxfX1cXFwiIG5nLWNsYXNzPVxcXCJ7J2J1dHRvbic6IGtleS50eXBlICE9PSAnbWFyZ2luJywgJ2xldHRlcic6IGtleS50eXBlICE9PSAnbWFyZ2luJ31cXFwiIGNsYXNzPXt7a2V5LnR5cGV9fSBuZy1iaW5kLWh0bWw9Y3RybC5nZXRUZXh0KGtleSk+PC90ZD48L3RyPjwvdGFibGU+PC9kaXY+XCJcclxuICAgICk7XHJcblxyXG59XSk7IiwiLy92aXNpdG9yLnNlcnZpY2UuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7XHJcbiAgICBcclxuICAgIGZ1bmN0aW9uIGZhY3RvcnkoJGh0dHAsIGNvbmZpZykge1xyXG4gICAgICAgIHZhciB2aXNpdG9yID0ge307XHJcbiAgICAgICAgdmFyIHRlcm0gPSAnJztcclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICBjbGVhcjogY2xlYXIsXHJcbiAgICAgICAgICAgIGNsZWFyVGVybTogY2xlYXJUZXJtLCBcclxuICAgICAgICAgICAgZ2V0OiBnZXQsXHJcbiAgICAgICAgICAgIGdldFRlcm06IGdldFRlcm0sXHJcbiAgICAgICAgICAgIHNldDogc2V0LFxyXG4gICAgICAgICAgICBzZXRUZXJtOiBzZXRUZXJtLFxyXG4gICAgICAgICAgICBzYXZlOiBzYXZlLCBcclxuICAgICAgICAgICAgc2VhcmNoOiBzZWFyY2hcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICBmdW5jdGlvbiBjbGVhcigpIHtcclxuICAgICAgICAgICAgdmlzaXRvciA9IHt9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY2xlYXJUZXJtKCkge1xyXG4gICAgICAgICAgICB0ZXJtID0gJyc7IFxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gZ2V0KCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdmlzaXRvcjtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdldFRlcm0oKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB0ZXJtO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2V0KHYpIHtcclxuICAgICAgICAgICAgdmlzaXRvciA9IHY7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzZXRUZXJtKHQpIHtcclxuICAgICAgICAgICAgdGVybSA9IHQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBzZWFyY2gobW9kZWwpIHtcclxuICAgICAgICAgICAgcmV0dXJuICRodHRwLmdldChjb25maWcuYXBpVXJsLCB7IHBhcmFtczogbW9kZWwgfSkudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHIuZGF0YTsgXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2F2ZSh2KSB7XHJcbiAgICAgICAgICAgICRodHRwLnBvc3QoY29uZmlnLmFwaVVybCwgdmlzaXRvcikudGhlbihmdW5jdGlvbiAocikge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ3NhdmVkIG5ldyB2aXNpdG9yJywgdmlzaXRvcik7XHJcbiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoJ3NvbWV0aGluZyB3ZW50IHdyb25nJywgZXJyLm1lc3NhZ2UpO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5mYWN0b3J5KCd2aXNpdG9yU2VydmljZScsIFsnJGh0dHAnLCAnY29uZmlnJywgZmFjdG9yeV0pO1xyXG5cclxufVxyXG4pKCk7Il19
