!function(){var e=angular.module("app",["ngComponentRouter","ui.bootstrap","ngMessages","onScreenKeyboard"]);e.component("kiosk",{template:"<ng-outlet>Loading ..</ng-outlet >",$routeConfig:[{path:"/",name:"Welcome",component:"welcome",useAsDefault:!0},{path:"/register",name:"Register",component:"register"},{path:"/pledge",name:"Pledge",component:"pledge"},{path:"/finish",name:"Finish",component:"finish"},{path:"/search",name:"Search",component:"search"},{path:"/results",name:"Results",component:"results"}]}),e.value("$routerRootComponent","kiosk"),e.value("remoteApi",{url:"http://localhost:49960/api/"}),e.value("config",{apiUrl:"http://localhost:49960/api/visitor",hubUrl:"http://localhost:49960/signalr",redirectTimeout:3e4,finishTimeout:4})}();
!function(){function n(n,t,o){var i=this;i.$onInit=function(){console.log("finish init",n),$.connection.hub.url=n.hubUrl;var o=$.connection.nameNotificationHub;$.connection.hub.start().done(function(){console.log("hub connection started"),o.server.addName(1,t.get())}),i.countDown_tick=n.finishTimeout,i.startTimer()},this.$routerOnActivate=function(n){i.$router=this.$router},i.startTimer=function(){i.countDown_tick<=0?(t.clear(),console.log("timer finished"),i.$router.navigate(["Welcome"])):(i.countDown_tick--,o(i.startTimer,1e3))}}var t=angular.module("app");t.component("finish",{bindings:{$router:"<"},templateUrl:"app/finish.component.html",controller:["config","visitorService","$timeout",n]})}();
!function(){function e(e,t,n){var o,i=this;i.$onInit=function(){console.log("pledge init"),i.visitor=n.get(),i.startTimer()},this.$routerOnActivate=function(e){},i.gotoWelcome=function(){n.clear(),e.cancel(o),this.$router.navigate(["Welcome"])},i.gotoRegister=function(){e.cancel(o),this.$router.navigate(["Register"])},i.pledge=function(){n.get().id?console.log("returning visitor",n.get()):(console.log("save new visitor",n.get()),n.save()),e.cancel(o),this.$router.navigate(["Finish"])},i.startTimer=function(){e.cancel(o),o=e(function(){n.clear(),i.$router.navigate(["Welcome"])},t.redirectTimeout)}}var t=angular.module("app");t.component("pledge",{bindings:{$router:"<"},templateUrl:"app/pledge.component.html",controller:["$timeout","config","visitorService",e]})}();
!function(){function t(t,e,o){var n,r=this;r.$onInit=function(){r.visitor=e.get(),r.startTimer()},this.$routerOnActivate=function(t){r.$router=this.$router},r.gotoWelcome=function(){o.cancel(n),this.$router.navigate(["Welcome"])},r.gotoPledge=function(){o.cancel(n),this.$router.navigate(["Pledge"])},r.startTimer=function(){o.cancel(n),n=o(function(){e.clear(),r.$router.navigate(["Welcome"])},t.redirectTimeout)}}var e=angular.module("app");e.component("register",{bindings:{$router:"<"},templateUrl:"app/register.component.html",controller:["config","visitorService","$timeout",t]})}();
!function(){function e(e,t,r){var n,o,a=this,c=10;a.searchModel={page:1,pageSize:c},a.paging={currentPage:1},a.$onInit=function(){console.log("search init");const e=r.getTerm().split(" ");e.length>1?(a.searchModel.firstname=e[0],a.searchModel.lastname=e[1]):a.searchModel.lastname=e[0],a.search()},a.gotoWelcome=function(){t.cancel(n),this.$router.navigate(["Welcome"])},a.gotoSearch=function(){t.cancel(n),this.$router.navigate(["Search"])},a.pledge=function(){r.clearTerm(),t.cancel(n),this.$router.navigate(["Pledge"])},a.toggleName=function(e){a.visitor=e,r.set(e),a.startTimer()},a.search=function(e){return o=e,r.search(a.searchModel).then(function(e){a.visitors=e.results,a.searchModel=e,delete a.searchModel.results,a.startTimer()})},a.paged=function(){a.visitor=null,a.search(o)},a.startTimer=function(){t.cancel(n),n=t(function(){r.clear(),a.$router.navigate(["Welcome"])},e.redirectTimeout)}}var t=angular.module("app");t.component("results",{bindings:{$router:"<"},templateUrl:"app/results.component.html",controller:["config","$timeout","visitorService",e]})}();
!function(){function e(e,t,r){var n,o=this;o.$onInit=function(){console.log("search init"),o.searchTerm=t.getTerm(),o.startTimer()},o.gotoWelcome=function(){t.clear(),r.cancel(n),this.$router.navigate(["Welcome"])},o.gotoSearchResults=function(){t.setTerm(o.searchTerm),r.cancel(n),this.$router.navigate(["Results"])},o.startTimer=function(){r.cancel(n),n=r(function(){t.clear(),o.$router.navigate(["Welcome"])},e.redirectTimeout)}}var t=angular.module("app");t.component("search",{bindings:{$router:"<"},templateUrl:"app/search.component.html",controller:["config","visitorService","$timeout",e]})}();
!function(){function t(){var t=this;t.$onInit=function(){console.log("welcome init")},this.$routerOnActivate=function(t){},t.gotoRegister=function(){this.$router.navigate(["Register"])},t.gotoSearch=function(){this.$router.navigate(["Search"])}}var o=angular.module("app");o.component("welcome",{bindings:{$router:"<"},templateUrl:"app/welcome.component.html",controller:[t]})}();
!function(){function n(n,t){function e(){s={}}function r(){g=""}function o(){return s}function c(){return g}function i(n){s=n}function u(n){g=n}function a(e){return n.get(t.apiUrl,{params:e}).then(function(n){return n.data})}function f(e){n.post(t.apiUrl,s).then(function(n){console.log("saved new visitor",s)}).catch(function(n){console.error("something went wrong",n.message)})}var s={},g="";return{clear:e,clearTerm:r,get:o,getTerm:c,set:i,setTerm:u,save:f,search:a}}var t=angular.module("app");t.factory("visitorService",["$http","config",n])}();
angular.module("onScreenKeyboard",["ngSanitize"]).directive("onScreenKeyboard",["$timeout","$document",function(t,e){"use strict";return{restrict:"E",bindToController:!0,controllerAs:"ctrl",scope:{rows:"=?",uppercaseAllWords:"@"},controller:["$sce",function(t){var e=this;e.rows||(e.rows=[["1","2","3","4","5","6","7","8","9","0",{type:"erase",colspan:2,text:"&lArr;"}],["q","w","e","r","t","y","u","i","o","p","@"],["a","s","d","f","g","h","j","k","l","-","_",{type:"margin"}],[{type:"shift"},"z","x","c","v","b","n","m",",",".",{type:"shift"}],[{type:"margin"},{type:"space",colspan:9,text:" "}]]),e.getText=function(e){if("margin"===e.type)return"";if("shift"===e.type)return"&dArr;";var r=e.text||e;return r&&r.indexOf("&")>-1?t.trustAsHtml(r):r}}],link:function(r,n,s){var a=r.ctrl;n.bind("contextmenu",function(t){return t.preventDefault(),!1}),a.isUpperCase=!1,a.lastInputCtrl=null,a.startPos=null,a.endPos=null,a.printKeyStroke=function(t){if(a.lastInputCtrl){var e=angular.element(t.target||t.srcElement);if(e.hasClass("erase"))return void a.eraseKeyStroke();if(e.hasClass("shift"))return void a.inverseCase();var r=angular.element(a.lastInputCtrl),n=r.val(),s=n.substring(0,a.startPos),l=n.substring(a.endPos,n.length);r.val(s+e.text()+l),r.triggerHandler("change"),a.startPos++,a.endPos++,a.setKeyboardLayout()}},a.inverseCase=function(){},a.refocus=function(){a.lastInputCtrl.focus()},a.eraseKeyStroke=function(){if(a.lastInputCtrl){var t=a.startPos!==a.endPos,e=angular.element(a.lastInputCtrl),r=e.val(),n=r.substring(0,t?a.startPos:a.startPos-1),s=r.substring(a.endPos,r.length);e.val(n+s),e.triggerHandler("change"),t?a.endPos=a.startPos:(a.startPos--,a.endPos--),a.lastInputCtrl.selectionStart=a.startPos,a.lastInputCtrl.selectionEnd=a.startPos,a.setKeyboardLayout(),a.refocus()}},a.setKeyboardLayout=function(){return a.lastInputCtrl?void(a.lastInputCtrl.className&&a.isUpperCase?a.inverseCase():0===angular.element(a.lastInputCtrl).val().length?a.isUpperCase||(a.isUpperCase=!1,a.inverseCase()):" "===angular.element(a.lastInputCtrl).val().slice(-1)&&!a.isUpperCase&&s.hasOwnProperty("uppercaseAllWords")?a.inverseCase():(a.isUpperCase=!0,a.inverseCase())):(a.isUpperCase=!1,void a.inverseCase())},e.find("input").bind("blur focus",function(){a.setKeyboardLayout(),a.lastInputCtrl=this,a.lastInputCtrl&&"checkbox"!==a.lastInputCtrl.type&&(a.startPos=a.lastInputCtrl.selectionStart,a.endPos=a.lastInputCtrl.selectionEnd)}).bind("keydown",function(){a.startPos=a.lastInputCtrl.selectionStart,a.endPos=a.lastInputCtrl.selectionEnd}),t(function(){a.inverseCase()},0)},templateUrl:"/templates/angular-on-screen-keyboard.html"}}]),angular.module("onScreenKeyboard").run(["$templateCache",function(t){"use strict";t.put("/templates/angular-on-screen-keyboard.html","<div class=keyboard><table><tr ng-repeat=\"row in ctrl.rows\"><td ng-repeat=\"key in row\" ng-click=ctrl.printKeyStroke($event) colspan=\"{{key.colspan || 1}}\" ng-class=\"{'button': key.type !== 'margin', 'letter': key.type !== 'margin'}\" class={{key.type}} ng-bind-html=ctrl.getText(key)></td></tr></table></div>")}]);
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJmaW5pc2guY29tcG9uZW50LmpzIiwicGxlZGdlLmNvbXBvbmVudC5qcyIsInJlZ2lzdGVyLmNvbXBvbmVudC5qcyIsInJlc3VsdHMuY29tcG9uZW50LmpzIiwic2VhcmNoLmNvbXBvbmVudC5qcyIsIndlbGNvbWUuY29tcG9uZW50LmpzIiwic2VydmljZXMvdmlzaXRvci5zZXJ2aWNlLmpzIiwiZGlyZWN0aXZlcy9hbmd1bGFyLW9uLXNjcmVlbi1rZXlib2FyZC5qcyJdLCJuYW1lcyI6WyJtb2R1bGUiLCJhbmd1bGFyIiwiY29tcG9uZW50IiwidGVtcGxhdGUiLCIkcm91dGVDb25maWciLCJwYXRoIiwibmFtZSIsInVzZUFzRGVmYXVsdCIsInZhbHVlIiwidXJsIiwiYXBpVXJsIiwiaHViVXJsIiwicmVkaXJlY3RUaW1lb3V0IiwiZmluaXNoVGltZW91dCIsImNvbnRyb2xsZXIiLCJjb25maWciLCJ2aXNpdG9yIiwiJHRpbWVvdXQiLCIkY3RybCIsInRoaXMiLCIkb25Jbml0IiwiY29uc29sZSIsImxvZyIsIiQiLCJjb25uZWN0aW9uIiwiaHViIiwibmFtZU5vdGlmaWNhdGlvbkh1YiIsInN0YXJ0IiwiZG9uZSIsInNlcnZlciIsImFkZE5hbWUiLCJnZXQiLCJjb3VudERvd25fdGljayIsInN0YXJ0VGltZXIiLCIkcm91dGVyT25BY3RpdmF0ZSIsIm5leHQiLCIkcm91dGVyIiwiY2xlYXIiLCJuYXZpZ2F0ZSIsImJpbmRpbmdzIiwidGVtcGxhdGVVcmwiLCJ0aW1lciIsImdvdG9XZWxjb21lIiwiY2FuY2VsIiwiZ290b1JlZ2lzdGVyIiwicGxlZGdlIiwiaWQiLCJzYXZlIiwiZ290b1BsZWRnZSIsInRhYmxlU3RhdGVSZWYiLCJwYWdlU2l6ZURlZmF1bHQiLCJzZWFyY2hNb2RlbCIsInBhZ2UiLCJwYWdlU2l6ZSIsInBhZ2luZyIsImN1cnJlbnRQYWdlIiwibmFtZXMiLCJnZXRUZXJtIiwic3BsaXQiLCJsZW5ndGgiLCJmaXJzdG5hbWUiLCJsYXN0bmFtZSIsInNlYXJjaCIsImdvdG9TZWFyY2giLCJjbGVhclRlcm0iLCJ0b2dnbGVOYW1lIiwidiIsInNldCIsInRhYmxlU3RhdGUiLCJ0aGVuIiwiciIsInZpc2l0b3JzIiwicmVzdWx0cyIsInBhZ2VkIiwic2VhcmNoVGVybSIsImdvdG9TZWFyY2hSZXN1bHRzIiwic2V0VGVybSIsImZhY3RvcnkiLCIkaHR0cCIsInRlcm0iLCJ0IiwibW9kZWwiLCJwYXJhbXMiLCJkYXRhIiwicG9zdCIsImNhdGNoIiwiZXJyIiwiZXJyb3IiLCJtZXNzYWdlIiwiZGlyZWN0aXZlIiwiYSIsImIiLCJyZXN0cmljdCIsImJpbmRUb0NvbnRyb2xsZXIiLCJjb250cm9sbGVyQXMiLCJzY29wZSIsInJvd3MiLCJ1cHBlcmNhc2VBbGxXb3JkcyIsInR5cGUiLCJjb2xzcGFuIiwidGV4dCIsImdldFRleHQiLCJjIiwiaW5kZXhPZiIsInRydXN0QXNIdG1sIiwibGluayIsImQiLCJlIiwiZiIsImN0cmwiLCJiaW5kIiwicHJldmVudERlZmF1bHQiLCJpc1VwcGVyQ2FzZSIsImxhc3RJbnB1dEN0cmwiLCJzdGFydFBvcyIsImVuZFBvcyIsInByaW50S2V5U3Ryb2tlIiwiZWxlbWVudCIsInRhcmdldCIsInNyY0VsZW1lbnQiLCJoYXNDbGFzcyIsImVyYXNlS2V5U3Ryb2tlIiwiaW52ZXJzZUNhc2UiLCJ2YWwiLCJzdWJzdHJpbmciLCJnIiwidHJpZ2dlckhhbmRsZXIiLCJzZXRLZXlib2FyZExheW91dCIsInJlZm9jdXMiLCJmb2N1cyIsInNlbGVjdGlvblN0YXJ0Iiwic2VsZWN0aW9uRW5kIiwiY2xhc3NOYW1lIiwic2xpY2UiLCJoYXNPd25Qcm9wZXJ0eSIsImZpbmQiLCJydW4iLCIkdGVtcGxhdGVDYWNoZSIsInB1dCJdLCJtYXBwaW5ncyI6IkNBQ0EsV0FDSSxHQUFJQSxHQUFTQyxRQUFRRCxPQUFPLE9BQVEsb0JBQXFCLGVBQWdCLGFBQWMsb0JBRXZGQSxHQUFPRSxVQUFVLFNBRVRDLFNBQVUscUNB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QUksNkNBQ2YiLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vYXBwLm1vZHVsZS5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnLCBbJ25nQ29tcG9uZW50Um91dGVyJywgJ3VpLmJvb3RzdHJhcCcsICduZ01lc3NhZ2VzJywgJ29uU2NyZWVuS2V5Ym9hcmQnXSk7XHJcblxyXG4gICAgbW9kdWxlLmNvbXBvbmVudCgna2lvc2snLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGVtcGxhdGU6ICc8bmctb3V0bGV0PkxvYWRpbmcgLi48L25nLW91dGxldCA+JyxcclxuICAgICAgICAgICAgJHJvdXRlQ29uZmlnOiBbXHJcbiAgICAgICAgICAgICAgICB7IHBhdGg6ICcvJywgbmFtZTogJ1dlbGNvbWUnLCBjb21wb25lbnQ6ICd3ZWxjb21lJywgdXNlQXNEZWZhdWx0OiB0cnVlIH0sXHJcbiAgICAgICAgICAgICAgICB7IHBhdGg6ICcvcmVnaXN0ZXInLCBuYW1lOiAnUmVnaXN0ZXInLCBjb21wb25lbnQ6ICdyZWdpc3RlcicgfSxcclxuICAgICAgICAgICAgICAgIHsgcGF0aDogJy9wbGVkZ2UnLCBuYW1lOiAnUGxlZGdlJywgY29tcG9uZW50OiAncGxlZGdlJyB9LFxyXG4gICAgICAgICAgICAgICAgeyBwYXRoOiAnL2ZpbmlzaCcsIG5hbWU6ICdGaW5pc2gnLCBjb21wb25lbnQ6ICdmaW5pc2gnIH0sXHJcbiAgICAgICAgICAgICAgICB7IHBhdGg6ICcvc2VhcmNoJywgbmFtZTogJ1NlYXJjaCcsIGNvbXBvbmVudDogJ3NlYXJjaCcgfSxcclxuICAgICAgICAgICAgICAgIHsgcGF0aDogJy9yZXN1bHRzJywgbmFtZTogJ1Jlc3VsdHMnLCBjb21wb25lbnQ6ICdyZXN1bHRzJyB9XHJcbiAgICAgICAgICAgIF1cclxuICAgICAgICB9KTtcclxuXHJcbiAgICBtb2R1bGUudmFsdWUoJyRyb3V0ZXJSb290Q29tcG9uZW50JywgJ2tpb3NrJyk7XHJcbiAgICBtb2R1bGUudmFsdWUoJ3JlbW90ZUFwaScsIHsgdXJsOiAnaHR0cDovL2xvY2FsaG9zdDo0OTk2MC9hcGkvJyB9KTtcclxuICAgIG1vZHVsZS52YWx1ZSgnY29uZmlnJyxcclxuICAgIHtcclxuICAgICAgICBhcGlVcmw6ICdodHRwOi8vbG9jYWxob3N0OjQ5OTYwL2FwaS92aXNpdG9yJywgXHJcbiAgICAgICAgaHViVXJsOiAnaHR0cDovL2xvY2FsaG9zdDo0OTk2MC9zaWduYWxyJywgXHJcbiAgICAgICAgcmVkaXJlY3RUaW1lb3V0OiAzMDAwMCwgXHJcbiAgICAgICAgZmluaXNoVGltZW91dCA6IDRcclxuICAgIH0pO1xyXG59XHJcbikoKTsiLCIvL2ZpbmlzaC5jb21wb25lbnQuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7XHJcbiAgICAvL1RPRE86IFNFVC9HRVQga2lvc2sgbnVtYmVyIGZyb20gbG9jYWwgc3RvcmFnZVxyXG4gICAgZnVuY3Rpb24gY29udHJvbGxlcihjb25maWcsIHZpc2l0b3IsICR0aW1lb3V0KSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ2ZpbmlzaCBpbml0JywgY29uZmlnKTtcclxuICAgICAgICAgICAgJC5jb25uZWN0aW9uLmh1Yi51cmwgPSBjb25maWcuaHViVXJsO1xyXG4gICAgICAgICAgICB2YXIgaHViID0gJC5jb25uZWN0aW9uLm5hbWVOb3RpZmljYXRpb25IdWI7XHJcbiAgICAgICAgICAgICQuY29ubmVjdGlvbi5odWIuc3RhcnQoKS5kb25lKGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ2h1YiBjb25uZWN0aW9uIHN0YXJ0ZWQnKTtcclxuICAgICAgICAgICAgICAgIGh1Yi5zZXJ2ZXIuYWRkTmFtZSgxLCB2aXNpdG9yLmdldCgpKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAkY3RybC5jb3VudERvd25fdGljayA9IGNvbmZpZy5maW5pc2hUaW1lb3V0O1xyXG4gICAgICAgICAgICAkY3RybC5zdGFydFRpbWVyKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLiRyb3V0ZXJPbkFjdGl2YXRlID0gZnVuY3Rpb24gKG5leHQpIHtcclxuICAgICAgICAgICAgJGN0cmwuJHJvdXRlciA9IHRoaXMuJHJvdXRlcjsgXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJGN0cmwuc3RhcnRUaW1lciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCRjdHJsLmNvdW50RG93bl90aWNrIDw9IDApIHtcclxuICAgICAgICAgICAgICAgIHZpc2l0b3IuY2xlYXIoKTtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCd0aW1lciBmaW5pc2hlZCcpO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuJHJvdXRlci5uYXZpZ2F0ZShbJ1dlbGNvbWUnXSk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5jb3VudERvd25fdGljay0tO1xyXG4gICAgICAgICAgICAgICAgJHRpbWVvdXQoJGN0cmwuc3RhcnRUaW1lciwgMTAwMCk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9O1xyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb2R1bGUuY29tcG9uZW50KCdmaW5pc2gnLFxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgYmluZGluZ3M6IHtcclxuICAgICAgICAgICAgICAgICRyb3V0ZXI6ICc8J1xyXG4gICAgICAgICAgICB9LFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9maW5pc2guY29tcG9uZW50Lmh0bWwnLFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiBbJ2NvbmZpZycsICd2aXNpdG9yU2VydmljZScsICckdGltZW91dCcsIGNvbnRyb2xsZXJdXHJcbiAgICAgICAgfSk7XHJcbn1cclxuKSgpOyIsIi8vcGxlZGdlLmNvbXBvbmVudC5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnKTtcclxuICAgIC8vVE9ETzogR0VUIGh1YiB1cmwgZnJvbSBzZXR0aW5nc1xyXG4gICAgZnVuY3Rpb24gY29udHJvbGxlcigkdGltZW91dCwgY29uZmlnLCB2aXNpdG9yKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuICAgICAgICB2YXIgdGltZXI7IFxyXG5cclxuICAgICAgICAkY3RybC4kb25Jbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygncGxlZGdlIGluaXQnKTtcclxuICAgICAgICAgICAgJGN0cmwudmlzaXRvciA9IHZpc2l0b3IuZ2V0KCk7XHJcbiAgICAgICAgICAgICRjdHJsLnN0YXJ0VGltZXIoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuJHJvdXRlck9uQWN0aXZhdGUgPSBmdW5jdGlvbiAobmV4dCkgeyB9O1xyXG5cclxuICAgICAgICAkY3RybC5nb3RvV2VsY29tZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgdmlzaXRvci5jbGVhcigpO1xyXG4gICAgICAgICAgICAkdGltZW91dC5jYW5jZWwodGltZXIpO1xyXG4gICAgICAgICAgICB0aGlzLiRyb3V0ZXIubmF2aWdhdGUoWydXZWxjb21lJ10pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuZ290b1JlZ2lzdGVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkdGltZW91dC5jYW5jZWwodGltZXIpO1xyXG4gICAgICAgICAgICB0aGlzLiRyb3V0ZXIubmF2aWdhdGUoWydSZWdpc3RlciddKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLnBsZWRnZSA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgaWYgKCF2aXNpdG9yLmdldCgpLmlkKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygnc2F2ZSBuZXcgdmlzaXRvcicsIHZpc2l0b3IuZ2V0KCkpO1xyXG4gICAgICAgICAgICAgICAgdmlzaXRvci5zYXZlKCk7XHJcbiAgICAgICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygncmV0dXJuaW5nIHZpc2l0b3InLCB2aXNpdG9yLmdldCgpKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAkdGltZW91dC5jYW5jZWwodGltZXIpO1xyXG4gICAgICAgICAgICB0aGlzLiRyb3V0ZXIubmF2aWdhdGUoWydGaW5pc2gnXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5zdGFydFRpbWVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkdGltZW91dC5jYW5jZWwodGltZXIpO1xyXG4gICAgICAgICAgICB0aW1lciA9ICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZpc2l0b3IuY2xlYXIoKTtcclxuICAgICAgICAgICAgICAgICRjdHJsLiRyb3V0ZXIubmF2aWdhdGUoWydXZWxjb21lJ10pO1xyXG4gICAgICAgICAgICB9LCBjb25maWcucmVkaXJlY3RUaW1lb3V0KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ3BsZWRnZScsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiaW5kaW5nczoge1xyXG4gICAgICAgICAgICAgICAgJHJvdXRlcjogJzwnXHJcbiAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnYXBwL3BsZWRnZS5jb21wb25lbnQuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnJHRpbWVvdXQnLCAnY29uZmlnJywgJ3Zpc2l0b3JTZXJ2aWNlJywgY29udHJvbGxlcl1cclxuICAgICAgICB9KTtcclxufVxyXG4pKCk7IiwiLy9yZWdpc3Rlci5jb21wb25lbnQuanNcclxuKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBtb2R1bGUgPSBhbmd1bGFyLm1vZHVsZSgnYXBwJyk7XHJcblxyXG4gICAgZnVuY3Rpb24gY29udHJvbGxlcihjb25maWcsIHZpc2l0b3IsICR0aW1lb3V0KSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuICAgICAgICB2YXIgdGltZXI7IFxyXG5cclxuICAgICAgICAkY3RybC4kb25Jbml0ID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgICRjdHJsLnZpc2l0b3IgPSB2aXNpdG9yLmdldCgpOyBcclxuICAgICAgICAgICAgJGN0cmwuc3RhcnRUaW1lcigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy4kcm91dGVyT25BY3RpdmF0ZSA9IGZ1bmN0aW9uIChuZXh0KSB7XHJcbiAgICAgICAgICAgICRjdHJsLiRyb3V0ZXIgPSB0aGlzLiRyb3V0ZXI7XHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgJGN0cmwuZ290b1dlbGNvbWUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICR0aW1lb3V0LmNhbmNlbCh0aW1lcik7XHJcbiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5uYXZpZ2F0ZShbJ1dlbGNvbWUnXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5nb3RvUGxlZGdlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkdGltZW91dC5jYW5jZWwodGltZXIpO1xyXG4gICAgICAgICAgICB0aGlzLiRyb3V0ZXIubmF2aWdhdGUoWydQbGVkZ2UnXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5zdGFydFRpbWVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkdGltZW91dC5jYW5jZWwodGltZXIpO1xyXG4gICAgICAgICAgICB0aW1lciA9ICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZpc2l0b3IuY2xlYXIoKTtcclxuICAgICAgICAgICAgICAgICRjdHJsLiRyb3V0ZXIubmF2aWdhdGUoWydXZWxjb21lJ10pO1xyXG4gICAgICAgICAgICB9LCBjb25maWcucmVkaXJlY3RUaW1lb3V0KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ3JlZ2lzdGVyJyxcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGJpbmRpbmdzOiB7ICRyb3V0ZXI6ICc8JyB9LFxyXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJ2FwcC9yZWdpc3Rlci5jb21wb25lbnQuaHRtbCcsIFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiBbJ2NvbmZpZycsICd2aXNpdG9yU2VydmljZScsICckdGltZW91dCcsIGNvbnRyb2xsZXJdXHJcbiAgICAgICAgfSk7XHJcblxyXG5cclxufVxyXG4pKCk7IiwiLy9yZXN1bHRzLmNvbXBvbmVudC5qc1xyXG4oZnVuY3Rpb24gKCkge1xyXG4gICAgdmFyIG1vZHVsZSA9IGFuZ3VsYXIubW9kdWxlKCdhcHAnKTtcclxuICAgIC8vVE9ETzogR0VUIGh1YiB1cmwgZnJvbSBzZXR0aW5nc1xyXG4gICAgZnVuY3Rpb24gY29udHJvbGxlcihjb25maWcsICR0aW1lb3V0LCB2aXNpdG9yKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpcztcclxuICAgICAgICB2YXIgdGltZXI7IFxyXG4gICAgICAgIHZhciBwYWdlU2l6ZURlZmF1bHQgPSAxMDtcclxuICAgICAgICB2YXIgdGFibGVTdGF0ZVJlZjtcclxuXHJcbiAgICAgICAgJGN0cmwuc2VhcmNoTW9kZWwgPSB7XHJcbiAgICAgICAgICAgIHBhZ2U6IDEsXHJcbiAgICAgICAgICAgIHBhZ2VTaXplOiBwYWdlU2l6ZURlZmF1bHRcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICAkY3RybC5wYWdpbmcgPSB7XHJcbiAgICAgICAgICAgIGN1cnJlbnRQYWdlOiAxXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC4kb25Jbml0ID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICBjb25zb2xlLmxvZygnc2VhcmNoIGluaXQnKTtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IG5hbWVzID0gdmlzaXRvci5nZXRUZXJtKCkuc3BsaXQoJyAnKTtcclxuICAgICAgICAgICAgaWYgKG5hbWVzLmxlbmd0aCA+IDEpIHtcclxuICAgICAgICAgICAgICAgICRjdHJsLnNlYXJjaE1vZGVsLmZpcnN0bmFtZSA9IG5hbWVzWzBdOyBcclxuICAgICAgICAgICAgICAgICRjdHJsLnNlYXJjaE1vZGVsLmxhc3RuYW1lID0gbmFtZXNbMV07IFxyXG4gICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuc2VhcmNoTW9kZWwubGFzdG5hbWUgPSBuYW1lc1swXTsgXHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICRjdHJsLnNlYXJjaCgpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuZ290b1dlbGNvbWUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICR0aW1lb3V0LmNhbmNlbCh0aW1lcik7XHJcbiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5uYXZpZ2F0ZShbJ1dlbGNvbWUnXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5nb3RvU2VhcmNoID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkdGltZW91dC5jYW5jZWwodGltZXIpO1xyXG4gICAgICAgICAgICB0aGlzLiRyb3V0ZXIubmF2aWdhdGUoWydTZWFyY2gnXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5wbGVkZ2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZpc2l0b3IuY2xlYXJUZXJtKCk7XHJcbiAgICAgICAgICAgICR0aW1lb3V0LmNhbmNlbCh0aW1lcik7XHJcbiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5uYXZpZ2F0ZShbJ1BsZWRnZSddKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLnRvZ2dsZU5hbWUgPSBmdW5jdGlvbiAodikge1xyXG4gICAgICAgICAgICAkY3RybC52aXNpdG9yID0gdjtcclxuICAgICAgICAgICAgdmlzaXRvci5zZXQodik7XHJcbiAgICAgICAgICAgICRjdHJsLnN0YXJ0VGltZXIoKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLnNlYXJjaCA9IGZ1bmN0aW9uICh0YWJsZVN0YXRlKSB7XHJcbiAgICAgICAgICAgIHRhYmxlU3RhdGVSZWYgPSB0YWJsZVN0YXRlO1xyXG4gICAgICAgICAgICByZXR1cm4gdmlzaXRvci5zZWFyY2goJGN0cmwuc2VhcmNoTW9kZWwpLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgICRjdHJsLnZpc2l0b3JzID0gci5yZXN1bHRzO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuc2VhcmNoTW9kZWwgPSByO1xyXG4gICAgICAgICAgICAgICAgZGVsZXRlICRjdHJsLnNlYXJjaE1vZGVsLnJlc3VsdHM7XHJcbiAgICAgICAgICAgICAgICAkY3RybC5zdGFydFRpbWVyKCk7XHJcbiAgICAgICAgICAgIH0pOyBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLnBhZ2VkID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkY3RybC52aXNpdG9yID0gbnVsbDsgXHJcbiAgICAgICAgICAgICRjdHJsLnNlYXJjaCh0YWJsZVN0YXRlUmVmKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLnN0YXJ0VGltZXIgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICR0aW1lb3V0LmNhbmNlbCh0aW1lcik7XHJcbiAgICAgICAgICAgIHRpbWVyID0gJHRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgdmlzaXRvci5jbGVhcigpO1xyXG4gICAgICAgICAgICAgICAgJGN0cmwuJHJvdXRlci5uYXZpZ2F0ZShbJ1dlbGNvbWUnXSk7XHJcbiAgICAgICAgICAgIH0sIGNvbmZpZy5yZWRpcmVjdFRpbWVvdXQpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICB9XHJcblxyXG4gICAgbW9kdWxlLmNvbXBvbmVudCgncmVzdWx0cycsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiaW5kaW5nczogeyAkcm91dGVyOiAnPCcgfSxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvcmVzdWx0cy5jb21wb25lbnQuaHRtbCcsXHJcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IFsnY29uZmlnJywgJyR0aW1lb3V0JywgJ3Zpc2l0b3JTZXJ2aWNlJywgY29udHJvbGxlcl1cclxuICAgICAgICB9KTtcclxufVxyXG4pKCk7IiwiLy9zZWFyY2guY29tcG9uZW50LmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoY29uZmlnLCB2aXNpdG9yLCAkdGltZW91dCkge1xyXG4gICAgICAgIHZhciAkY3RybCA9IHRoaXM7XHJcbiAgICAgICAgdmFyIHRpbWVyOyBcclxuXHJcbiAgICAgICAgJGN0cmwuJG9uSW5pdCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3NlYXJjaCBpbml0Jyk7XHJcbiAgICAgICAgICAgICRjdHJsLnNlYXJjaFRlcm0gPSB2aXNpdG9yLmdldFRlcm0oKTtcclxuICAgICAgICAgICAgJGN0cmwuc3RhcnRUaW1lcigpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgJGN0cmwuZ290b1dlbGNvbWUgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHZpc2l0b3IuY2xlYXIoKTtcclxuICAgICAgICAgICAgJHRpbWVvdXQuY2FuY2VsKHRpbWVyKTtcclxuICAgICAgICAgICAgdGhpcy4kcm91dGVyLm5hdmlnYXRlKFsnV2VsY29tZSddKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmdvdG9TZWFyY2hSZXN1bHRzID0gZnVuY3Rpb24oKSB7XHJcbiAgICAgICAgICAgIHZpc2l0b3Iuc2V0VGVybSgkY3RybC5zZWFyY2hUZXJtKTsgXHJcbiAgICAgICAgICAgICR0aW1lb3V0LmNhbmNlbCh0aW1lcik7XHJcbiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5uYXZpZ2F0ZShbJ1Jlc3VsdHMnXSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAkY3RybC5zdGFydFRpbWVyID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAkdGltZW91dC5jYW5jZWwodGltZXIpO1xyXG4gICAgICAgICAgICB0aW1lciA9ICR0aW1lb3V0KGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHZpc2l0b3IuY2xlYXIoKTtcclxuICAgICAgICAgICAgICAgICRjdHJsLiRyb3V0ZXIubmF2aWdhdGUoWydXZWxjb21lJ10pO1xyXG4gICAgICAgICAgICB9LCBjb25maWcucmVkaXJlY3RUaW1lb3V0KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgfVxyXG5cclxuICAgIG1vZHVsZS5jb21wb25lbnQoJ3NlYXJjaCcsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiaW5kaW5nczogeyAkcm91dGVyOiAnPCcgfSxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvc2VhcmNoLmNvbXBvbmVudC5odG1sJyxcclxuICAgICAgICAgICAgY29udHJvbGxlcjogWydjb25maWcnLCAndmlzaXRvclNlcnZpY2UnLCAnJHRpbWVvdXQnLCBjb250cm9sbGVyXVxyXG4gICAgICAgIH0pO1xyXG59XHJcbikoKTsiLCIvL3dlbGNvbWUuY29tcG9uZW50LmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xyXG5cclxuICAgIGZ1bmN0aW9uIGNvbnRyb2xsZXIoKSB7XHJcbiAgICAgICAgdmFyICRjdHJsID0gdGhpczsgXHJcblxyXG4gICAgICAgICRjdHJsLiRvbkluaXQgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ3dlbGNvbWUgaW5pdCcpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy4kcm91dGVyT25BY3RpdmF0ZSA9IGZ1bmN0aW9uIChuZXh0KSB7IH07XHJcblxyXG4gICAgICAgICRjdHJsLmdvdG9SZWdpc3RlciA9IGZ1bmN0aW9uKCkge1xyXG4gICAgICAgICAgICB0aGlzLiRyb3V0ZXIubmF2aWdhdGUoWydSZWdpc3RlciddKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgICRjdHJsLmdvdG9TZWFyY2ggPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuJHJvdXRlci5uYXZpZ2F0ZShbJ1NlYXJjaCddKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgbW9kdWxlLmNvbXBvbmVudCgnd2VsY29tZScsXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgICBiaW5kaW5nczogeyAkcm91dGVyOiAnPCcgfSxcclxuICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdhcHAvd2VsY29tZS5jb21wb25lbnQuaHRtbCcsIFxyXG4gICAgICAgICAgICBjb250cm9sbGVyOiBbY29udHJvbGxlcl1cclxuICAgICAgICB9KTtcclxuXHJcbn1cclxuKSgpOyIsIi8vdmlzaXRvci5zZXJ2aWNlLmpzXHJcbihmdW5jdGlvbiAoKSB7XHJcbiAgICB2YXIgbW9kdWxlID0gYW5ndWxhci5tb2R1bGUoJ2FwcCcpO1xyXG4gICAgXHJcbiAgICBmdW5jdGlvbiBmYWN0b3J5KCRodHRwLCBjb25maWcpIHtcclxuICAgICAgICB2YXIgdmlzaXRvciA9IHt9O1xyXG4gICAgICAgIHZhciB0ZXJtID0gJyc7XHJcbiAgICAgICAgXHJcbiAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgY2xlYXI6IGNsZWFyLFxyXG4gICAgICAgICAgICBjbGVhclRlcm06IGNsZWFyVGVybSwgXHJcbiAgICAgICAgICAgIGdldDogZ2V0LFxyXG4gICAgICAgICAgICBnZXRUZXJtOiBnZXRUZXJtLFxyXG4gICAgICAgICAgICBzZXQ6IHNldCxcclxuICAgICAgICAgICAgc2V0VGVybTogc2V0VGVybSxcclxuICAgICAgICAgICAgc2F2ZTogc2F2ZSwgXHJcbiAgICAgICAgICAgIHNlYXJjaDogc2VhcmNoXHJcbiAgICAgICAgfTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24gY2xlYXIoKSB7XHJcbiAgICAgICAgICAgIHZpc2l0b3IgPSB7fTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGNsZWFyVGVybSgpIHtcclxuICAgICAgICAgICAgdGVybSA9ICcnOyBcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGdldCgpIHtcclxuICAgICAgICAgICAgcmV0dXJuIHZpc2l0b3I7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBnZXRUZXJtKCkge1xyXG4gICAgICAgICAgICByZXR1cm4gdGVybTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNldCh2KSB7XHJcbiAgICAgICAgICAgIHZpc2l0b3IgPSB2O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2V0VGVybSh0KSB7XHJcbiAgICAgICAgICAgIHRlcm0gPSB0O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gc2VhcmNoKG1vZGVsKSB7XHJcbiAgICAgICAgICAgIHJldHVybiAkaHR0cC5nZXQoY29uZmlnLmFwaVVybCwgeyBwYXJhbXM6IG1vZGVsIH0pLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiByLmRhdGE7IFxyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIHNhdmUodikge1xyXG4gICAgICAgICAgICAkaHR0cC5wb3N0KGNvbmZpZy5hcGlVcmwsIHZpc2l0b3IpLnRoZW4oZnVuY3Rpb24gKHIpIHtcclxuICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCdzYXZlZCBuZXcgdmlzaXRvcicsIHZpc2l0b3IpO1xyXG4gICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKCdzb21ldGhpbmcgd2VudCB3cm9uZycsIGVyci5tZXNzYWdlKTtcclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgIH1cclxuXHJcbiAgICBtb2R1bGUuZmFjdG9yeSgndmlzaXRvclNlcnZpY2UnLCBbJyRodHRwJywgJ2NvbmZpZycsIGZhY3RvcnldKTtcclxuXHJcbn1cclxuKSgpOyIsImFuZ3VsYXIubW9kdWxlKFwib25TY3JlZW5LZXlib2FyZFwiLCBbXCJuZ1Nhbml0aXplXCJdKS5kaXJlY3RpdmUoXCJvblNjcmVlbktleWJvYXJkXCIsIFtcIiR0aW1lb3V0XCIsIFwiJGRvY3VtZW50XCIsIGZ1bmN0aW9uIChhLCBiKSB7XHJcbiAgICBcInVzZSBzdHJpY3RcIjtcclxuICAgIHJldHVybiB7XHJcbiAgICAgICAgcmVzdHJpY3Q6IFwiRVwiLFxyXG4gICAgICAgIGJpbmRUb0NvbnRyb2xsZXI6ICEwLFxyXG4gICAgICAgIGNvbnRyb2xsZXJBczogXCJjdHJsXCIsXHJcbiAgICAgICAgc2NvcGU6IHtcclxuICAgICAgICAgICAgcm93czogXCI9P1wiLFxyXG4gICAgICAgICAgICB1cHBlcmNhc2VBbGxXb3JkczogXCJAXCJcclxuICAgICAgICB9LFxyXG4gICAgICAgIGNvbnRyb2xsZXI6IFtcIiRzY2VcIiwgZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgdmFyIGIgPSB0aGlzO1xyXG4gICAgICAgICAgICBiLnJvd3MgfHwgKGIucm93cyA9IFtcclxuICAgICAgICAgICAgICAgIFtcIjFcIiwgXCIyXCIsIFwiM1wiLCBcIjRcIiwgXCI1XCIsIFwiNlwiLCBcIjdcIiwgXCI4XCIsIFwiOVwiLCBcIjBcIiwge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiZXJhc2VcIixcclxuICAgICAgICAgICAgICAgICAgICBjb2xzcGFuOiAyLFxyXG4gICAgICAgICAgICAgICAgICAgIHRleHQ6IFwiJmxBcnI7XCJcclxuICAgICAgICAgICAgICAgIH1dLFxyXG4gICAgICAgICAgICAgICAgW1wicVwiLCBcIndcIiwgXCJlXCIsIFwiclwiLCBcInRcIiwgXCJ5XCIsIFwidVwiLCBcImlcIiwgXCJvXCIsIFwicFwiLCBcIkBcIl0sXHJcbiAgICAgICAgICAgICAgICBbXCJhXCIsIFwic1wiLCBcImRcIiwgXCJmXCIsIFwiZ1wiLCBcImhcIiwgXCJqXCIsIFwia1wiLCBcImxcIiwgXCItXCIsIFwiX1wiLCB7XHJcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJtYXJnaW5cIlxyXG4gICAgICAgICAgICAgICAgfV0sXHJcbiAgICAgICAgICAgICAgICBbe1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic2hpZnRcIlxyXG4gICAgICAgICAgICAgICAgfSwgXCJ6XCIsIFwieFwiLCBcImNcIiwgXCJ2XCIsIFwiYlwiLCBcIm5cIiwgXCJtXCIsIFwiLFwiLCBcIi5cIiwge1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic2hpZnRcIlxyXG4gICAgICAgICAgICAgICAgfV0sXHJcbiAgICAgICAgICAgICAgICBbe1xyXG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwibWFyZ2luXCJcclxuICAgICAgICAgICAgICAgIH0sIHtcclxuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInNwYWNlXCIsXHJcbiAgICAgICAgICAgICAgICAgICAgY29sc3BhbjogOSxcclxuICAgICAgICAgICAgICAgICAgICB0ZXh0OiBcIiBcIlxyXG4gICAgICAgICAgICAgICAgfV1cclxuICAgICAgICAgICAgXSksXHJcbiAgICAgICAgICAgICAgICBiLmdldFRleHQgPSBmdW5jdGlvbiAoYikge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChcIm1hcmdpblwiID09PSBiLnR5cGUpIHJldHVybiBcIlwiO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChcInNoaWZ0XCIgPT09IGIudHlwZSkgcmV0dXJuIFwiJmRBcnI7XCI7XHJcbiAgICAgICAgICAgICAgICAgICAgdmFyIGMgPSBiLnRleHQgfHwgYjtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYyAmJiBjLmluZGV4T2YoXCImXCIpID4gLTEgPyBhLnRydXN0QXNIdG1sKGMpIDogYztcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgfV0sXHJcbiAgICAgICAgbGluazogZnVuY3Rpb24gKGMsIGQsIGUpIHtcclxuICAgICAgICAgICAgdmFyIGYgPSBjLmN0cmw7XHJcbiAgICAgICAgICAgIGQuYmluZChcImNvbnRleHRtZW51XCIsIGZ1bmN0aW9uIChhKSB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gYS5wcmV2ZW50RGVmYXVsdCgpLCAhMTtcclxuICAgICAgICAgICAgfSksXHJcbiAgICAgICAgICAgICAgICBmLmlzVXBwZXJDYXNlID0gITEsIGYubGFzdElucHV0Q3RybCA9IG51bGwsIGYuc3RhcnRQb3MgPSBudWxsLCBmLmVuZFBvcyA9IG51bGwsXHJcbiAgICAgICAgICAgICAgICBmLnByaW50S2V5U3Ryb2tlID0gZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZiAoZi5sYXN0SW5wdXRDdHJsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBiID0gYW5ndWxhci5lbGVtZW50KGEudGFyZ2V0IHx8IGEuc3JjRWxlbWVudCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChiLmhhc0NsYXNzKFwiZXJhc2VcIikpIHJldHVybiB2b2lkIGYuZXJhc2VLZXlTdHJva2UoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGIuaGFzQ2xhc3MoXCJzaGlmdFwiKSkgcmV0dXJuIHZvaWQgZi5pbnZlcnNlQ2FzZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYyA9IGFuZ3VsYXIuZWxlbWVudChmLmxhc3RJbnB1dEN0cmwpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZCA9IGMudmFsKCksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlID0gZC5zdWJzdHJpbmcoMCwgZi5zdGFydFBvcyksXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnID0gZC5zdWJzdHJpbmcoZi5lbmRQb3MsIGQubGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgYy52YWwoZSArIGIudGV4dCgpICsgZyksIGMudHJpZ2dlckhhbmRsZXIoXCJjaGFuZ2VcIiksIGYuc3RhcnRQb3MrKyAsIGYuZW5kUG9zKysgLCBmLnNldEtleWJvYXJkTGF5b3V0KCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSxcclxuICAgICAgICAgICAgICAgIGYuaW52ZXJzZUNhc2UgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgLy92YXIgYSA9IGRbMF0ucXVlcnlTZWxlY3RvckFsbChcIi5sZXR0ZXJcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgLy9hbmd1bGFyLmZvckVhY2goYSwgZnVuY3Rpb24gKGEpIHtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICB2YXIgYiA9IGFuZ3VsYXIuZWxlbWVudChhKTtcclxuICAgICAgICAgICAgICAgICAgICAvLyAgICBmLmlzVXBwZXJDYXNlID8gYi50ZXh0KGIudGV4dCgpLnRvU3RyaW5nKCkudG9Mb3dlckNhc2UoKSkgOiBiLnRleHQoYi50ZXh0KCkudG9TdHJpbmcoKS50b1VwcGVyQ2FzZSgpKTtcclxuICAgICAgICAgICAgICAgICAgICAvL30pLCBhbmd1bGFyLmZvckVhY2goZFswXS5xdWVyeVNlbGVjdG9yQWxsKFwiLnNoaWZ0XCIpLCBmdW5jdGlvbiAoYSkge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vICAgIGYuaXNVcHBlckNhc2UgPyBhbmd1bGFyLmVsZW1lbnQoYSkuaHRtbChcIiZkQXJyO1wiKSA6IGFuZ3VsYXIuZWxlbWVudChhKS5odG1sKFwiJnVBcnI7XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgIC8vfSksIGYuaXNVcHBlckNhc2UgPSAhZi5pc1VwcGVyQ2FzZTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBmLnJlZm9jdXMgPSBmdW5jdGlvbiAoKSB7IGYubGFzdElucHV0Q3RybC5mb2N1cygpIH0sXHJcbiAgICAgICAgICAgICAgICBmLmVyYXNlS2V5U3Ryb2tlID0gZnVuY3Rpb24gKCkge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChmLmxhc3RJbnB1dEN0cmwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGEgPSBmLnN0YXJ0UG9zICE9PSBmLmVuZFBvcyxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIgPSBhbmd1bGFyLmVsZW1lbnQoZi5sYXN0SW5wdXRDdHJsKSxcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGMgPSBiLnZhbCgpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZCA9IGMuc3Vic3RyaW5nKDAsIGEgPyBmLnN0YXJ0UG9zIDogZi5zdGFydFBvcyAtIDEpLFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZSA9IGMuc3Vic3RyaW5nKGYuZW5kUG9zLCBjLmxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGIudmFsKGQgKyBlKSwgYi50cmlnZ2VySGFuZGxlcihcImNoYW5nZVwiKSwgYSA/IGYuZW5kUG9zID0gZi5zdGFydFBvcyA6IChmLnN0YXJ0UG9zLS0gLCBmLmVuZFBvcy0tKSwgZi5sYXN0SW5wdXRDdHJsLnNlbGVjdGlvblN0YXJ0ID0gZi5zdGFydFBvcywgZi5sYXN0SW5wdXRDdHJsLnNlbGVjdGlvbkVuZCA9IGYuc3RhcnRQb3MsIGYuc2V0S2V5Ym9hcmRMYXlvdXQoKSwgZi5yZWZvY3VzKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfSwgZi5zZXRLZXlib2FyZExheW91dCA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZi5sYXN0SW5wdXRDdHJsID8gdm9pZCAoZi5sYXN0SW5wdXRDdHJsLmNsYXNzTmFtZSAmJiBmLmlzVXBwZXJDYXNlID8gZi5pbnZlcnNlQ2FzZSgpIDogMCA9PT0gYW5ndWxhci5lbGVtZW50KGYubGFzdElucHV0Q3RybCkudmFsKCkubGVuZ3RoID8gZi5pc1VwcGVyQ2FzZSB8fCAoZi5pc1VwcGVyQ2FzZSA9ICExLCBmLmludmVyc2VDYXNlKCkpIDogXCIgXCIgPT09IGFuZ3VsYXIuZWxlbWVudChmLmxhc3RJbnB1dEN0cmwpLnZhbCgpLnNsaWNlKC0xKSAmJiAhZi5pc1VwcGVyQ2FzZSAmJiBlLmhhc093blByb3BlcnR5KFwidXBwZXJjYXNlQWxsV29yZHNcIikgPyBmLmludmVyc2VDYXNlKCkgOiAoZi5pc1VwcGVyQ2FzZSA9ICEwLCBmLmludmVyc2VDYXNlKCkpKSA6IChmLmlzVXBwZXJDYXNlID0gITEsIHZvaWQgZi5pbnZlcnNlQ2FzZSgpKTtcclxuICAgICAgICAgICAgICAgIH0sXHJcbiAgICAgICAgICAgICAgICBiLmZpbmQoXCJpbnB1dFwiKS5iaW5kKFwiYmx1ciBmb2N1c1wiLCBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZi5zZXRLZXlib2FyZExheW91dCgpLCBmLmxhc3RJbnB1dEN0cmwgPSB0aGlzLCBmLmxhc3RJbnB1dEN0cmwgJiYgXCJjaGVja2JveFwiICE9PSBmLmxhc3RJbnB1dEN0cmwudHlwZSAmJiAoZi5zdGFydFBvcyA9IGYubGFzdElucHV0Q3RybC5zZWxlY3Rpb25TdGFydCwgZi5lbmRQb3MgPSBmLmxhc3RJbnB1dEN0cmwuc2VsZWN0aW9uRW5kKTtcclxuICAgICAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgICAgICAgICAgLmJpbmQoXCJrZXlkb3duXCIsIGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZi5zdGFydFBvcyA9IGYubGFzdElucHV0Q3RybC5zZWxlY3Rpb25TdGFydCwgZi5lbmRQb3MgPSBmLmxhc3RJbnB1dEN0cmwuc2VsZWN0aW9uRW5kO1xyXG4gICAgICAgICAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICAgICAgYShmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgZi5pbnZlcnNlQ2FzZSgpO1xyXG4gICAgICAgICAgICAgICAgfSwgMCk7XHJcbiAgICAgICAgfSxcclxuICAgICAgICB0ZW1wbGF0ZVVybDogXCIvdGVtcGxhdGVzL2FuZ3VsYXItb24tc2NyZWVuLWtleWJvYXJkLmh0bWxcIlxyXG4gICAgfTtcclxufV0pOztcclxuYW5ndWxhci5tb2R1bGUoJ29uU2NyZWVuS2V5Ym9hcmQnKS5ydW4oWyckdGVtcGxhdGVDYWNoZScsIGZ1bmN0aW9uICgkdGVtcGxhdGVDYWNoZSkge1xyXG4gICAgJ3VzZSBzdHJpY3QnO1xyXG5cclxuICAgICR0ZW1wbGF0ZUNhY2hlLnB1dCgnL3RlbXBsYXRlcy9hbmd1bGFyLW9uLXNjcmVlbi1rZXlib2FyZC5odG1sJyxcclxuICAgICAgICBcIjxkaXYgY2xhc3M9a2V5Ym9hcmQ+PHRhYmxlPjx0ciBuZy1yZXBlYXQ9XFxcInJvdyBpbiBjdHJsLnJvd3NcXFwiPjx0ZCBuZy1yZXBlYXQ9XFxcImtleSBpbiByb3dcXFwiIG5nLWNsaWNrPWN0cmwucHJpbnRLZXlTdHJva2UoJGV2ZW50KSBjb2xzcGFuPVxcXCJ7e2tleS5jb2xzcGFuIHx8IDF9fVxcXCIgbmctY2xhc3M9XFxcInsnYnV0dG9uJzoga2V5LnR5cGUgIT09ICdtYXJnaW4nLCAnbGV0dGVyJzoga2V5LnR5cGUgIT09ICdtYXJnaW4nfVxcXCIgY2xhc3M9e3trZXkudHlwZX19IG5nLWJpbmQtaHRtbD1jdHJsLmdldFRleHQoa2V5KT48L3RkPjwvdHI+PC90YWJsZT48L2Rpdj5cIlxyXG4gICAgKTtcclxuXHJcbn1dKTsiXX0=
